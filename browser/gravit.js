function gShellReady(){gApp=new GApplication}function gShellFinished(){gApp.init(),gShell.prepare(),gApp.relayout(),setTimeout(function(){gShell.start(),__loader.remove()},2500)}!function(a){var b={init:function(c){return c=a.extend({selector:null},c),this.each(function(){var d=this;a(this).data("gautoedit",{options:c,input:null}).on("dblclick",function(){b.open.call(d)})})},open:function(){var c=this,d=a(this),e=d.data("gautoedit");e.input&&b.close.call(this);var f=d.find(e.options.selector);if(0===f.length){if(e.options.selector)return;f=d}var g=f.offset();e.value=f.text(),e.input=a("<input>").css({position:"absolute",left:g.left+"px",top:g.top+"px",width:f.outerWidth()+"px",height:f.outerHeight()+"px"}).val(e.value).on("blur",function(){b.submit.call(c)}).on("keyup",function(a){13===a.keyCode?b.submit.call(c):27===a.keyCode&&b.close.call(c)}).appendTo(a("body")).focus().select()},submit:function(){var c=a(this),d=c.data("gautoedit"),e=d.input?d.input.val():null;b.close.call(this),e&&d.value!==e&&c.trigger("submitvalue",e)},close:function(){var b=a(this),c=b.data("gautoedit");c.input&&(c.input.remove(),c.input=null,c.value=null)}};a.fn.gAutoEdit=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){var b={init:function(c){return c=a.extend({title:"",content:"",controls:null},c),this.each(function(){{var d=this;a(this).empty().addClass("g-panel").data("gpanel",{options:c,expanded:!0}).append(a("<div></div>").addClass("header").append(a("<div></div>").addClass("title").append(a("<i></i>").addClass("fa fa-angle-down")).append(a("<span></span>").text(c.title)).on("click",function(){b.toggle.call(d)})).append(a("<div></div>").addClass("controls").append(c.controls))).append(a("<div></div>").addClass("content").append(c.content))}})},toggle:function(){var c=a(this),d=c.data("gpanel");b.expanded.call(this,!d.expanded)},expanded:function(b){var c=a(this),d=c.data("gpanel");return arguments.length?(b!==d.expanded&&(d.expanded=b,c.find(".content").css("display",d.expanded?"":"none"),c.find(".controls").css("visibility",d.expanded?"":"hidden"),c.find(".header i.fa").toggleClass("fa-angle-down",d.expanded).toggleClass("fa-angle-right",!d.expanded)),this):d.expanded}};a.fn.gPanel=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){var b=20,c=a("<div></div>").css({position:"absolute",left:"0px",top:"0px",width:b+"px",height:b+"px","z-index":"-1"}).appendTo(a("body")),d={init:function(e){return e=a.extend({allowDrag:!0,allowDrop:!0},e),this.each(function(){var f=this,g=a(this);g.data("gpatterntarget",{options:e,pattern:null,types:null}),e.allowDrag&&g.attr("draggable","true").on("dragstart",function(a){var d=a.originalEvent,e=g.data("gpatterntarget").pattern;return e?(d.stopPropagation(),g.trigger("patterndrag",e),c.css("background",IFPattern.asCSSBackground(e)),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData(IFPattern.MIME_TYPE,IFPattern.serialize(e)),d.dataTransfer.setDragImage(c[0],b/2,b/2),void(d.dataTransfer.sourceElement=this)):void d.preventDefault()}).on("dragend",function(a){var b=a.originalEvent;b.stopPropagation()}),e.allowDrop&&g.on("dragover",function(a){a.stopPropagation();var b=a.originalEvent;b.preventDefault(),b.stopPropagation(),a.originalEvent.dataTransfer.dropEffect="move"}).on("drop",function(a){a.stopPropagation();var b=g.data("gpatterntarget"),c=a.originalEvent,e=c.dataTransfer.getData(IFPattern.MIME_TYPE);if(e&&(e=IFPattern.deserialize(e))){var h=!0;if(b.types&&b.types.length>0){h=!1;for(var i=0;i<b.types.length;++i)if(b.types[i]&&e instanceof b.types[i]){h=!0;break}}if(h){var j=g.data("gpatterntarget").pattern;IFUtil.equals(e,j)||(d.value.call(f,e),g.trigger("patternchange",e)),g.trigger("patterndrop",[e,c])}}return!1})})},value:function(b){var c=a(this),d=c.data("gpatterntarget");return arguments.length?(b="string"==typeof b?IFPattern.deserialize(b):b,d.pattern=b,this):d.pattern},types:function(b){var c=a(this),d=c.data("gpatterntarget");return arguments.length?(d.types=b,this):d.types}};a.fn.gPatternTarget=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery),function(a){var b=["#000000","#1F1F1F","#3D3D3D","#5C5C5C","#7A7A7A","#999999","#B8B8B8","#D6D6D6","#F5F5F5","#FFFFFF","#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],c={init:function(d){return d=a.extend({},d),this.each(function(){var e=this,f=a(this).addClass("g-pattern-editor").data("gpatterneditor",{scene:null,value:null,options:d});f.append(a("<div></div>").gColorEditor().on("colorchange",function(){c._colorChanged.call(e)})).append(a("<div></div>").addClass("palette").append(a("<div></div>").addClass("swatches").gSwatchPanel({allowSelect:!1,allowNameEdit:!1,previewWidth:20,previewHeight:20,nullSwatch:a("<span></span>").addClass("fa fa-plus").css("padding-left","4px"),nullName:"Add Swatch",nullAction:function(){a(this).gSwatchPanel("createSwatch",c.value.call(e))}}).on("swatchchange",function(a,b){var d=b.getProperty("pat");d instanceof IFColor?(f.find(".g-color-editor").gColorEditor("currentColor",d),c._colorChanged.call(e)):d&&(c.value.call(e,d),c._firePatternChange.call(e))})).append(a("<div></div>").addClass("divider")).append(a("<div></div>").addClass("builtin-colors"))).append(a("<div></div>").addClass("g-list pattern-editor").append(a("<div></div>").data("pattern-class",IFGradient).gGradientEditor().gGradientEditor("value",new IFLinearGradient).on("gradientchange",function(){c._firePatternChange.call(e,!0)}))).append(a("<div></div>").addClass("toolbar").append(a("<div></div>").addClass("pattern-type").gPatternTypePicker().on("patterntypechange",function(a,b){c.value.call(e,IFPattern.smartCreate(b,c.value.call(e))),c._firePatternChange.call(e)})).append(a("<label></label>").addClass("pattern-opacity").css("display","none").append(a("<span></span>").text(" Opacity: ")).append(a("<input>").css("width","3em").on("change",function(b){"none"!==a(b.target).closest("label").css("display")&&c._firePatternChange.call(e)})).append(a("<span>%</span>"))));for(var g=f.find(".builtin-colors"),h=0;h<b.length;++h){var i=IFRGBColor.parseCSSColor(b[h]);a("<div></div>").css("background",i.toScreenCSS()).gPatternTarget({allowDrop:!1}).gPatternTarget("types",[IFColor]).gPatternTarget("value",i).on("click",function(b){f.find(".g-color-editor").gColorEditor("currentColor",a(b.target).gPatternTarget("value")),c._colorChanged.call(e)}).appendTo(g)}})},scene:function(b){var c=a(this),d=c.data("gpatterneditor");if(arguments.length){if(b!==d.scene){var e=c.find(".swatches");d.scene&&e.gSwatchPanel("detach"),d.scene=b,d.scene&&e.gSwatchPanel("attach",d.scene.getSwatchCollection())}return this}return d.scene},types:function(b){var c=a(this);return arguments.length?(c.find(".pattern-type").gPatternTypePicker("types",b),c.find(".swatches").gSwatchPanel("types",b),this):c.find(".pattern-type").gPatternTypePicker("types")},value:function(b){var d=a(this),e=d.data("gpatterneditor");if(arguments.length){e.value=b;var f=d.find(".pattern-type").gPatternTypePicker("value",b?b.constructor:null).gPatternTypePicker("value"),g=!1;return d.find(".pattern-editor > div").each(function(b,c){var d=a(c),e=d.data("pattern-class")===f;d.css("display",e?"":"none"),g=g||e}),d.find(".pattern-editor").css("display",g?"":"none"),b instanceof IFGradient&&d.find(".g-gradient-editor").gGradientEditor("value",b),c._updateToColor.call(this),this}return e.value},opacity:function(b){var c=a(this);if(arguments.length)return c.find(".pattern-opacity").css("display","number"==typeof b?"":"none").children("input").val("number"==typeof b?Math.round(100*b):""),this;var d=c.find(".pattern-opacity");return"none"===d.css("display")?null:parseInt(d.children("input").val())/100},_colorChanged:function(){var b=a(this),d=b.data("gpatterneditor"),e=b.find(".g-color-editor").gColorEditor("value");if(!d.value||d.value instanceof IFBackground){var f=b.find(".pattern-type"),g=f.gPatternTypePicker("types"),g=c.types.call(this);(!g||!g.length||g&&g.indexOf(IFColor)>=0)&&(d.value=e,f.gPatternTypePicker("value",IFColor),c._firePatternChange.call(this,!1))}else d.value instanceof IFColor?c._firePatternChange.call(this,!0):d.value instanceof IFGradient},_updateToColor:function(){var b=a(this),c=b.data("gpatterneditor"),d=null;c.value instanceof IFColor?d=c.value:c.value instanceof IFGradient,d&&b.find(".g-color-editor").gColorEditor("value",d)},_generatePattern:function(){var b=a(this),c=b.find(".pattern-type").gPatternTypePicker("value");if(c){if(c===IFBackground)return new IFBackground;if(c===IFColor)return b.find(".g-color-editor").gColorEditor("value");if(c===IFGradient)return b.find(".g-gradient-editor").gGradientEditor("value");throw new Error("Unknown pattern type.")}return null},_firePatternChange:function(b){var d=a(this),e=d.data("gpatterneditor");b&&(e.value=c._generatePattern.call(this)),d.trigger("patternchange",[e.value,c.opacity.call(this)])}};a.fn.gPatternEditor=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=null;a.gPatternPicker={},a.gPatternPicker.getEditor=function(){return b||(b=a("<div></div>").css("margin","5px").gPatternEditor().gOverlay()),b},a.gPatternPicker.open=function(b){b=a.extend({target:null,scene:null,types:null,value:null,modal:!1,opacity:null,closeCallback:null,changeCallback:null},b);var c=a.gPatternPicker.getEditor();c.gOverlay("close"),c.gPatternEditor("scene",b.scene),c.gPatternEditor("types",b.types),c.gPatternEditor("value",b.value),c.gPatternEditor("opacity",b.opacity);var d=function(){c.gPatternEditor("scene",null),b.changeCallback&&c.off("patternchange",b.changeCallback),c.off("close",d),b.closeCallback&&b.closeCallback()};c.on("close",d),b.changeCallback&&c.on("patternchange",b.changeCallback),c.gOverlay("open",b.target,b.modal)},a.gPatternPicker.close=function(){a.gPatternPicker.getEditor().gOverlay("close")},a.gPatternPicker.relayout=function(){a.gPatternPicker.getEditor().gOverlay("relayout")},a.gPatternPicker.value=function(b){return arguments.length?void a.gPatternPicker.getEditor().gPatternEditor("value",b):a.gPatternPicker.getEditor().gPatternEditor("value")};var c={init:function(b){return b=a.extend({"transient":!1,autoOpen:!0,modal:!1},b),this.each(function(){var d=this,e=a(this);b.transient||e.addClass("g-input").addClass("g-cursor-pipette").css("min-width","20px"),e.data("gpatternpicker",{options:b,opened:!1,scene:null,types:null,opacity:null,manualChangeEvent:!1,closeListener:function(){e.data("gpatternpicker").opened=!1},changeListener:function(a,b,f){var g=e.data("gpatternpicker");g.manualChangeEvent=!0,c.value.call(d,b),c.opacity.call(d,f);try{e.trigger("patternchange",[b,f])}finally{g.manualChangeEvent=!1}}}).gPatternTarget(b).on("patternchange",function(a,b){var f=e.data("gpatternpicker");f.manualChangeEvent||c.value.call(d,b)}),b.autoOpen&&e.on("click",function(){c.open.call(d)})})},open:function(){var b=a(this),c=b.data("gpatternpicker");return a.gPatternPicker.open({target:this,scene:c.scene,types:c.types,modal:c.options.modal,value:b.gPatternTarget("value"),opacity:c.opacity,closeCallback:c.closeListener,changeCallback:c.changeListener}),c.opened=!0,this},close:function(){return a.gPatternPicker.close(),this},scene:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.scene=b,this):d.scene},types:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.types=b,this):d.types},opacity:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(d.opacity=b,this):d.opacity},value:function(b){var c=a(this),d=c.data("gpatternpicker");return arguments.length?(c.gPatternTarget("value",b),d.options.transient||c.css("background",IFPattern.asCSSBackground(b,"number"==typeof d.opacity?d.opacity:1)),d.opened&&!d.manualChangeEvent&&a.gPatternPicker.value(c.gPatternTarget("value")),a.gPatternPicker.relayout(),this):c.gPatternTarget("value")}};a.fn.gPatternPicker=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=[{clazz:null,name:"None",cssBackground:IFPattern.asCSSBackground(null)},{clazz:IFColor,name:"Color",cssBackground:"black"},{clazz:IFGradient,name:"Gradient",cssBackground:(new IFLinearGradient).asCSSBackground()},{clazz:IFBackground,name:"Background",cssBackground:(new IFBackground).asCSSBackground()}],c={init:function(d){return d=a.extend({},d),this.each(function(){var d=this,e=a(this).data("gpatterntypepicker",{types:null}).addClass("pattern-type-picker");if(c._updateTypes.call(d),e.is("select"))e.on("change",function(){e.trigger("patterntypechange",c.value.call(d))});else for(var f=0;f<b.length;++f){var g=b[f];a("<span></span>").data("patternClass",g.clazz).addClass("g-button pattern-type").attr("title",g.name).append(a("<span></span>").css({background:g.cssBackground})).on("click",function(b){var f=c.value.call(d);c.value.call(d,a(b.target).closest(".pattern-type").data("patternClass"));var g=c.value.call(d);f!==g&&e.trigger("patterntypechange",g)}).appendTo(e)}})},value:function(b){var c=a(this),d=function(a){if(a&&b){for(var c=b.prototype;c;c=Object.getPrototypeOf(c))if(a.prototype===c)return!0}else if(a===b)return!0;return!1};if(arguments.length)return c.is("select")?c.find("option").each(function(b,e){var f=a(e);return d(f.data("patternClass"))?(c.val(f.attr("value")),!1):void 0}):c.find("span").each(function(b,c){var e=a(c);e.data().hasOwnProperty("patternClass")&&e.toggleClass("g-active",d(e.data("patternClass")))}),this;if(c.is("select"))return c.find("option:selected").data("patternClass");var e=null;return c.find("span").each(function(b,c){var d=a(c);return d.data().hasOwnProperty("patternClass")&&d.hasClass("g-active")?(e=d.data("patternClass"),!1):void 0}),e},types:function(b){var d=a(this),e=d.data("gpatterntypepicker");return arguments.length?(e.types=b,c._updateTypes.call(this),this):e.types},_updateTypes:function(){var c=a(this),d=c.data("gpatterntypepicker");if(c.is("select")){c.find("option").each(function(b,c){var d=a(c);d.data().hasOwnProperty("patternClass")&&d.remove()});var e=c,f=c.find(":last");f.is("optgroup")&&(e=f);for(var g=0;g<b.length;++g){var h=b[g];(!d.types||!d.types.length||d.types.indexOf(h.clazz)>=0)&&a("<option></option>").attr("value",g.toString()).data("patternClass",h.clazz).text(h.name).appendTo(e)}}else c.find("span").each(function(b,c){var e=a(c);if(e.data().hasOwnProperty("patternClass")){var f=e.data("patternClass"),g=!d.types||!d.types.length||d.types.indexOf(f)>=0;e.css("display",g?"":"none")}})}};a.fn.gPatternTypePicker=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){function b(b){var c=a(this),d=c.find("canvas.map"),e=a(d).offset(),f=Math.max(0,Math.min(d[0].width,Math.round(b.pageX-e.left-4))),k=Math.max(0,Math.min(d[0].height,Math.round(b.pageY-e.top-4))),c=a(this),l=i[j.colorMode.call(this)],m=j._getComponents.call(this),n=l.componentsFromMap(m.active.component,m.active.value,f/g,k/h,m.components),o=l.colorFromComponents(n);j._setCurrentColor.call(this,o),j._updateComponents.call(this,n),j._updateMapMarker.call(this),j._updateWheelColor.call(this),c.trigger("colorchange",o)}function c(b){var c=a(this),d=c.data("gcoloreditor");if(d.currentColor){var f=c.find('[data-wheel="highlight"]').val(),g=c.find('[data-wheel="mix"]').val(),h=360/e,i=h*Math.PI/180,j=IFColor.rgbToHSV(d.currentColor.toScreen()),k=j[0],l=null;f&&(l=[k],"triadic"===f?(l.push(IFMath.normalizeAngleDegrees(k-120)),l.push(IFMath.normalizeAngleDegrees(k+120))):"tetradic"===f?(l.push(IFMath.normalizeAngleDegrees(k+90)),l.push(IFMath.normalizeAngleDegrees(k+180)),l.push(IFMath.normalizeAngleDegrees(k+270))):"split_complements"===f?(l.push(IFMath.normalizeAngleDegrees(k-150)),l.push(IFMath.normalizeAngleDegrees(k+150))):"analogous"===f?(l.push(IFMath.normalizeAngleDegrees(k-30)),l.push(IFMath.normalizeAngleDegrees(k+30))):"complement"===f&&l.push(IFMath.normalizeAngleDegrees(k+180)));for(var m=e-1;m>=0;--m){var n=IFMath.normalizeAngleDegrees(j[0]+m*h),o=[n,j[1],j[2]],p=l&&l.indexOf(n)>=0,q=m*i-i/2-Math.PI/2;b(m,p,o,q,q+i,g)}}}var d=250,e=24,f=5,g=220,h=150,i={rgb:{components:[{label:"R",component:"r",min:0,max:255,unit:" ",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex([0,a[1],a[2]]),IFColor.rgbToHtmlHex([255,a[1],a[2]])]}},{label:"G",component:"g",min:0,max:255,unit:" ",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex([a[0],0,a[2]]),IFColor.rgbToHtmlHex([a[0],255,a[2]])]}},{label:"B",component:"b",min:0,max:255,unit:" ",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex([a[0],a[1],0]),IFColor.rgbToHtmlHex([a[0],a[1],255])]}},{label:"#",component:"#",text:!0,unit:" ",map:!1,componentsToValue:function(a){return IFColor.rgbToHtmlHex(a).substr(1)},valueToColor:function(a){return a.length>3?IFRGBColor.parseCSSColor(a):null}}],componentToValue:function(a,b){return b},valueToComponent:function(a,b){return b},componentsFromColor:function(a){return a.toScreen()},colorFromComponents:function(a){return new IFRGBColor(a)},componentsFromMap:function(a,b,c,d){switch(a){case"r":return[b,255*(1-d),255*c];case"g":return[255*(1-d),b,255*c];case"b":return[255*c,255*(1-d),b]}},mapFromComponents:function(a,b){switch(a){case"r":return[b[2]/255,1-b[1]/255];case"g":return[b[2]/255,1-b[0]/255];case"b":return[b[0]/255,1-b[1]/255]}}},hsv:{components:[{label:"H",component:"h",min:0,max:360,unit:"° ",map:!0,stops:function(a){for(var b=[],c=60,d=0;360>=d;d+=c){var e=[d,a[1],a[2]];b.push(IFColor.rgbToHtmlHex(IFColor.hsvToRGB(e)))}return b}},{label:"S",component:"s",min:0,max:100,unit:"%",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.hsvToRGB([a[0],0,a[2]])),IFColor.rgbToHtmlHex(IFColor.hsvToRGB([a[0],1,a[2]]))]}},{label:"B",component:"v",min:0,max:100,unit:"%",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.hsvToRGB([a[0],a[1],0])),IFColor.rgbToHtmlHex(IFColor.hsvToRGB([a[0],a[1],1]))]}},{label:"#",component:"#",text:!0,unit:" ",map:!1,componentsToValue:function(a){return IFColor.rgbToHtmlHex(IFColor.hsvToRGB(a)).substr(1)},valueToColor:function(a){return a.length>3?IFRGBColor.parseCSSColor(a):null}}],componentToValue:function(a,b){switch(a){case"s":case"v":return b/100;default:return b}},valueToComponent:function(a,b){switch(a){case"s":case"v":return 100*b;default:return b}},componentsFromColor:function(a){return IFColor.rgbToHSV(a.toScreen())},colorFromComponents:function(a){return new IFRGBColor(IFColor.hsvToRGB(a))},componentsFromMap:function(a,b,c,d){switch(a){case"h":return[b,c,1-d];case"s":return[360*c,b,1-d];case"v":return[360*c,1-d,b]}},mapFromComponents:function(a,b){switch(a){case"h":return[b[1],1-b[2]];case"s":return[b[0]/360,1-b[2]];case"v":return[b[0]/360,1-b[1]]}}},cmyk:{components:[{label:"C",component:"c",min:0,max:100,unit:"%",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.cmykToRGB([0,a[1],a[2],a[3]])),IFColor.rgbToHtmlHex(IFColor.cmykToRGB([1,a[1],a[2],a[3]]))]}},{label:"M",component:"m",min:0,max:100,unit:"%",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],0,a[2],a[3]])),IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],1,a[2],a[3]]))]}},{label:"Y",component:"y",min:0,max:100,unit:"%",map:!0,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],a[1],0,a[3]])),IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],a[1],1,a[3]]))]}},{label:"K",component:"k",min:0,max:100,unit:"%",map:!1,stops:function(a){return[IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],a[1],a[2],0])),IFColor.rgbToHtmlHex(IFColor.cmykToRGB([a[0],a[1],a[2],1]))]}}],componentToValue:function(a,b){return b/100},valueToComponent:function(a,b){return 100*b},componentsFromColor:function(a){return a instanceof IFCMYKColor?a.getValue():IFColor.rgbToCMYK(a.toScreen(!0))},colorFromComponents:function(a){return new IFCMYKColor(a)},componentsFromMap:function(a,b,c,d,e){switch(a){case"c":return[b,1-d,c,e[3]];case"m":return[1-d,b,c,e[3]];case"y":return[1-d,c,b,e[3]]}},mapFromComponents:function(a,b){switch(a){case"c":return[b[2],1-b[1]];case"m":return[b[2],1-b[0]];case"y":return[b[1],1-b[0]]}}}},j={init:function(c){return c=a.extend({},c),this.each(function(){var e=this,f=b.bind(e),k=function(b,c){return a("<button></button>").attr("data-color-mode",b).text(c).on("click",function(){j.colorMode.call(e,b)})},l=function(b){return a("<div></div>").addClass("color-component color-component-"+b.toString()).append(a("<div></div>").addClass("color-check").append(a("<input>").attr("type","radio").attr("name","component-check").on("change",function(){j._updateMap.call(e)}))).append(a("<div></div>").addClass("color-label").on("click",function(){var a=m.find(".color-component-"+b.toString()+' input[type="text"]'),c=i[j.colorMode.call(e)];a.val(a.val()==c.components[b].max?c.components[b].min:c.components[b].max),a.trigger("input")})).append(a("<div></div>").addClass("color-range").append(a("<input>").attr("type","range").attr("tabIndex","-1").on("input",function(c){m.find(".color-component-"+b.toString()+' input[type="text"]').val(a(c.target).val()).trigger("input")}))).append(a("<div></div>").addClass("color-value").append(a("<input>").attr("type","text").on("input",function(c){var d=a(c.target),f=d.parents(".color-component"),g=i[j.colorMode.call(e)];if(g.components[b].text){var h=g.components[b].valueToColor(d.val());h&&(j.currentColor.call(e,h),m.trigger("colorchange",h))}else{var k=j._getComponents.call(e),h=g.colorFromComponents(k.components);j._setCurrentColor.call(e,h),j._updateComponents.call(e,k.components),j._updateMapMarker.call(e),j._updateWheelColor.call(e),m.trigger("colorchange",h),(!g.components[b].map||f.find('input[type="radio"]').is(":checked"))&&j._updateMap.call(e)}}))).append(a("<div></div>").addClass("color-unit"))},m=a(this).addClass("g-color-editor").data("gcoloreditor",{scene:null,previousColor:null,currentColor:null,options:c});m.append(a("<input>").attr("type","color").css({position:"absolute",visibility:"hidden"}).on("change",function(b){var c=IFRGBColor.parseCSSColor(a(b.target).val());j.currentColor.call(e,c),m.trigger("colorchange",c)}.bind(this))).append(a("<div></div>").addClass("color-container").append(a("<div></div>").addClass("color").append(a("<div></div>").addClass("map-container").append(a("<canvas></canvas>").addClass("map").attr({width:g.toString()+"px",height:h.toString()+"px"}).on("mousedown",function(a){f(a);var b=function(a){a.stopPropagation(),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",b,!0)};document.addEventListener("mousemove",f),document.addEventListener("mouseup",b,!0)})).append(a("<div></div>").addClass("marker"))).append(a("<div></div>").addClass("toolbar").append(k("rgb","RGB")).append(k("hsv","HSB")).append(k("cmyk","CMYK")).append(a("<button></button>").attr("title","System").append(a("<span></span>").addClass("fa fa-cog")).on("click",function(){m.find('input[type="color"]').trigger("click")})).append(a("<div></div>").addClass("color-preview").append(a("<div></div>").addClass("previous-color").gPatternTarget().gPatternTarget("types",[IFColor]).on("patternchange",function(a,b){b&&j.previousColor.call(e,b)})).append(a("<div></div>").addClass("current-color").gPatternTarget().gPatternTarget("types",[IFColor]).on("patternchange",function(a,b){b&&j.value.call(e,b)}).on("click",function(){m.find('input[type="color"]').trigger("click")})))).append(a("<div></div>").addClass("color-components").append(l(0)).append(l(1)).append(l(2)).append(l(3)))).append(a("<div></div>").addClass("wheel").append(a("<div></div>").addClass("toolbar").append(a("<select></select>").attr("data-wheel","mix").append(a("<option></option>").attr("value","").text("No Mixes")).append(a('<optgroup label="Mix"></optgroup>').append(a("<option></option>").attr("value","tint").text("Tints")).append(a("<option></option>").attr("value","shade").text("Shades")).append(a("<option></option>").attr("value","tone").text("Tones"))).append(a('<optgroup label="Blend Right"></optgroup>').append(a("<option></option>").attr("value","60").text("1 Quarter")).append(a("<option></option>").attr("value","120").text("2 Quarter")).append(a("<option></option>").attr("value","240").text("3 Quarter"))).append(a('<optgroup label="Blend Left"></optgroup>').append(a("<option></option>").attr("value","-60").text("1 Quarter")).append(a("<option></option>").attr("value","-120").text("2 Quarter")).append(a("<option></option>").attr("value","-240").text("3 Quarter"))).on("change",function(){j._updateWheelColor.call(e)}).val("tint")).append(a("<select></select>").attr("data-wheel","highlight").append(a("<option></option>").attr("value","start").text("Color Wheel")).append(a("<option></option>").attr("value","triadic").text("Triads")).append(a("<option></option>").attr("value","tetradic").text("Tetrads")).append(a("<option></option>").attr("value","split_complements").text("Split")).append(a("<option></option>").attr("value","complement").text("Complement")).append(a("<option></option>").attr("value","analogous").text("Analogous")).on("change",function(){j._updateWheelColor.call(e),j._updateWheelBorder.call(e)}))).append(a("<div></div>").addClass("wheel-container").append(a("<canvas></canvas>").addClass("color-wheel").attr({width:d.toString()+"px",height:d.toString()+"px"})).append(a("<canvas></canvas>").addClass("wheel-border").attr({width:d.toString()+"px",height:d.toString()+"px"}).on("mousedown",function(b){var c=m.data("gcoloreditor");if(c.wheelMap){var d=m.find("canvas.color-wheel"),f=a(d).offset(),g=Math.max(0,Math.min(d[0].width,Math.round(b.pageX-f.left))),h=Math.max(0,Math.min(d[0].height,Math.round(b.pageY-f.top))),i=4*(h*d[0].width+g),k=c.wheelMap.data;if(0!==k[i+3]){var l=new IFRGBColor([k[i],k[i+1],k[i+2]]),n=j._convertColor.call(e,l);m.find(".wheel-border").gPatternTarget("value",n)}}}).gPatternTarget({allowDrop:!1}).gPatternTarget("types",[IFColor]))))),j.colorMode.call(e,"hsv"),j._updateWheelBorder.call(e)})},colorMode:function(b){var c=a(this),d=c.find("[data-color-mode].g-active").attr("data-color-mode");if(arguments.length){if(b!==d){c.find("[data-color-mode]").each(function(c,d){var e=a(d);e.toggleClass("g-active",e.attr("data-color-mode")===b)});for(var e=i[b],f=0;4>f;++f){var g=c.find(".color-component-"+f.toString());if(f>=e.components.length)g.css("visibility","hidden"),g.removeAttr("data-component");else{var h=e.components[f];g.css("visibility",""),g.attr("data-component",h.component);var k=g.find('input[type="radio"]'),l=g.find('input[type="range"]'),m=g.find(".color-label"),n=g.find(".color-unit");k.prop("checked",0===f),m.text(h.label),n.text(h.unit),n.css("display",""!=h.unit?"":"none"),l.attr("min",h.min),l.attr("max",h.max),l.attr("step",h.step?h.step.toString():"")}}j._updateComponents.call(this);var o=j._getColorFromComponents.call(this);j.currentColor.call(this,o),c.trigger("colorchange",o)}return this}return d},previousColor:function(b){var c=a(this),d=c.data("gcoloreditor");return arguments.length?(IFUtil.equals(d.previousColor,b)||(d.previousColor=b,c.find(".color-preview > .previous-color").css("background",IFPattern.asCSSBackground(d.previousColor)).gPatternTarget("value",d.previousColor)),this):d.previousColor},currentColor:function(b){var c=a(this),d=c.data("gcoloreditor");return arguments.length?(j._setCurrentColor.call(this,b),j._updateComponents.call(this),j._updateMap.call(this),j._updateMapMarker.call(this),j._updateWheelColor.call(this),this):d.currentColor},value:function(b){var c=a(this),d=c.data("gcoloreditor");if(arguments.length){j.previousColor.call(this,b),j.currentColor.call(this,b);var e=j.colorMode.call(this);return b instanceof IFCMYKColor?j.colorMode.call(this,"cmyk"):b instanceof IFRGBColor&&"cmyk"===e&&j.colorMode.call(this,"hsv"),this}return d.currentColor},_setCurrentColor:function(b){var c=a(this),d=c.data("gcoloreditor");d.currentColor=b,c.find('input[type="color"]').val(IFColor.rgbToHtmlHex(d.currentColor.toScreen())),c.find(".color-preview > .current-color").css("background",IFPattern.asCSSBackground(d.currentColor)).gPatternTarget("value",d.currentColor)},_getComponents:function(){for(var b=a(this),c=i[j.colorMode.call(this)],d=b.find('input[name="component-check"]:checked').closest(".color-component").attr("data-component"),e={active:{component:d,value:null},components:[]},f=0;f<c.components.length;++f){var g=c.components[f],h=b.find(".color-component-"+f.toString()),k=h.find('input[type="text"]'),l=(h.find('input[type="range"]'),parseInt(k.val()));isNaN(l)||l<g.min?l=g.min:l>g.max&&(l=g.max);var m=c.componentToValue(g.component,l);e.components.push(m),g.component===d&&(e.active.value=m)}return e},_getColorFromComponents:function(){var b=(a(this),i[j.colorMode.call(this)]),c=j._getComponents.call(this);return b.colorFromComponents(c.components)},_convertColor:function(a){var b=i[j.colorMode.call(this)],c=b.componentsFromColor(a);return b.colorFromComponents(c)},_updateComponents:function(b){var c=a(this),d=c.data("gcoloreditor");if(d.currentColor){var e=i[j.colorMode.call(this)];if(b=b||e.componentsFromColor(d.currentColor))for(var f=0;f<e.components.length;++f){var g=e.components[f],h=c.find(".color-component-"+f.toString()),k=h.find('input[type="radio"]'),l=h.find('input[type="text"]'),m=h.find('input[type="range"]'),n=e.components[f].stops,o=n?n(b):null;if(o)if(1===o.length)m.css("background",o[0]);else{for(var p="",q=0;q<o.length;++q)""!==p&&(p+=","),p+=o[q];m.css("background","linear-gradient(90deg, "+p+")")}else m.css("background","");if(k.css("visibility",g.map?"":"hidden"),l.css("text-align",g.text?"left":"").parent().css("width",g.text?"100%":""),m.parent().css("display",g.text?"none":""),g.text)l.val(g.componentsToValue(b));else{var r=Math.min(g.max,Math.max(g.min,e.valueToComponent(g.component,b[f]))).toFixed(0);l.val(r),m.val(r)}}}},_updateMap:function(){for(var b=a(this),c=i[j.colorMode.call(this)],d=j._getComponents.call(this),e=b.find("canvas.map")[0].getContext("2d"),f=e.getImageData(0,0,g,h),k=0;g>k;++k)for(var l=0;h>l;++l){var m=c.componentsFromMap(d.active.component,d.active.value,k/g,l/h,d.components),n=c.colorFromComponents(m).toScreen(),o=4*(l*g+k);f.data[o]=n[0],f.data[o+1]=n[1],f.data[o+2]=n[2],f.data[o+3]=255}e.putImageData(f,0,0)},_updateMapMarker:function(){var b=a(this),c=i[j.colorMode.call(this)],d=j._getComponents.call(this),e=c.mapFromComponents(d.active.component,d.components);b.find(".map-container > .marker").css({left:Math.round(100*e[0])+"%",top:Math.round(100*e[1])+"%"})},_updateWheelColor:function(){var b=a(this),e=b.data("gcoloreditor"),g=b.find("canvas.color-wheel")[0],h=g.getContext("2d"),i=d/2,j=(d-14)/2;h.clearRect(0,0,g.width,g.height),c.call(this,function(a,b,c,d,e,g){if(h.beginPath(),h.moveTo(i,i),h.arc(i,i,j+(b?5:0),d,e),h.lineTo(i,i),h.fillStyle=IFColor.rgbToHtmlHex(IFColor.hsvToRGB(c)),h.fill(),g){h.globalAlpha=10/f*.1;var k=j/f;switch(g){case"tint":h.fillStyle="white";break;case"shade":h.fillStyle="black";break;case"tone":h.fillStyle="rgb(128,128,128)";break;default:var l=parseInt(g);if(!isNaN(l)){var m=IFMath.normalizeAngleDegrees(c[0]+l);h.fillStyle=IFColor.rgbToHtmlHex(IFColor.hsvToRGB([m,c[1],c[2]]))
}}for(var n=1;f>=n;++n)h.beginPath(),h.moveTo(i,i),h.arc(i,i,j-n*k,d,e),h.lineTo(i,i),h.fill();h.globalAlpha=1}}),e.wheelMap=h.getImageData(0,0,g.width,g.height)},_updateWheelBorder:function(){var b=a(this),e=b.find("canvas.wheel-border")[0],f=e.getContext("2d"),g=d/2,h=(d-14)/2;f.clearRect(0,0,e.width,e.height),f.strokeStyle="black",f.lineWidth=.5,c.call(this,function(a,b,c,d,e){f.beginPath(),f.moveTo(g,g),f.arc(g,g,h+(b?5:0),d,e),b?(f.lineTo(g,g),f.shadowBlur=3,f.shadowColor="rgba(0, 0, 0, 0.75)",f.lineWidth=1):(f.shadowBlur=0,f.lineWidth=.5),f.stroke()}),f.shadowBlur=0,f.beginPath(),f.arc(g,g,8,8,0,2*Math.PI),f.fillStyle="white",f.fill(),f.stroke()}};a.fn.gColorEditor=function(b){return j[b]?j[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):j.init.apply(this,arguments)}}(jQuery),function(a){function b(a){for(var b=0;b<c.length;++b)if(c[b].type===a)return c[b].icon;return null}var c=[{type:IFPathBase.CornerType.Rounded,icon:"gicon-corner-rounded"},{type:IFPathBase.CornerType.InverseRounded,icon:"gicon-corner-inverse-rounded"},{type:IFPathBase.CornerType.Bevel,icon:"gicon-corner-bevel"},{type:IFPathBase.CornerType.Inset,icon:"gicon-corner-inset"},{type:IFPathBase.CornerType.Fancy,icon:"gicon-corner-fancy"}],d={init:function(b){return b=a.extend({},b),this.each(function(){var b=this,e=a(this).data("gcornertype",{cornerType:null}).append("<span></span>").on("click",function(){for(var f=a("<div></div>").gOverlay({releaseOnClose:!0}),g=0;g<c.length;++g)a("<button></button>").addClass("g-flat").toggleClass("g-active",c[g].type===e.data("gcornertype").cornerType).attr("data-corner-type",c[g].type).append(a("<span></span>").addClass(c[g].icon)).on("click",function(){var c=a(this).attr("data-corner-type");d.value.call(b,c),e.trigger("cornertypechange",c),f.gOverlay("close")}).appendTo(f);f.gOverlay("open",this)})})},value:function(c){var d=a(this),e=d.data("gcornertype");return arguments.length?(e.cornerType=c,d.find("span").attr("class",b(e.cornerType)),this):e.cornerType}};a.fn.gCornerTypePicker=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery),function(a){var b=[{type:IFPaintCanvas.BlendMode.Normal,name:"Normal"},{type:IFPaintCanvas.BlendMode.Multiply,name:"Multiply"},{type:IFPaintCanvas.BlendMode.Screen,name:"Screen"},{type:IFPaintCanvas.BlendMode.Overlay,name:"Overlay"},{type:IFPaintCanvas.BlendMode.Darken,name:"Darken"},{type:IFPaintCanvas.BlendMode.Lighten,name:"Lighten"},{type:IFPaintCanvas.BlendMode.ColorDodge,name:"Color Dodge"},{type:IFPaintCanvas.BlendMode.ColorBurn,name:"Color Burn"},{type:IFPaintCanvas.BlendMode.HardLight,name:"Hard Light"},{type:IFPaintCanvas.BlendMode.SoftLight,name:"Soft Light"},{type:IFPaintCanvas.BlendMode.Difference,name:"Difference"},{type:IFPaintCanvas.BlendMode.Exclusion,name:"Exclusion"},{type:IFPaintCanvas.BlendMode.Hue,name:"Hue"},{type:IFPaintCanvas.BlendMode.Saturation,name:"Saturation"},{type:IFPaintCanvas.BlendMode.Color,name:"Color"},{type:IFPaintCanvas.BlendMode.Luminosity,name:"Luminosity"}],c={init:function(c){return c=a.extend({},c),this.each(function(){var c=a(this);if(c.is("select")){var d=c,e=c.find(":last");e.is("optgroup")&&(d=e);for(var f=0;f<b.length;++f)d.append(a("<option></option>").attr("value",b[f].type).text(b[f].name))}})}};a.fn.gBlendMode=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b=[{unit:IFLength.Unit.PX,name:"Pixels"},{unit:IFLength.Unit.MM,name:"Millimeters"},{unit:IFLength.Unit.CM,name:"Centimeters"},{unit:IFLength.Unit.IN,name:"Inches"},{unit:IFLength.Unit.PC,name:"Picas"},{unit:IFLength.Unit.PT,name:"Points"}],c={init:function(c){return c=a.extend({},c),this.each(function(){var c=a(this);if(c.is("select"))for(var d=0;d<b.length;++d)c.append(a("<option></option>").attr("value",b[d].unit).text(b[d].name))})}};a.fn.gUnit=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){function b(a){for(var b=0;b<p.length;++b)if(p[b].clazz===a)return p[b];return null}function c(a){var b=a.data("stop");a.css("left",Math.round(100*b.position)+"%"),a.find(".stop-value").css("background",b.color.toScreenCSS()),a.gPatternTarget("value",b.color)}function d(a){var b=a.data("stop");a.css("left",Math.round(100*b.position)+"%");var c=Math.round(255*(1-b.opacity));a.find(".stop-value").css("background",IFColor.rgbToHtmlHex([c,c,c]))}function e(){var c=a(this),d=c.data("ggradienteditor"),e=c.find('[data-section="type"] > .g-button.g-active').data("gradientClass"),f=d.gradient.getStops(),g=IFUtil.parseNumber(c.find('[data-property="scale"]').val()),h=c.find('[data-section="settings"]');isNaN(g)||0>=g?g=1:g/=100;var i=b(e),j=i.createGradient(f,g,"none"!==h.css("display")?h:null);q.value.call(this,j)}function f(){e.call(this),a(this).trigger("gradientchange")}function g(b){var c=a(this),d=c.data("ggradienteditor"),e=d.gradient;if(b){var f=c.find(".stops > .stop"),g=c.find(".opacities > .stop"),h=[];f.each(function(b,c){var d=a(c);d.data("stop-delete")===!1&&h.push(d.data("stop"))}),g.each(function(b,c){var d=a(c);d.data("stop-delete")===!1&&h.push(d.data("stop"))}),h.sort(function(a,b){return a.position>b.position}),e=new IFGradient(h)}c.find(".gradient").css("background","linear-gradient(90deg, "+e.toScreenCSS()+"), "+IFPattern.asCSSBackground(null))}function h(){g.call(this),a(this).trigger("gradientchange")}function i(){var b=a(this),c=b.data("ggradienteditor");c.gradient.getStops().sort(function(a,b){return a.position>b.position}),q.value.call(this,c.gradient),a(this).trigger("gradientchange")}function j(a,b){var c=a.width(),d=b-a.offset().left;return 0>d?0:d>c?1:d/c}function k(a){a.stopPropagation()}function l(b,d){b.stopPropagation();var e=a(b.target).closest(".stop");d&&(e.data("stop").color=d,c(e),h.call(this))}function m(b){var d=this,e=a(this),f=e.data("ggradienteditor"),h=e.find(".stops"),j=a(b.target).closest(".stop"),k=h.offset(),l=k.left,m=l+h.width(),n=k.top-5,o=k.top+h.outerHeight()+5,p=j.outerWidth(),q=j.offset().left+p-b.pageX,r=j.offset().top-b.pageY,s=h.children(".stop").length,t=a(document);j.data("stop-moved",!1);var u=function(a){var b=a.pageX+q-p/2,e=a.pageY+r;l>=b?b=l:b>=m&&(b=m),(n>e||e>o)&&s>2?j.css("display","none").data("stop-delete",!0):j.css("display","").data("stop-delete",!1);var f=b-l,h=m-l,i=0>=f?0:f>=h?1:f/h;j.data("stop").position=i,c(j),g.call(d,!0),j.data("stop-moved",!0)},v=function(){if(t.off("mousemove",u).off("mouseup",v),j.data("stop-delete")===!0){var a=f.gradient.getStops();a.splice(a.indexOf(j.data("stop")),1),i.call(d)}else j.data("stop-moved")&&e.trigger("gradientchange")};t.on("mousemove",u).on("mouseup",v)}function n(b){var c=this,e=(a(this),a(b.target).closest(".stop"));e.data("stop-moved")||a("<div></div>").addClass("opacity-editor").css({display:"inline-block",padding:"5px"}).append(a("<label></label>").text("Opacity: ").append(a("<input>").attr("type","text").css("width","40px").val(Math.round(100*e.data("stop").opacity)).on("change",function(){var b=a(this),f=parseInt(b.val());!isNaN(f)&&f>=0&&100>=f&&(b.parents(".opacity-editor").find('input[type="range"]').val(b.val()),e.data("stop").opacity=f/100,d(e),h.call(c))})).append(a("<span>%</span>"))).append(a("<input>").css({display:"block","margin-top":"5px"}).attr({type:"range",min:"0",max:"100"}).val(Math.round(100*e.data("stop").opacity)).on("input",function(){var b=a(this);b.parents(".opacity-editor").find('input:not([type="range"])').val(b.val()).trigger("change")})).gOverlay({modal:!0,releaseOnClose:!0}).gOverlay("open",e)}function o(b){var c=this,e=a(this),f=e.data("ggradienteditor"),h=e.find(".opacities"),j=a(b.target).closest(".stop"),k=h.offset(),l=k.left,m=l+h.width(),n=k.top-5,o=k.top+h.outerHeight()+5,p=j.outerWidth(),q=j.offset().left+p-b.pageX,r=j.offset().top-b.pageY,s=h.children(".stop").length,t=a(document);j.data("stop-moved",!1);var u=function(a){var b=a.pageX+q-p/2,e=a.pageY+r;l>=b?b=l:b>=m&&(b=m),(n>e||e>o)&&s>2?j.css("display","none").data("stop-delete",!0):j.css("display","").data("stop-delete",!1);var f=b-l,h=m-l,i=0>=f?0:f>=h?1:f/h;j.data("stop").position=i,j.data("stop-moved",!0),d(j),g.call(c,!0)},v=function(){if(t.off("mousemove",u).off("mouseup",v),j.data("stop-delete")===!0){var a=f.gradient.getStops();a.splice(a.indexOf(j.data("stop")),1),i.call(c)}else j.data("stop-moved")&&e.trigger("gradientchange")};t.on("mousemove",u).on("mouseup",v)}var p=[{clazz:IFLinearGradient,name:"Linear Gradient",cssBackground:(new IFLinearGradient).asCSSBackground(),initSettings:function(b,c){return b.append(a("<span></span>").addClass("fa fa-rotate-right").css("padding-right","3px")).append(a("<input>").attr({type:"text","data-property":"angle"}).css("width","30px").on("change",function(){c()})).append(a("<span>°</span>")),!0},updateSettings:function(a,b){var c=IFMath.toDegrees(b.getAngle());a.find('[data-property="angle"]').val(IFUtil.formatNumber(c,2))},createGradient:function(a,b,c){var d=0;return c&&(d=IFUtil.parseNumber(c.find('[data-property="angle"]').val()),d=isNaN(d)?0:IFMath.toRadians(IFMath.normalizeAngleDegrees(d))),new IFLinearGradient(a,b,d)}},{clazz:IFRadialGradient,name:"Radial Gradient",cssBackground:(new IFRadialGradient).asCSSBackground(),initSettings:function(){return!1},updateSettings:function(){},createGradient:function(a,b){return new IFRadialGradient(a,b)}}],q={init:function(b){return b=a.extend({},b),this.each(function(){for(var c=this,d=a(this).addClass("g-gradient-editor").data("ggradienteditor",{options:b,gradient:null}),e=a("<div></div>").addClass("container").appendTo(d),g=a("<div></div>").attr("data-section","type"),h=0;h<p.length;++h){var k=p[h];a("<span></span>").data("gradientClass",k.clazz).addClass("g-button").attr("title",k.name).append(a("<span></span>").css({background:k.cssBackground})).on("click",function(b){var e=a(b.target).closest(".g-button").data("gradientClass");d.find('[data-section="type"] > .g-button').each(function(b,c){var d=a(c);d.toggleClass("g-active",d.data("gradientClass")===e)}),f.call(c)}).appendTo(g)}e.append(a("<div></div>").addClass("editor").gPatternTarget().gPatternTarget("types",[IFColor,IFGradient]).on("patternchange",function(a){a.stopPropagation()}).on("patterndrop",function(a,b,e){if(a.stopPropagation(),b&&b instanceof IFColor){var f=d.find(".stops"),g=d.gGradientEditor("value").getStops();g.push({position:j(f,e.pageX),color:b}),i.call(c)}else b instanceof IFGradient&&(q.value.call(c,b.clone()),d.trigger("gradientchange"))}).append(a("<div></div>").addClass("opacities").on("mousedown",function(a){a.preventDefault(),a.stopPropagation()}).on("dblclick",function(b){var e=a(b.target);if(e.hasClass("opacities")){var f=j(e,b.pageX),g=d.gGradientEditor("value").getStops();g.push({position:f,opacity:IFGradient.interpolateOpacity(g,f)}),i.call(c)}})).append(a("<div></div>").addClass("gradient g-input").css("background","transparent")).append(a("<div></div>").addClass("stops").on("mousedown",function(a){a.preventDefault(),a.stopPropagation()}).on("dblclick",function(b){var e=a(b.target);if(e.hasClass("stops")){var f=j(e,b.pageX),g=d.gGradientEditor("value").getStops();g.push({position:f,color:IFGradient.interpolateColor(g,f)}),i.call(c)}}))).append(a("<div></div>").addClass("toolbar").append(g).append(a("<div></div>").append(a("<span></span>").addClass("fa fa-arrows-h").css("padding-right","3px")).append(a("<input>").attr({type:"text","data-property":"scale"}).css("width","30px").on("change",function(){f.call(c)})).append(a("<span>%</span>"))).append(a("<div></div>").attr("data-section","settings")).append(a("<div></div>").append(a("<button></button>").append(a("<span></span>").addClass("fa fa-exchange")).on("click",function(){for(var a=d.gGradientEditor("value").getStops(),b=0;b<a.length;++b)a[b].position=1-a[b].position;i.call(c)}))))})},value:function(c){var d=a(this),e=d.data("ggradienteditor");if(arguments.length){var h=e.gradient?e.gradient.constructor:null;e.gradient=c;var i=b(c.constructor);d.find(".editor").gPatternTarget("value",c),d.find(".stops").empty(),d.find(".opacities").empty(),d.find('[data-section="type"] > .g-button').each(function(b,d){var e=a(d);e.toggleClass("g-active",e.data("gradientClass")===c.constructor)});var j=d.find('[data-section="settings"]');h!==e.gradient.constructor&&(j.css("display","none").empty(),i.initSettings(j,f.bind(this))&&j.css("display",""));var k=Math.round(100*e.gradient.getScale());if(d.find('[data-property="scale"]').val(k),i.updateSettings(j,e.gradient),c)for(var l=c.getStops(),m=0;m<l.length;++m)l[m].hasOwnProperty("color")?q.insertStop.call(this,l[m]):l[m].hasOwnProperty("opacity")&&q.insertOpacity.call(this,l[m]);return g.call(this),this}return e.gradient},insertOpacity:function(b){var c=a(this),e=c.find(".opacities"),f=a("<div></div>").addClass("stop").data("stop",b).data("stop-delete",!1).append(a("<div></div>").addClass("stop-value")).on("click",n.bind(this)).on("mousedown",o.bind(this)).appendTo(e);d(f)},insertStop:function(b){var d=a(this),e=d.find(".stops"),f=a("<div></div>").addClass("stop").data("stop",b).data("stop-delete",!1).gPatternTarget({allowDrag:!1}).gPatternTarget("types",[IFColor]).append(a("<div></div>").addClass("stop-value")).on("patternchange",l.bind(this)).on("patterndrop",k).on("mousedown",m.bind(this)).appendTo(e);c(f)}};a.fn.gGradientEditor=function(b){return q[b]?q[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):q.init.apply(this,arguments)}}(jQuery),function(a){var b=[];document.addEventListener("keydown",function(c){b.length>0&&27===c.keyCode&&a(b[b.length-1]).gOverlay("close")}),document.addEventListener("mousedown",function(c){if(b.length>0){var d=a(b[b.length-1]),e=d.parents(".g-overlay"),f=e.outerWidth(),g=e.outerHeight(),h=d.offset(),i=c.pageX-h.left,j=c.pageY-h.top;(0>i||0>j||i>f||j>g)&&d.gOverlay("close")}});var c={init:function(b){return b=a.extend({modal:!1,releaseOnClose:!1},b),this.each(function(){var c=a(this).data("goverlay",{options:b,target:null,modal:!1});a("<div></div>").addClass("g-overlay").css("position","absolute").append(c)})},relayout:function(){var b=a(this),c=b.data("goverlay");if(c.target){var d=b.parents(".g-overlay"),e=a(window),f=e.width(),g=e.height(),h=d.outerWidth(),i=d.outerHeight(),j=a(c.target),k=j.offset(),l=k.top,m=k.left,n=k.left+j.outerWidth(),o=k.top+ +j.outerHeight(),p=m,q=o;p+h>f&&(p=n-h),p+h>f&&(p=f-h),q+i>g&&(q=l-i),q+i>g&&(q=g-i),0>q&&(q=0),0>p&&(p=0),d.css("left",p+"px").css("top",q+"px")}},open:function(d,e){var f=a(this),g=f.data("goverlay"),h=g.options;g.target=d,g.modal=e;var i=f.parents(".g-overlay"),e=e||h.modal;return e?a("<div></div>").addClass("g-overlay-modal").append(i).appendTo(a("body")):i.appendTo(a("body")),c.relayout.call(this),b.push(this[0]),this},close:function(){var c=a(this),d=c.data("goverlay");if(b.length&&b[b.length-1]===this[0]){d.modal=!1,d.target=null;var e=d.options;c.trigger("close");var f=c.parents(".g-overlay-modal");e.releaseOnClose?c.parents(".g-overlay").remove():c.parents(".g-overlay").detach(),f.length&&f.remove(),b.pop()}return this}};a.fn.gOverlay=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):c.init.apply(this,arguments)}}(jQuery),function(a){var b={init:function(){return this.each(function(){var c=this,d=a(this).data("gpivot",{value:null}).addClass("g-pivot"),e=function(e){a("<div></div>").addClass("side").attr("data-side",e).on("click",function(){b.value.call(c,e),d.trigger("pivotchange",e)}).appendTo(d)};a("<div></div>").addClass("borderline").appendTo(d);for(var f in IFRect.Side)if(IFRect.Side.hasOwnProperty(f)){var g=IFRect.Side[f];"string"==typeof g&&e(g)}})},value:function(b){var c=a(this),d=c.data("gpivot");return arguments.length?(d.value=b,c.find("div[data-side]").each(function(c,d){var e=a(d);e.toggleClass("g-active",e.attr("data-side")===b)}),this):d.value}};a.fn.gPivot=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.myPlugin"):b.init.apply(this,arguments)}}(jQuery),function(a){function b(b,c){var d=b.getScene(),e=d.pointToString(b.getProperty("x")),f=d.pointToString(b.getProperty("y")),g=d.pointToString(b.getProperty("r")),h=b.getProperty("pat"),i=b.getProperty("opc");return a("<div></div>").addClass("g-form").append(a("<div></div>").append(a("<div></div>").append(a("<input>").css("width","3em").val(e).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&c(["x"],[b])})).append(a("<label></label>").text("X"))).append(a("<div></div>").append(a("<input>").css("width","3em").val(f).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&c(["y"],[b])})).append(a("<label></label>").text("Y"))).append(a("<div></div>").append(a("<input>").css("width","3em").val(g).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&b>=0&&c(["r"],[b])})).append(a("<label></label>").text("Blur"))).append(a("<div></div>").css("text-align","center").append(a("<button></button>").gPatternPicker({modal:!0}).gPatternPicker("types",[IFColor,IFGradient]).gPatternPicker("scene",d).gPatternPicker("value",h).gPatternPicker("opacity",i).on("patternchange",function(a,b,d){"number"==typeof d?c(["pat","opc"],[b,d]):c(["pat"],[b])})).append(a("<label></label>").text("Fill"))))}function c(a){var b=null;b=a instanceof IFEffect?a.constructor:a;for(var c=0;c<o.length;++c)if(o[c].clazz===b)return o[c];throw new Error("Invalid effect/class")}function d(b){if(p){var c=a(b).data("effect");if(c&&(c!==p||ifPlatform.modifiers.shiftKey))return p.getParent()===c.getParent()}return!1}function e(){if(!t){t=new GMenu;for(var a=null,b=0;b<o.length;++b){var c=o[b];a&&c.group!==a&&(t.createAddDivider(),a=c.group),t.createAddItem(ifLocale.getValue(c.clazz,"name")).setData(c.clazz)}}return t}function f(b,c){for(var d=a(this),e=d.data("geffectpanel").elements,f=b.getParent().getIndexOfChild(b),g=0;g<e.length;++g)for(var h=e[g].getEffects(),i=h.getFirstChild();null!==i;i=i.getNext())i!==b&&(IFUtil.equals(i,b)||i.constructor===b.constructor&&h.getIndexOfChild(i)===f)&&c(i)}function g(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof IFEffect&&b.node.getOwnerStylable()===d[0]&&j.call(this,b.node)}function h(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof IFEffect&&b.node.getOwnerStylable()===d[0]&&l.call(this,b.node)}function i(b){var c=a(this),d=c.data("geffectpanel").elements;b.node instanceof IFEffect&&b.node.getOwnerStylable()===d[0]&&k.call(this,b.node)}function j(b){var e=this,g=a(this),h=g.data("geffectpanel"),i=g.find('[data-action="style-layer"]').val()||null;if("*"===i||b.getProperty("ly")===i){var j=null,l=b.getPrevious();l&&g.find(".effect-block").each(function(b,c){var d=a(c);return d.data("effect")===l?(j=d,!1):void 0});var m=c(b),n=null;m.createPreview?(n=a("<div></div>").addClass("preview"),m.createPreview(n)):n=a("<span></span>").addClass("fa fa-cog fa-fw");var o=a("<div></div>").addClass("effect-block").data("effect",b).attr("draggable","true").append(a("<div></div>").addClass("effect-settings grid-icon").attr("title","Effect Settings").css("visibility",m.createSettings||m.openSettings?"":"hidden").on("click",function(a){a.stopPropagation();var c=function(a,c){IFEditor.tryRunTransaction(b,function(){f.call(e,b,function(b){b.setProperties(a,c)}),b.setProperties(a,c)},"Change Effect Properties")};if(m.openSettings)m.openSettings(b,c,a.target);else{var d=m.createSettings(b,c);d&&d.addClass("settings").css({display:"inline-block",padding:"5px"}).gOverlay({releaseOnClose:!0}).gOverlay("open",a.target)}}).append(n)).append(a("<div></div>").addClass("effect-title grid-main").text(b.getNodeNameTranslated())).append(a("<div></div>").addClass("effect-layer grid-icon").on("click",function(c){c.stopPropagation();var d=b.getProperty("ly"),g=h.elements&&h.elements.length?h.elements[0]:null,i=g?g.getStyleLayers():null;if(i&&i.length){var j=a("<div></div>").gOverlay({releaseOnClose:!0});i.unshift("");for(var k=0;k<i.length;++k){var l=i[k];a("<button></button>").addClass("g-flat").toggleClass("g-active",d===l).css("display","block").data("layer",l).text(ifLocale.get(IFStylable.StyleLayerName[l?l:""])).on("click",function(c){var d=a(c.target).data("layer")||null;IFEditor.tryRunTransaction(b,function(){f.call(e,b,function(a){a.setProperty("ly",d)}),b.setProperty("ly",d)},"Change Effect Layer"),j.gOverlay("close")}).appendTo(j)}j.gOverlay("open",this)}}).append(a("<span></span>").addClass("fa fa-fw"))).append(a("<div></div>").addClass("effect-visibility grid-icon").attr("title","Toggle Effect Visibility").on("click",function(a){a.stopPropagation(),IFEditor.tryRunTransaction(b,function(){f.call(e,b,function(a){a.setProperty("vs",!b.getProperty("vs"))}),b.setProperty("vs",!b.getProperty("vs"))},"Toggle Effect Visibility")}).append(a("<span></span>").addClass("fa fa-fw"))).on("dragstart",function(b){var c=a(this),e=c.offset(),f=b.originalEvent;f.stopPropagation(),p=c.data("effect"),s=!1,q=f.pageX-e.left,r=f.pageY-e.top,f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("text/plain","dummy_data"),g.find(".effect-block").each(function(b,c){a(c).append(a("<div></div>").addClass("grid-drag-overlay").on("dragenter",function(){d(this.parentNode)&&a(this).parent().addClass("g-drop")}).on("dragleave",function(){d(this.parentNode)&&a(this).parent().removeClass("g-drop")}).on("dragover",function(a){var b=a.originalEvent;d(this.parentNode)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){var b=a(this.parentNode);b.removeClass("g-drop"),g.find(".grid-drag-overlay").remove(),s=!0;var c=b.data("effect");if(p&&p.getParent()===c.getParent()){var d=p.getParent(),e=d.getIndexOfChild(p),f=d.getIndexOfChild(c);IFEditor.tryRunTransaction(d,function(){if(ifPlatform.modifiers.shiftKey){var a=p.clone();d.insertChild(a,f>e?c.getNext():c)}else d.removeChild(p),d.insertChild(p,f>e?c.getNext():c)},ifPlatform.modifiers.shiftKey?"Duplicate Effect":"Move Effect")}}))})}).on("dragend",function(a){var b=a.originalEvent;if(b.stopPropagation(),g.find(".grid-drag-overlay").remove(),!s){var c=g.offset(),d=c.left,h=c.top,i=d+g.outerWidth(),j=h+g.outerHeight(),k=b.pageX+q,l=b.pageY+r;(d>k||k>i||h>l||l>j)&&IFEditor.tryRunTransaction(p,function(){f.call(e,p,function(a){a.getParent().removeChild(a)}),p.getParent().removeChild(p)},"Remove Effect")}p=null,s=!1});j&&j.length>0?o.insertBefore(j):o.appendTo(g.find(".effects")),k.call(this,b)}}function k(b){var d=a(this);d.find(".effect-block").each(function(d,e){var f=a(e);if(f.data("effect")===b){var g=c(b),h=b.getProperty("vs"),i=b.getProperty("ly");return f.toggleClass("g-selected",b.hasFlag(IFNode.Flag.Selected)),g.updatePreview&&g.updatePreview(f.find(".effect-settings>:first-child"),b),f.find(".effect-visibility").toggleClass("grid-icon-default",h).find("> span").toggleClass("fa-eye",h).toggleClass("fa-eye-slash",!h),f.find(".effect-layer").toggleClass("grid-icon-default",!i).attr("title","Applies to "+ifLocale.get(IFStylable.StyleLayerName[i?i:""])).find("> span").toggleClass("fa-circle",!i).toggleClass("gicon-fill",i===IFStylable.StyleLayer.Fill).toggleClass("gicon-stroke",i===IFStylable.StyleLayer.Border),!1}})}function l(b){var c=a(this);c.find(".effect-block").each(function(c,d){var e=a(d);return e.data("effect")===b?(e.remove(),!1):void 0})}function m(){var b=a(this),c=b.data("geffectpanel");if(b.find(".effects").empty(),c.elements)for(var d=c.elements[0].getEffects(),e=d.getFirstChild();null!==e;e=e.getNext())e instanceof IFEffect&&j.call(this,e)}function n(){var b=a(this),c=b.data("geffectpanel"),d=b.find('[data-action="style-layer"]');d.empty().css("display","none").append(a("<option></option>").attr("value","*").text("All Effects")).append(a("<option></option>").attr("value","").text(ifLocale.get(IFStylable.StyleLayerName[""]))),d.val("*");var e=c.elements&&c.elements.length?c.elements[0]:null,f=e?e.getStyleLayers():null;if(f){d.css("display","");for(var g=0;g<f.length;++g){var h=f[g];d.append(a("<option></option>").attr("value",h).text(ifLocale.get(IFStylable.StyleLayerName[h])))}}}var o=[{clazz:IFBlurEffect,group:"raster",createSettings:function(b,c){var d=b.getScene(),e=d.pointToString(b.getProperty("r"));return a("<div></div>").append(a("<input>").attr("type","range").attr("min","0").attr("max","50").attr("data-property","r").val(e).on("input",function(){var b=a(this);b.parents(".settings").find('[data-property="r"]:not([type="range"])').val(b.val()).trigger("change")})).append(a("<input>").css("width","3em").attr("data-property","r").val(e).on("change",function(){var b=d.stringToPoint(a(this).val());null!==b&&"number"==typeof b&&b>=0&&c(["r"],[b])}))}},{clazz:IFDropShadowEffect,group:"raster",createSettings:b,createPreview:function(a){a.gPatternTarget({types:[IFColor],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",IFPattern.asCSSBackground(c,d))}},{clazz:IFInnerShadowEffect,group:"raster",createSettings:b,createPreview:function(a){a.gPatternTarget({types:[IFColor],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",IFPattern.asCSSBackground(c,d))}},{clazz:IFOverlayEffect,group:"filter",openSettings:function(b,c,d){a.gPatternPicker.open({target:d,scene:b.getScene(),types:[IFColor,IFGradient],value:b.getProperty("pat"),opacity:b.getProperty("opc"),changeCallback:function(a,b,d){"number"==typeof d?c(["pat","opc"],[b,d]):c(["pat"],[b])}})},createPreview:function(a){a.gPatternTarget({types:[IFColor,IFGradient],allowDrop:!1})},updatePreview:function(a,b){var c=b.getProperty("pat"),d=b.getProperty("opc");a.gPatternTarget("value",c).css("background",IFPattern.asCSSBackground(c,d))}},{clazz:IFColorGradingEffect,group:"filter",createSettings:function(b,c){return a("<div></div>").append(a("<input>").attr("type","file").css({position:"absolute",left:"-10000px"}).on("change",function(b){var d=a(b.target)[0].files;if(d&&d.length){var e=new FileReader;e.onload=function(a){try{c(["cp"],[IFColorGradingFilter.parseACV(a.target.result)])}catch(b){}},e.readAsArrayBuffer(d[0])}})).append(a("<select></select>").append(a("<option></option>").attr("value","").text("None")).append(a('<optgroup label="Instagram"></optgroup>').append(a("<option></option>").attr("value","1977").text("1977")).append(a("<option></option>").attr("value","Brannan").text("Brannan")).append(a("<option></option>").attr("value","Gotham").text("Gotham")).append(a("<option></option>").attr("value","Hefe").text("Hefe")).append(a("<option></option>").attr("value","Lord Kelvin").text("Lord Kelvin")).append(a("<option></option>").attr("value","Nashville").text("Nashville")).append(a("<option></option>").attr("value","X-PRO II").text("X-PRO II"))).on("change",function(b){var d=a(b.target),e=d.val();e?a.ajax({url:"acv/"+e+".acv",async:!1,dataType:"arraybuffer",success:function(a){c(["cp"],[IFColorGradingFilter.parseACV(a)])}}):c(["cp"],[null])})).append(a("<button></button>").text("Load ACV...").on("click",function(b){a(b.target).parents(".settings").find('input[type="file"]').focus().trigger("click")}))}}],p=null,q=0,r=0,s=!1,t=null,u={init:function(b){return b=a.extend({},b),this.each(function(){var c=this,d=a(this).addClass("g-effect-panel").data("geffectpanel",{elements:null,options:b}).append(a("<div></div>").addClass("g-grid effects")).append(a("<select></select>").attr("data-action","style-layer").css({position:"absolute",left:"0px",bottom:"5px"}).on("change",function(b){var d=a(b.target).val();u.layer.call(c,d?d:null)})).append(a("<div></div>").css({position:"absolute",right:"0px",bottom:"5px"}).append(a("<button></button>").attr("data-action","create").append(a("<span></span>").addClass("fa fa-plus")).gMenuButton({menu:e(),arrow:!1}).on("menuitemactivate",function(a,b){var e=u.layer.call(c),f=b.getData(),g=d.data("geffectpanel").elements;g&&g.length&&IFEditor.tryRunTransaction(g[0],function(){for(var a=0;a<g.length;++a){var b=new f;b.setProperty("ly",e),g[a].getEffects().appendChild(b)}},"Add Effect")})).append(a("<button></button>").attr("data-action","delete").attr("title","Remove hidden effects").on("click",function(){var a=d.data("geffectpanel").elements;if(a&&a.length){var b=a[0].getEffects();IFEditor.tryRunTransaction(b,function(){for(var a=b.getFirstChild();null!==a;a=a.getNext())a.getProperty("vs")===!1&&(f.call(c,a,function(a){a.getParent().removeChild(a)}),a.getParent().removeChild(a))},"Remove Hidden Effects")}}).append(a("<span></span>").addClass("fa fa-trash-o"))))})},elements:function(b){var c=a(this),d=c.data("geffectpanel");if(arguments.length){if(d.elements&&d.elements.length){var e=d.elements[0].getScene();e&&(e.removeEventListener(IFNode.AfterInsertEvent,d.afterInsertHandler),e.removeEventListener(IFNode.BeforeRemoveEvent,d.beforeRemoveHandler),e.removeEventListener(IFNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler)),d.afterInsertHandler=null,d.beforeRemoveHandler=null,d.afterPropertiesChangeHandler=null}if(d.elements=b,d.elements&&d.elements.length){var e=d.elements[0].getScene();e&&(d.afterInsertHandler=g.bind(this),d.beforeRemoveHandler=h.bind(this),d.afterPropertiesChangeHandler=i.bind(this),e.addEventListener(IFNode.AfterInsertEvent,d.afterInsertHandler),e.addEventListener(IFNode.BeforeRemoveEvent,d.beforeRemoveHandler),e.addEventListener(IFNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler))}return n.call(this),m.call(this),this}return d.elements},layer:function(b){{var c=a(this);c.data("geffectpanel")}if(arguments.length)return c.find('[data-action="style-layer"]').val(b?b:""),m.call(this),this;var d=c.find('[data-action="style-layer"]').val();return d&&"*"!==d?d:null}};a.fn.gEffectPanel=function(b){return u[b]?u[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):u.init.apply(this,arguments)}}(jQuery),function(a){function b(a,b,c){var d=new IFRect(0,0,b,c),e=a.getStylePropertySets(),f=null;if(e.indexOf(IFStylable.PropertySet.Text)>=0||e.indexOf(IFStylable.PropertySet.Paragraph)>=0)f=new IFText,f.fromHtml('<p style="font-size:30">A</p>');else{f=new IFRectangle;var g=d.getWidth()-d.getX(),h=d.getHeight()-d.getY();f.setProperty("trf",new IFTransform(g/2,0,0,h/2,g/2,h/2))}return f.assignFrom(a),f.toBitmap(new IFLength(b),new IFLength(c),2).toImageDataUrl(IFBitmap.ImageType.PNG)}function c(b,c){b.find(".style-block").each(function(b,d){var e=a(d);e.toggleClass("selected",e.data("style")===c)})}function d(b){var c=b.data("gstylepanel");if(c.options.placeholder){var d=b.find(".placeholder"),e=b.find("> .style-block");0===e.length?0===d.length&&(d=a("<div></div>").addClass("placeholder").text(c.options.placeholder).appendTo(b)):d.length>0&&d.remove()}}function e(b){var c=a(this),d=c.data("gstylepanel").container;b.node instanceof IFStyle&&b.node.getParent()===d&&i.call(this,b.node)}function f(b){var c=a(this),d=c.data("gstylepanel").container;b.node instanceof IFStyle&&b.node.getParent()===d&&k.call(this,b.node)}function g(b){var c=a(this),d=c.data("gstylepanel").container;b.node.getParent()===d&&j.call(this,b.node)}function h(b,c){var d=b.data("gstylepanel");if(m){var e=a(c).data("style");if(e&&(e!==m||ifPlatform.modifiers.shiftKey))return m.getParent()===e.getParent()?d.options.allowReorder:d.options.allowDrop
}return!1}function i(b,e){var f=a(this),g=f.data("gstylepanel"),i=null;"number"==typeof e?i=f.children(".style-block").eq(e):b.getNext()&&f.find(".style-block").each(function(c,d){var e=a(d);return e.data("style")===b.getNext()?(i=e,!1):void 0});var k=a("<div></div>").addClass("style-block").data("style",b).append(a("<div></div>").addClass("style-content").append(a("<div></div>").addClass("style-preview").append(a("<img>"))).append(a("<div></div>").addClass("style-name"))).on("mousedown",function(){f.data("gstylepanel").selected=b,c(f,b)}).on("click",function(){f.trigger("stylechange",b)});g.options.allowNameEdit&&k.gAutoEdit({selector:".style-name"}).on("submitvalue",function(a,c){c&&""!==c.trim()&&IFEditor.tryRunTransaction(b,function(){b.setProperty("name",c)},"Rename Style")}),(g.options.allowDrag||g.options.allowReorder)&&k.attr("draggable","true").on("dragstart",function(c){var d=c.originalEvent;d.stopPropagation(),m=a(this).data("style"),g.options.allowDrag&&(f.trigger("styledragstart",b),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData(IFNode.MIME_TYPE,IFNode.serialize(b)),d.dataTransfer.setDragImage(k.find(".style-preview > img")[0],g.options.previewWidth/2,g.options.previewHeight/2))}).on("dragend",function(a){var c=a.originalEvent;if(c.stopPropagation(),m=null,g.options.allowDrag){var d=f.offset(),e=f.outerWidth(),h=f.outerHeight(),i=c.pageX,j=c.pageY;i<=d.left||i>=d.left+e||j<=d.top||j>=d.top+h?f.trigger("styledragaway",b):f.trigger("styledragend",b)}}),(g.options.allowDrop||g.options.allowReorder)&&k.on("dragenter",function(){h(f,this)&&a(this).addClass("drop")}).on("dragleave",function(){h(f,this)&&a(this).removeClass("drop")}).on("dragover",function(a){var b=a.originalEvent;h(f,this)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){a(this).removeClass("drop");var b=a(this).data("style");if(g.options.allowReorder&&m){if(g.container&&m.getParent()===g.container){var c=m.getParent(),d=c.getIndexOfChild(m),e=c.getIndexOfChild(b);IFEditor.tryRunTransaction(c,function(){if(ifPlatform.modifiers.shiftKey){var a=m.clone();a.setProperty("name",a.getProperty("name")+"-copy"),c.insertChild(a,e>d?b.getNext():b)}else c.removeChild(m),c.insertChild(m,e>d?b.getNext():b)},ifPlatform.modifiers.shiftKey?"Duplicate Style":"Move Style")}f.trigger("stylemove",[m,b])}else g.options.allowDrop&&f.trigger("styledrop",[m,b])}),i&&i.length>0?k.insertBefore(i):k.appendTo(f),d(f),j.call(this,b)}function j(c){var d=a(this),e=d.data("gstylepanel");d.find(".style-block").each(function(d,f){var g=a(f);if(g.data("style")===c){g.find(".style-preview > img").attr("src",b(c,e.options.previewWidth,e.options.previewHeight));var h=c.getProperty("name");return g.attr("title",h),g.find(".style-name").text(h),!1}})}function k(b){var c=a(this),e=c.data("gstylepanel");c.find(".style-block").each(function(f,g){var h=a(g);return h.data("style")===b?(h.remove(),b===e.selected&&(e.selected=null,c.trigger("stylechange",null)),d(c),!1):void 0})}function l(){var b=a(this),c=[];b.find(".style-block").each(function(b,d){var e=a(d);e.hasClass("style-null")||c.push(e)});for(var e=0;e<c.length;++e)c[e].remove();d(b)}var m=null,n={init:function(b){return b=a.extend({allowDrag:!0,allowDrop:!1,allowReorder:!0,allowNameEdit:!1,placeholder:null,previewWidth:30,previewHeight:30},b),this.each(function(){var c=a(this).addClass("g-style-panel").data("gstylepanel",{selected:null,options:b});d(c)})},attach:function(b){var c=a(this),d=c.data("gstylepanel");if(n.detach.call(this),d.container=b,b){for(var h=b.getFirstChild();null!==h;h=h.getNext())h instanceof IFStyle&&i.call(this,h);var j=b.getScene();j&&(d.afterInsertHandler=e.bind(this),d.beforeRemoveHandler=f.bind(this),d.afterPropertiesChangeHandler=g.bind(this),j.addEventListener(IFNode.AfterInsertEvent,d.afterInsertHandler),j.addEventListener(IFNode.BeforeRemoveEvent,d.beforeRemoveHandler),j.addEventListener(IFNode.AfterPropertiesChangeEvent,d.afterPropertiesChangeHandler))}return this},detach:function(){var b=a(this),c=b.data("gstylepanel"),d=c.container;if(d){var e=d.getScene();e&&(e.removeEventListener(IFNode.AfterInsertEvent,c.afterInsertHandler),e.removeEventListener(IFNode.BeforeRemoveEvent,c.beforeRemoveHandler),e.removeEventListener(IFNode.AfterPropertiesChangeEvent,c.afterPropertiesChangeHandler))}return c.container=null,c.afterInsertHandler=null,c.beforeRemoveHandler=null,c.afterPropertiesChangeHandler=null,l.call(this),this},value:function(b){var d=a(this);return arguments.length?(d.data("gstylepanel").selected=b,c(d,b),this):d.data("gstylepanel").selected}};a.fn.gStylePanel=function(b){return n[b]?n[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):n.init.apply(this,arguments)}}(jQuery),function(a){function b(b,c){b.data("gswatchpanel").options.allowSelect&&b.find(".swatch-block").each(function(b,d){var e=a(d);e.toggleClass("selected",e.data("swatch")===c)})}function c(b){var c=b.data("gswatchpanel");if(c.options.placeholder){var d=b.find(".placeholder"),e=b.find("> .swatch-block");0===e.length?0===d.length&&(d=a("<div></div>").addClass("placeholder").text(c.options.placeholder).appendTo(b)):d.length>0&&d.remove()}}function d(b){var c=a(this),d=c.data("gswatchpanel").container;b.node instanceof IFSwatch&&b.node.getParent()===d&&h.call(this,b.node)}function e(b){var c=a(this),d=c.data("gswatchpanel").container;b.node instanceof IFSwatch&&b.node.getParent()===d&&j.call(this,b.node)}function f(b){var c=a(this),d=c.data("gswatchpanel").container;b.node.getParent()===d&&i.call(this,b.node)}function g(b,c){var d=b.data("gswatchpanel");if(m){var e=a(c).data("swatch");if(e&&e!==m)return m.getParent()===e.getParent()?d.options.allowReorder:d.options.allowDrop}return!1}function h(d,e){var f=a(this),h=f.data("gswatchpanel"),j=d.getProperty("pat");if(j){var k=h.types;if(k&&k.length>0){for(var l=!1,n=0;n<k.length;++n)if(null!==k[n]&&j instanceof k[n]){l=!0;break}if(!l)return}var o=null;"number"==typeof e?(h.options.nullSwatch&&(e+=1),o=f.children(".swatch-block").eq(e)):d.getNext()&&f.find(".swatch-block").each(function(b,c){var e=a(c);return e.data("swatch")===d.getNext()?(o=e,!1):void 0});var p=a("<div></div>").addClass("swatch-block").data("swatch",d).append(a("<div></div>").addClass("swatch-content").append(a("<div></div>").addClass("swatch-preview").append(a("<div></div>").css({width:h.options.previewWidth+"px",height:h.options.previewHeight+"px"}))).append(a("<div></div>").addClass("swatch-name"))).on("mousedown",function(){f.data("gswatchpanel").selected=d,b(f,d)}).on("click",function(){f.trigger("swatchchange",d)});h.options.allowNameEdit&&p.gAutoEdit({selector:".swatch-name"}).on("submitvalue",function(a,b){b&&""!==b.trim()&&IFEditor.tryRunTransaction(d,function(){d.setProperty("name",b)},"Rename Swatch")}),(h.options.allowDrag||h.options.allowReorder)&&p.attr("draggable","true").on("dragstart",function(b){var c=b.originalEvent;c.stopPropagation(),m=a(this).data("swatch");var d=m.getProperty("pat");return d?void(h.options.allowDrag&&(f.trigger("swatchdragstart",m),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData(IFPattern.MIME_TYPE,IFPattern.serialize(d)),c.dataTransfer.setDragImage(p.find(".swatch-preview > div")[0],h.options.previewWidth/2,h.options.previewHeight/2))):void c.preventDefault()}).on("dragend",function(a){var b=a.originalEvent;if(b.stopPropagation(),m=null,h.options.allowDrag){var c=f.offset(),e=f.outerWidth(),g=f.outerHeight(),i=b.pageX,j=b.pageY;i<=c.left||i>=c.left+e||j<=c.top||j>=c.top+g?f.trigger("swatchdragaway",d):f.trigger("swatchdragend",d)}}),(h.options.allowDrop||h.options.allowReorder)&&p.on("dragenter",function(){g(f,this)&&a(this).addClass("drop")}).on("dragleave",function(){g(f,this)&&a(this).removeClass("drop")}).on("dragover",function(a){var b=a.originalEvent;g(f,this)&&(b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move")}).on("drop",function(){a(this).removeClass("drop");var b=a(this).data("swatch");if(m)if(h.options.allowReorder){if(h.container&&m.getParent()===h.container){var c=m.getParent(),d=c.getIndexOfChild(m),e=c.getIndexOfChild(b);IFEditor.tryRunTransaction(c,function(){c.removeChild(m),c.insertChild(m,e>d?b.getNext():b)},"Move Swatch")}f.trigger("swatchmove",[m,b])}else h.options.allowDrop&&f.trigger("swatchdrop",[m,b])}),o&&o.length>0?p.insertBefore(o):p.appendTo(f),c(f),i.call(this,d)}}function i(b){var c=a(this);c.find(".swatch-block").each(function(c,d){var e=a(d);if(e.data("swatch")===b){e.find(".swatch-preview > div").css("background",IFPattern.asCSSBackground(b.getProperty("pat")));var f=b.getProperty("name");return e.attr("title",f),e.find(".swatch-name").text(f),!1}})}function j(b){var d=a(this),e=d.data("gswatchpanel");d.find(".swatch-block").each(function(f,g){var h=a(g);return h.data("swatch")===b?(h.remove(),b===e.selected&&(e.selected=null,d.trigger("swatchchange",null)),c(d),!1):void 0})}function k(){var b=a(this),d=[];b.find(".swatch-block").each(function(b,c){var e=a(c);e.hasClass("swatch-null")||d.push(e)});for(var e=0;e<d.length;++e)d[e].remove();c(b)}function l(){var b=a(this),c=b.data("gswatchpanel");if(c.container)for(var d=c.container.getFirstChild();null!==d;d=d.getNext())d instanceof IFSwatch&&h.call(this,d)}var m=null,n={init:function(b){return b=a.extend({allowDrag:!0,allowDrop:!1,allowReorder:!0,allowSelect:!0,allowNameEdit:!1,nullSwatch:null,nullName:null,nullAction:null,placeholder:null,previewWidth:22,previewHeight:22},b),this.each(function(){var d=this,e=a(this).addClass("g-swatch-panel").data("gswatchpanel",{types:null,selected:null,options:b}).on("dragover",function(a){var b=a.originalEvent;b.preventDefault(),b.stopPropagation(),b.dataTransfer.dropEffect="move"}).on("drop",function(a){var b=e.data("gswatchpanel"),c=a.originalEvent;if(c.stopPropagation(),m||!b.container||!b.container.getScene())return void(m=null);var f=(b.container.getScene(),c.dataTransfer.getData(IFPattern.MIME_TYPE));if(f){var g=IFPattern.deserialize(f);g&&n.createSwatch.call(d,g)}});b.nullSwatch&&a("<div></div>").addClass("swatch-block swatch-null").data("swatch",null).attr("title",b.nullName?b.nullName:"").append(a("<div></div>").addClass("swatch-content").append(a("<div></div>").addClass("swatch-preview").append(a("<div></div>").css({width:b.previewWidth+"px",height:b.previewHeight+"px","line-height":b.previewHeight+"px"}).append(b.nullSwatch))).append(a("<div></div>").addClass("swatch-name").text(b.nullName?b.nullName:""))).on("click",function(){b.nullAction&&b.nullAction.call(d)}).appendTo(e),c(e)})},createSwatch:function(b){var c=a(this),d=c.data("gswatchpanel"),e=d.container.getScene(),f=b instanceof IFColor?b.toHumanString():"";IFEditor.tryRunTransaction(e,function(){var a=new IFSwatch;a.setProperties(["name","pat"],[f,b]),e.getSwatchCollection().appendChild(a)},"Add Swatch")},attach:function(b){var c=a(this),g=c.data("gswatchpanel");if(n.detach.call(this),g.container=b,b){l.call(this);var h=b.getScene();h&&(g.afterInsertHandler=d.bind(this),g.beforeRemoveHandler=e.bind(this),g.afterPropertiesChangeHandler=f.bind(this),h.addEventListener(IFNode.AfterInsertEvent,g.afterInsertHandler),h.addEventListener(IFNode.BeforeRemoveEvent,g.beforeRemoveHandler),h.addEventListener(IFNode.AfterPropertiesChangeEvent,g.afterPropertiesChangeHandler))}return this},detach:function(){var b=a(this),c=b.data("gswatchpanel"),d=c.container;if(d){var e=d.getScene();e&&(e.removeEventListener(IFNode.AfterInsertEvent,c.afterInsertHandler),e.removeEventListener(IFNode.BeforeRemoveEvent,c.beforeRemoveHandler),e.removeEventListener(IFNode.AfterPropertiesChangeEvent,c.afterPropertiesChangeHandler))}return c.container=null,c.afterInsertHandler=null,c.beforeRemoveHandler=null,c.afterPropertiesChangeHandler=null,k.call(this),this},types:function(b){var c=a(this),d=c.data("gswatchpanel");return arguments.length?(d.types=b,k.call(this),l.call(this),this):d.types},value:function(c){var d=a(this);return arguments.length?(d.data("gswatchpanel").selected=c,b(d,c),this):d.data("gswatchpanel").selected}};a.fn.gSwatchPanel=function(b){return n[b]?n[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):n.init.apply(this,arguments)}}(jQuery),function(a){function b(a){this._parent=a,this._htmlElement=$("<ul></ul>").addClass("g-menu"),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this))}IFObject.inherit(b,IFEventTarget),b.Position={Left_Top:0,Center:1,Right_Bottom:2},b._activeMenu=null,b._activeActivationCallback=null,b._activeMenuMouseLocations=null,b.getActiveMenu=function(){return b._activeMenu},b.triggerGlobalActivation=function(a){b._activeMenu&&b._activeActivationCallback&&b._activeActivationCallback(a)},b.setActiveMenu=function(a,c,d){b._activeMenu&&(c||b._activeMenu.close(),b._activeMenu=null,b._activeActivationCallback=null,document.removeEventListener("mousemove",b._activeMenuMouseMoveListener),document.removeEventListener("mousedown",b._activeMenuMouseUpDownListener),document.removeEventListener("mouseup",b._activeMenuMouseUpDownListener),document.removeEventListener("keyup",b._activeMenuKeyDownListener)),b._activeMenu=a,b._activeActivationCallback=d,b._activeMenu&&(document.addEventListener("mousemove",b._activeMenuMouseMoveListener),document.addEventListener("mousedown",b._activeMenuMouseUpDownListener),setTimeout(function(){document.addEventListener("mouseup",b._activeMenuMouseUpDownListener)},250),document.addEventListener("keyup",b._activeMenuKeyDownListener))},b._activeMenuMouseMoveListener=function(a){b._activeMenuMouseLocations||(b._activeMenuMouseLocations=[]),b._activeMenuMouseLocations.push({x:a.pageX,y:a.pageY}),b._activeMenuMouseLocations.length>3&&b._activeMenuMouseLocations.shift()},b._activeMenuMouseUpDownListener=function(){b.setActiveMenu(null)},b._activeMenuKeyDownListener=function(a){27==a.keyCode&&b.setActiveMenu(null)},b.createActionMenu=function(a,b){for(var c=[],d=function(a){for(var b=0;b<c.length;++b)if(c[b].item===a)return c[b].group},e=function(a,b,e){if(a.getItemCount()>0){var f=d(a.getItem(a.getItemCount()-1));f!==e&&a.addItem(new GMenuItem(GMenuItem.Type.Divider))}c.push({item:b,group:e})},f=0;f<a.length;++f){var g=a[f];if(g.isAvailable()){var h=ifLocale.get(g.getCategory()),i=g.getGroup(),j=h?h.split("/"):null,k=i?[""].concat(i.split("/")):null;if(k&&j&&j.length!==k.length-1)throw new Error("Number of categories different thant number of groups.");var l=b;if(j)for(var m=0;m<j.length;++m){var h=j[m],i=k?k[m]:null,n=l.findItem(h);n||(n=new GMenuItem(GMenuItem.Type.Menu),n.setCaption(h),e(l,n,i),l.addItem(n)),l=n.getMenu()}var o=new GMenuItem;o.setAction(g),e(l,o,k?k[k.length-1]:null),l.addItem(o)}}},b.OpenEvent=function(){},IFObject.inherit(b.OpenEvent,IFEvent),b.OpenEvent.prototype.toString=function(){return"[Object GMenu.OpenEvent]"},b.OPEN_EVENT=new b.OpenEvent,b.CloseEvent=function(){},IFObject.inherit(b.CloseEvent,IFEvent),b.CloseEvent.prototype.toString=function(){return"[Object GMenu.CloseEvent]"},b.CLOSE_EVENT=new b.CloseEvent,b.ActivateEvent=function(a){this.item=a},IFObject.inherit(b.ActivateEvent,IFEvent),b.ActivateEvent.item=null,b.ActivateEvent.prototype.toString=function(){return"[Object GMenu.ActivateEvent]"},b.prototype._parent=null,b.prototype._htmlElement=null,b.prototype._items=null,b.prototype._hovered=!1,b.prototype.getParent=function(){return this._parent},b.prototype.isHovered=function(a){if(this._hovered)return!0;if(a){for(var b=0;b<this.getItemCount();++b){var c=this.getItem(b);if(c instanceof GMenuItem&&c.getType()===GMenuItem.Type.Menu&&c.getMenu().isHovered(!0))return!0}return!1}return!1},b.prototype.isRootMenu=function(){return!(this._parent&&this._parent instanceof GMenuItem)},b.prototype.isSubMenu=function(){return this._parent&&this._parent instanceof GMenuItem?!this._parent.isRootItem():!1},b.prototype.createAddDivider=function(){return this.createInsertDivider(this.getItemCount())},b.prototype.createInsertDivider=function(a){var b=new GMenuItem(GMenuItem.Type.Divider);return this.insertItem(a,b),b},b.prototype.createAddItem=function(a,b,c,d){return this.createInsertItem(this.getItemCount(),a,b,c,d)},b.prototype.createInsertItem=function(a,b,c,d,e){var f=new GMenuItem;return f.setCaption(b),c&&f.addEventListener(GMenuItem.ActivateEvent,c),d&&f.addEventListener(GMenuItem.EnterEvent,d),e&&f.addEventListener(GMenuItem.LeaveEvent,e),this.insertItem(a,f),f},b.prototype.addItem=function(a){return this.insertItem(this.getItemCount(),a)},b.prototype.insertItem=function(a,b){null==this._items&&(this._items=[]),a+1<this._items.length?(this._items.splice(a,0,b),this._items[a+1]._htmlElement.before(b._htmlElement)):(this._items.push(b),this._htmlElement.append(b._htmlElement)),b._parent=this},b.prototype.removeItem=function(a){a>=0&&a<this.getItemCount()&&(this._items[a]._parent=null,this._items[a]._htmlElement.detach(),this._items.splice(a,1))},b.prototype.clearItems=function(){if(this._items){for(var a=0;a<this._items.length;++a)this._items[a]._parent=null,this._items[a]._htmlElement.detach();this._items=[]}},b.prototype.getItem=function(a){return a>=0&&a<this.getItemCount()?this._items[a]:null},b.prototype.getItemCount=function(){return this._items?this._items.length:0},b.prototype.indexOf=function(a){return this._items?this._items.indexOf(a):-1},b.prototype.findItem=function(a){for(var b=0;b<this.getItemCount();++b){var c=this.getItem(b);if(a==c.getCaption())return c}return null},b.prototype.update=function(){for(var a=0;a<this.getItemCount();++a){var b=this.getItem(a);b.update()}},b.prototype.isOpen=function(){return!!this._htmlElement.parent().length},b.prototype.open=function(a,c,d,e){if(c="number"==typeof c?c:b.Position.Center,d="number"==typeof d?d:b.Position.Center,this.isOpen()||(this.update(),this._htmlElement.appendTo($("body")),this.isSubMenu()||b.setActiveMenu(this,!1,e),this.trigger(b.OPEN_EVENT)),this._htmlElement.parent().is("body")){var f=this._htmlElement.outerWidth(),g=this._htmlElement.outerHeight(),h=$(window).width(),i=$(window).height(),j={x:0,y:0,width:0,height:0};if("number"==typeof a.x&&"number"==typeof a.y)j.x=a.x,j.y=a.y;else{var k=a.offset();j.x=k.left,j.y=k.top,j.width=a.outerWidth(),j.height=a.outerHeight()}var l=0;switch(c){case b.Position.Left_Top:l=j.x-f,0>l&&(l=j.x+j.width);break;case b.Position.Center:l=j.x;break;case b.Position.Right_Bottom:l=j.x+j.width,l+f>h&&(l=j.x-f)}var m=0;switch(d){case b.Position.Left_Top:m=j.y-g,0>m&&(m=j.y+j.height);break;case b.Position.Center:m=j.y;break;case b.Position.Right_Bottom:m=j.y+j.height,m+g>i&&(m=j.y-g)}switch(0>l&&(l=0),l+f>=h&&(l=h-f),0>m&&(m=0),m+g>=i&&(m=i-g),this._htmlElement.css("left",l),this._htmlElement.css("top",m),c){case b.Position.Left_Top:this._htmlElement.addClass("g-menu-left");break;case b.Position.Right_Bottom:this._htmlElement.addClass("g-menu-right")}switch(d){case b.Position.Left_Top:this._htmlElement.addClass("g-menu-top");break;case b.Position.Right_Bottom:this._htmlElement.addClass("g-menu-bottom")}}},b.prototype.close=function(){this.isOpen()&&this._htmlElement.parent().is("body")&&(this.closeMenus(),this._htmlElement.removeClass("g-menu-left g-menu-right g-menu-top g-menu-bottom"),this._htmlElement.detach(),this===b._activeMenu&&b.setActiveMenu(null,!0),this.trigger(b.CLOSE_EVENT))},b.prototype.closeMenus=function(){for(var a=0;a<this.getItemCount();++a){var b=this.getItem(a);b instanceof GMenuItem&&b.getType()===GMenuItem.Type.Menu&&b.getMenu().close()}},b.prototype._mouseOver=function(){this._hovered=!0},b.prototype._mouseOut=function(){this._hovered=!1,this.isSubMenu()&&setTimeout(function(){this.isHovered(!0)||this.closeMenus()}.bind(this),150)},a.GMenu=b}(this),function(a){function b(a){this._menu=a?a:new GMenu(this),this._menu._parent=this,this._menu._htmlElement.addClass("g-menu-root"),this._htmlElement=$("<nav></nav>").addClass("g-menu-bar").append(this._menu._htmlElement)}b.prototype._menu=null,b.prototype.getMenu=function(){return this._menu},b.prototype.isActive=function(){var a=GMenu.getActiveMenu();return a&&a._parent&&a._parent instanceof GMenuItem?a._parent.getMenuBar()===this:!1},b.prototype.toString=function(){return"[Object GMenuBar]"},a.GMenuBar=b}(this),function(a){function b(a){this._htmlElement=$("<li></li>").addClass("g-menu-item"),this._type=a?a:b.Type.Item,this._type===b.Type.Divider?this._htmlElement.addClass("g-menu-item-divider"):(this._htmlElement.append($("<span></span>").addClass("g-menu-item-icon").css("display","none")).append($("<span></span>").addClass("g-menu-item-caption")).append($("<span></span>").addClass("g-menu-item-shortcut").css("display","none")).append($("<span></span>").addClass("g-menu-item-tail")),this._type===b.Type.Menu&&(this._htmlElement.addClass("g-menu-item-menu"),this.setMenu(new GMenu(this)))),this._htmlElement.on("mouseover",this._mouseOver.bind(this)),this._htmlElement.on("mouseout",this._mouseOut.bind(this)),this._htmlElement.on("mousedown",this._mouseDown.bind(this)),this._htmlElement.on("mouseup",this._mouseUp.bind(this))}IFObject.inherit(b,IFEventTarget),b.Type={Item:0,Menu:1,Divider:2},b.EnterEvent=function(){},IFObject.inherit(b.EnterEvent,IFEvent),b.EnterEvent.prototype.toString=function(){return"[Object GMenuItem.EnterEvent]"},b.ENTER_EVENT=new b.EnterEvent,b.LeaveEvent=function(){},IFObject.inherit(b.LeaveEvent,IFEvent),b.LeaveEvent.prototype.toString=function(){return"[Object GMenuItem.LeaveEvent]"},b.LEAVE_EVENT=new b.LeaveEvent,b.ActivateEvent=function(){},IFObject.inherit(b.ActivateEvent,IFEvent),b.ActivateEvent.prototype.toString=function(){return"[Object GMenuItem.ActivateEvent]"},b.ACTIVATE_EVENT=new b.ActivateEvent,b.UpdateEvent=function(){},IFObject.inherit(b.UpdateEvent,IFEvent),b.UpdateEvent.prototype.toString=function(){return"[Object GMenuItem.UpdateEvent]"},b.UPDATE_EVENT=new b.UpdateEvent,b.prototype._parent=null,b.prototype._type=null,b.prototype._menu=null,b.prototype._icon=null,b.prototype._caption=null,b.prototype._shortcutHint=null,b.prototype._action=null,b.prototype._data=null,b.prototype.getParent=function(){return this._parent},b.prototype.getType=function(){return this._type},b.prototype.getIcon=function(){return this._icon},b.prototype.setIcon=function(a){if(a!==this._icon){this._icon=a;var b=this._htmlElement.find(".g-menu-item-icon");b.empty(),this._icon?(b.append("string"==typeof this._icon?$("<i></i>").addClass(a):this._icon),b.css("display","")):b.css("display","none")}},b.prototype.getCaption=function(){return this._caption},b.prototype.setCaption=function(a){if(a!==this._caption){this._caption=a;var b=this._htmlElement.find(".g-menu-item-caption");b.empty(),!this._caption||this._caption instanceof IFLocale.Key||"string"==typeof this._caption?b.text(this._caption?ifLocale.get(this._caption):""):b.append(this._caption)}},b.prototype.getShortcutHint=function(){return this._shortcutHint},b.prototype.setShortcutHint=function(a){this._shortcutHint=a;var b=this._htmlElement.find(".g-menu-item-shortcut");this._shortcutHint&&this._shortcutHint.length>0?(b.text(IFKey.shortcutToString(a)),b.css("display","")):(b.empty(),b.css("display","none"))},b.prototype.getAction=function(){return this._action},b.prototype.setAction=function(a){if(a!==this._action){if(this._action){var b=a.getShortcut();b&&b===this.getShortcutHint()&&this.setShortcutHint(null)}if(this._action=a,this._action){var b=a.getShortcut();b&&this.setShortcutHint(b),this.setCaption(this._action.getTitle()),this.setEnabled(this._action.isEnabled()===!0)}}},b.prototype.isChecked=function(){return this._htmlElement.hasClass("g-menu-item-checked")},b.prototype.setChecked=function(a){a!=this.isChecked()&&(a?this._htmlElement.addClass("g-menu-item-checked"):this._htmlElement.removeClass("g-menu-item-checked"))},b.prototype.isEnabled=function(){return!this._htmlElement.hasClass("g-disabled")},b.prototype.setEnabled=function(a){a!=this.isEnabled()&&(a?this._htmlElement.removeClass("g-disabled"):this._htmlElement.addClass("g-disabled"))},b.prototype.getData=function(){return this._data},b.prototype.setData=function(a){this._data=a},b.prototype.isRootItem=function(){return this._parent&&this._parent instanceof GMenu&&null!=this._parent._parent&&!(this._parent._parent instanceof b)},b.prototype.isRootMenuBarItem=function(){return this.isRootItem()&&this._parent._parent instanceof GMenuBar},b.prototype.getMenuBar=function(){return this.isRootMenuBarItem()?this._parent._parent:null},b.prototype.getMenu=function(){return this._menu},b.prototype.setMenu=function(a){a&&a!==this._menu&&this._type===b.Type.Menu&&(this._menu=a,this._menu._parent=this,this._menu.addEventListener(GMenu.OPEN_EVENT,this._menuOpen.bind(this)),this._menu.addEventListener(GMenu.CLOSE_EVENT,this._menuClose.bind(this)))},b.prototype.update=function(){this._action&&(this.setCaption(this._action.getTitle()),this.setEnabled(this._action.isEnabled()),this.setChecked(this._action.isChecked())),this.hasEventListeners(b.UpdateEvent)&&this.trigger(b.UPDATE_EVENT)},b.prototype._mouseOver=function(){this._parent&&this._parent instanceof GMenu&&!this.isRootItem()&&this._parent.closeMenus(),this.isEnabled()&&(this._type==b.Type.Menu&&IFSystem.hardware===IFSystem.Hardware.Desktop&&(!this.isRootItem()||this.isRootMenuBarItem()&&this.getMenuBar().isActive())&&this._openMenu(),this._type!=b.Type.Divider&&(this._htmlElement.addClass("g-hover"),this.hasEventListeners(b.EnterEvent)&&this.trigger(b.ENTER_EVENT)))},b.prototype._mouseOut=function(){this.isEnabled()&&this._type!=b.Type.Divider&&(this._htmlElement.removeClass("g-hover"),this.hasEventListeners(b.LeaveEvent)&&this.trigger(b.LEAVE_EVENT))},b.prototype._mouseDown=function(a){this.isEnabled()&&a.button==IFMouseEvent.BUTTON_LEFT&&(a.stopPropagation(),a.preventDefault(),this._type!==b.Type.Menu||!this.isRootItem()&&IFSystem.hardware===IFSystem.Hardware.Desktop||(this._htmlElement.hasClass("g-active")?this.getMenu().close():this._openMenu()))},b.prototype._mouseUp=function(a){a.stopPropagation(),a.preventDefault(),this.isRootMenuBarItem()||this._mouseOut(a),this._type==b.Type.Item&&(this._action&&this._action.isAvailable()&&this._action.isEnabled()&&this._action.execute(),this.isEnabled()&&(this.hasEventListeners(b.ActivateEvent)&&this.trigger(b.ACTIVATE_EVENT),this._parent&&this._parent.hasEventListeners(GMenu.ActivateEvent)&&this._parent.trigger(new GMenu.ActivateEvent(this)),GMenu.triggerGlobalActivation(this))),this.isRootMenuBarItem()||GMenu.setActiveMenu(null)},b.prototype._openMenu=function(){this.getMenu().open(this._htmlElement,this.isRootItem()?GMenu.Position.Center:GMenu.Position.Right_Bottom,this.isRootItem()?GMenu.Position.Right_Bottom:GMenu.Position.Center)},b.prototype._menuOpen=function(){this._htmlElement.addClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.addClass("g-active")},b.prototype._menuClose=function(){this._htmlElement.removeClass("g-active"),this.isRootItem()&&this._parent._parent._htmlElement.removeClass("g-active")},b.prototype.toString=function(){return"[Object GMenuItem]"},a.GMenuItem=b}(this),function(a){var b={margin:"0px 1px",transform:"rotate(-45deg)",position:"absolute",bottom:"3px","font-size":"10px"},c={"margin-left":"3px"},d={init:function(e){return e=a.extend({menu:null,defaultAction:null,arrow:!0},e),this.each(function(){var f=this,g=null,h=a(this).data("gmenubutton",{options:e}).on("mousedown",function(a){a.stopPropagation(),e.defaultAction?g=setTimeout(function(){d.open.call(f),g=null}.bind(this),250):d.open.call(f)}).on("mouseup",function(a){a.stopPropagation(),null!==g&&(clearTimeout(g),g=null),!e.menu.isOpen()&&e.defaultAction&&e.defaultAction()});e.arrow&&h.append(a("<span></span>").addClass("fa fa-caret-down").css(e.defaultAction?b:c))})},open:function(){var b=a(this),c=b.data("gmenubutton").options.menu;c.isOpen()||c.open(b,GMenu.Position.Center,GMenu.Position.Right_Bottom,function(a){b.trigger("menuitemactivate",a)})},close:function(){var a=$this.data("gmenubutton").options.menu;a.isOpen()&&a.close()}};a.fn.gMenuButton=function(b){return d[b]?d[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" does not exist on jQuery.myPlugin"):d.init.apply(this,arguments)}}(jQuery),function(a){function b(){}IFObject.inherit(b,IFObject),b.prototype.getId=function(){throw new Error("Not Supported")},b.prototype.getTitle=function(){throw new Error("Not Supported")},b.prototype.getCategory=function(){return null},b.prototype.getGroup=function(){return null},b.prototype.getShortcut=function(){return null},b.prototype.isEnabled=function(){return!0},b.prototype.isCheckable=function(){return!1},b.prototype.isChecked=function(){return!1},b.prototype.isAvailable=function(){return!0},b.prototype.execute=function(){throw new Error("Not Supported")},b.prototype.toString=function(){return"[Object GAction]"},a.GAction=b}(this),function(a){function b(){}b.parseSize=function(a){var b=null,c=null,d=a.split("@"),e=function(a){if("?"===a)return null;var b=IFUtil.parseNumber(a);if("number"!=typeof b)return null;var c=a.substr(b.toString().length);return c&&c.length>0&&(c=c.trim().toLowerCase(),"x"===c)?b:IFLength.parseLength(a)},b=null,c=null;switch(d[0].charAt(d[0].length-1)){case"w":case"W":b=e(d[0].substr(0,d[0].length-1));break;case"h":case"H":c=e(d[0].substr(0,d[0].length-1));break;default:b=e(d[0]),d.length>1&&(c=e(d[1]))}return{width:b,height:c}},b.prototype.isStandalone=function(){throw new Error("Not Supported.")},b.prototype.getName=function(){throw new Error("Not Supported.")},b.prototype.getExtensions=function(){throw new Error("Not Supported.")},b.prototype.exportPart=function(){throw new Error("Not Supported.")},a.GExporter=b}(this),function(a){function b(){}b.prototype.init=function(){},a.GModule=b}(this),function(a){function b(){}IFObject.inherit(b,IFEventTarget),b.UpdateEvent=function(){},IFObject.inherit(b.UpdateEvent,IFEvent),b.UpdateEvent.prototype.toString=function(){return"[Object GView.UpdateEvent]"},b.UPDATE_EVENT=new b.UpdateEvent,b.DocumentState=function(a){this.document=a},b.DocumentState.prototype.document=null,b.DocumentState.prototype.activate=function(){},b.DocumentState.prototype.deactivate=function(){},b.DocumentState.prototype.init=function(){},b.DocumentState.prototype.release=function(){},b.prototype._documentStates=null,b.prototype.getId=function(){throw new Error("Not Supported")},b.prototype.getTitle=function(){throw new Error("Not Supported")},b.prototype.isEnabled=function(){return!0},b.prototype._createDocumentState=function(){return null},b.prototype._activateDocumentState=function(){},b.prototype._deactivateDocumentState=function(){},b.prototype._documentEvent=function(a){switch(a.type){case GApplication.DocumentEvent.Type.Added:var c=this._createDocumentState(a.document);c&&(c.init(),this._documentStates||(this._documentStates=[]),this._documentStates.push(c),this.trigger(b.UPDATE_EVENT));break;case GApplication.DocumentEvent.Type.Removed:var c=this._findDocumentState(a.document);c&&(c.release(),this._documentStates.splice(this._documentStates.indexOf(c),1),0===this._documentStates.length&&(this._documentStates=null),this.trigger(b.UPDATE_EVENT));break;case GApplication.DocumentEvent.Type.Activated:var c=this._findDocumentState(a.document);c&&(c.activate(),this._activateDocumentState(c),this.trigger(b.UPDATE_EVENT));break;case GApplication.DocumentEvent.Type.Deactivated:var c=this._findDocumentState(a.document);c&&(c.deactivate(),this._deactivateDocumentState(c),this.trigger(b.UPDATE_EVENT))}},b.prototype._findDocumentState=function(a){if(!this._documentStates)return null;for(var b=0;b<this._documentStates.length;++b)if(this._documentStates[b].document===a)return this._documentStates[b]},b.prototype.toString=function(){return"[Object GView]"},a.GView=b}(this),function(a){function b(){GView.call(this)}IFObject.inherit(b,GView),b.prototype.isAutoSize=function(){return!1
},b.prototype.getGroup=function(){return null},b.prototype.init=function(){gApp.addEventListener(GApplication.DocumentEvent,this._documentEvent,this)},b.prototype.toString=function(){return"[Object GPalette]"},a.GPalette=b}(this),function(a){function b(){GView.call(this)}IFObject.inherit(b,GView),b.prototype.getTitle=function(){return null},b.prototype.init=function(){gApp.addEventListener(GApplication.DocumentEvent,this._documentEvent,this)},b.prototype.activate=function(){},b.prototype.deactivate=function(){},b.prototype.toString=function(){return"[Object GPanel]"},a.GPanel=b}(this),function(a){function b(){}b.prototype.init=function(){throw new Error("Not Supported.")},b.prototype.update=function(){throw new Error("Not Supported.")},b.prototype.toString=function(){return"[Object GProperties]"},a.GProperties=b}(this),function(a){function b(){GView.call(this)}IFObject.inherit(b,GView),b.prototype.getIcon=function(){return null},b.prototype.init=function(){gApp.addEventListener(GApplication.DocumentEvent,this._documentEvent,this)},b.prototype.activate=function(){},b.prototype.deactivate=function(){},b.prototype.toString=function(){return"[Object GSidebar]"},a.GSidebar=b}(this),function(a){function b(){}b.prototype.isAvailable=function(){throw new Error("Not supported.")},b.prototype.isSaving=function(){throw new Error("Not supported.")},b.prototype.isPrompting=function(){throw new Error("Not supported.")},b.prototype.isDirectory=function(){throw new Error("Not supported.")},b.prototype.getProtocol=function(){throw new Error("Not supported.")},b.prototype.getExtensions=function(){throw new Error("Not Supported.")},b.prototype.getName=function(){throw new Error("Not supported.")},b.prototype.openResourcePrompt=function(){throw new Error("Not supported.")},b.prototype.saveResourcePrompt=function(){throw new Error("Not supported.")},b.prototype.openDirectoryPrompt=function(){throw new Error("Not supported.")},b.prototype.saveDirectoryPrompt=function(){throw new Error("Not supported.")},b.prototype.load=function(){throw new Error("Not Supported.")},b.prototype.save=function(){throw new Error("Not Supported.")},b.prototype.releaseUrl=function(){},b.prototype.resolveUrl=function(){throw new Error("Not Supported.")},a.GStorage=b}(this),function(a){function b(a){this._htmlElement=a}b.prototype._htmlElement=null,b.prototype.init=function(){$("<div></div>").addClass("windows").appendTo(this._htmlElement),$("<div></div>").addClass("view").append(this._createZoom()).appendTo(this._htmlElement),this._updateZoomFromWindow(),gApp.addEventListener(GApplication.DocumentEvent,this._documentEvent,this),gApp.getWindows().addEventListener(GWindows.WindowEvent,this._windowEvent,this),this._updateView()},b.prototype.relayout=function(){this._htmlElement.find(".view").css("padding-right",gApp.isPartVisible(GApplication.Part.Palettes)?gApp.getPart(GApplication.Part.Palettes).outerWidth().toString()+"px":"")},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.UrlUpdated)for(var b=a.document.getWindows(),c=0;c<b.length;++c)this._htmlElement.find(".windows > .tab").each(function(a,d){var e=$(d);return e.data("window")===b[c]?(e.find(".title").text(b[c].getTitle()),!1):void 0})},b.prototype._windowEvent=function(a){switch(a.type){case GWindows.WindowEvent.Type.Added:this._addWindowTab(a.window);break;case GWindows.WindowEvent.Type.Removed:this._removeWindowTab(a.window);break;case GWindows.WindowEvent.Type.Activated:a.window.getView().addEventListener(IFView.TransformEvent,this._updateZoomFromWindow,this),this._updateView(),this._updateZoomFromWindow(),this._updateActiveWindowTab();break;case GWindows.WindowEvent.Type.Deactivated:a.window.getView().removeEventListener(IFView.TransformEvent,this._updateZoomFromWindow,this),this._updateView(),this._updateZoomFromWindow(),this._updateActiveWindowTab()}},b.prototype._addWindowTab=function(a){$("<div></div>").data("window",a).addClass("tab").append($("<span></span>").addClass("title").text(a.getTitle())).append($("<span></span>").addClass("close fa fa-times").on("click",function(a){a.stopPropagation(),gApp.getWindows().closeWindow($(this).parents(".tab").data("window"))})).on("click",function(){gApp.getWindows().activateWindow($(this).data("window"))}).appendTo(this._htmlElement.find(".windows"))},b.prototype._removeWindowTab=function(a){this._htmlElement.find(".windows > .tab").each(function(b,c){var d=$(c);return d.data("window")===a?(d.remove(),!1):void 0})},b.prototype._updateActiveWindowTab=function(){this._htmlElement.find(".windows > .tab").each(function(a,b){var c=$(b);c.toggleClass("g-active",c.data("window")===gApp.getWindows().getActiveWindow())})},b.prototype._createZoom=function(){for(var a=[6,12,25,50,66,100,150,200,300,400,800,1600,3200,6400],b=$("<select></select>").addClass("zoom").append($("<option></option>")).on("change",function(){var a=gApp.getWindows().getActiveWindow().getView(),b=a.getScene(),c=null;if(b.getProperty("singlePage")){var d=b.getActivePage().getGeometryBBox();d&&!d.isEmpty()&&(c=d.getSide(IFRect.Side.CENTER))}c||(c=a.getViewTransform().mapPoint(new IFPoint(a.getWidth()/2,a.getHeight()/2))),a.zoomAt(c,parseInt($(this).val())/100)}),c=0;c<a.length;++c)$("<option></option>").text(a[c].toString()+"%").attr("value",a[c]).appendTo(b);return b},b.prototype._updateZoomFromWindow=function(){var a=this._htmlElement.find(".view > .zoom"),b=gApp.getWindows().getActiveWindow();if(a.find("*").prop("disabled",!b),b){var c=IFMath.round(100*b.getView().getZoom(),!1,0);a.find("option:first-child").text(c.toString()+"%").attr("value",c),a.val(c)}},b.prototype._updateView=function(){this._htmlElement.find(".view").css("visibility",gApp.getWindows().getActiveWindow()?"":"hidden")},a.GHeader=b}(this),function(a){function b(a){this._htmlElement=a,this._palettesInfo=[],this._groupsInfo=[],this._collapseIcon=$('<span class="fa fa-stack collapse-icon"><span class="fa fa-stack-1x fa-angle-up"></span><span class="fa fa-stack-1x fa-angle-down"></span></span>')}b.prototype._htmlElement=null,b.prototype._palettesInfo=null,b.prototype._groupsInfo=null,b.prototype._collapseIcon=null,b.prototype.groupPalettes=function(a){for(var b=0;b<a.length;++b)this._detachPaletteFromGroup(a[b].getId());for(var c=this._addGroupInfo(),b=0;b<a.length;++b)this._attachPaletteToGroup(c,a[b].getId())},b.prototype.isPaletteActive=function(a){var b=this._getGroupInfoForPalette(a);return b?b.activePalette===a&&b.visible&&b.expanded:!1},b.prototype.setPaletteActive=function(a){var b=this._getGroupInfoForPalette(a);if(b&&(b.activePalette!==a||!b.visible||!b.expanded)){var c=this._getPaletteInfo(a);b.activePalette=a,b.container.find(".palette-group-tabs > button").each(function(b,c){var d=$(c);d.attr("data-palette-id")===a?d.addClass("g-active"):d.removeClass("g-active")}.bind(this)),b.container.find(".palette-group-panels > div").each(function(b,c){var d=$(c);d.attr("data-palette-id")===a?d.css("display",""):d.css("display","none")});var d=b.container.find(".palette-group-controls");d.children().detach(),d.append(c.controls),b.expanded?this._layoutPalettes():this._setGroupExpanded(b,!0)}},b.prototype.isPaletteEnabled=function(a){var b=this._getPaletteInfo(a);return b?0==b.panel.find(".panel-disabled-overlay").length:!1},b.prototype.setPaletteEnabled=function(a,b){var c=this._getPaletteInfo(a);if(c)if(b)c.panel.find(".g-disabled-overlay").remove(),c.panel.removeClass("g-disabled");else{var d=c.panel.find(".g-disabled-overlay");0===d.length&&(d=$("<div></div>").addClass("g-disabled-overlay").appendTo(c.panel)),c.panel.addClass("g-disabled")}},b.prototype.init=function(){for(var a=[],b=null,c=null,d=0;d<gravit.palettes.length;++d){var e=gravit.palettes[d];this._addPaletteInfo(e);var f=e.getGroup();f||(f=e.getId()),b&&b===f||(c&&a.push(c),c=[],b=f),c.push(e)}c&&a.push(c);for(var d=0;d<a.length;++d){this.groupPalettes(a[d]),this.setPaletteActive(a[d][0].getId(),!0);for(var g=0;g<a[d].length;++g){var e=a[d][g];this.setPaletteEnabled(e.getId(),e.isEnabled())}}},b.prototype.relayout=function(){this._layoutPalettes()},b.prototype._addPaletteInfo=function(a){var b=$("<div></div>").attr("data-palette-id",a.getId()).addClass("palette-panel").addClass("palette-"+a.getId()).css("display","none"),c=$("<div></div>");a.init(b,c);var d={palette:a,panel:b,controls:c};return this._palettesInfo.push(d),a.addEventListener(GView.UpdateEvent,function(){this.setPaletteEnabled(a.getId(),a.isEnabled())}.bind(this)),d},b.prototype._getPaletteInfo=function(a){for(var b=0;b<this._palettesInfo.length;++b)if(this._palettesInfo[b].palette.getId()===a)return this._palettesInfo[b];return null},b.prototype._detachPaletteFromGroup=function(a){var b=this._getGroupInfoForPalette(a),c=this._getPaletteInfo(a);b&&c&&(b.container.find('.palette-group-tabs > button[data-palette-id="'+a+'"]').remove(),b.container.find('.palette-group-panels > div[data-palette-id="'+a+'"]').detach(),b.palettes.slice(b.palettes.indexOf(a)))},b.prototype._attachPaletteToGroup=function(a,b){var c=this._getPaletteInfo(b);if(c){var d=a.container.find(".palette-group-tabs"),e=a.container.find(".palette-group-panels");d.append($("<button></button>").attr("data-palette-id",c.palette.getId()).text(ifLocale.get(c.palette.getTitle())).on("click",function(){this.isPaletteActive(c.palette.getId())?this._setGroupExpanded(a,!a.expanded):this.setPaletteActive(c.palette.getId(),!0)}.bind(this)).prepend(this._collapseIcon.clone())),e.append(c.panel),a.palettes.push(b)}},b.prototype._addGroupInfo=function(){var a={expanded:!0,visible:!0,activePalette:null,palettes:[]};return a.container=$("<div></div>").addClass("palette-group").append($("<div></div>").addClass("palette-group-header").append($("<div></div>").addClass("palette-group-tabs")).append($("<div></div>").addClass("palette-group-controls"))).append($("<div></div>").addClass("palette-group-panels")).appendTo(this._htmlElement),this._groupsInfo.push(a),a},b.prototype._getGroupInfoForPalette=function(a){for(var b=0;b<this._groupsInfo.length;++b)if(this._groupsInfo[b].palettes.indexOf(a)>=0)return this._groupsInfo[b];return null},b.prototype._setGroupExpanded=function(a,b){if(b!==a.expanded){if(a.expanded=b,a.expanded)a.container.css("height",""),a.container.removeClass("collapsed-palette");else{var c=a.container.find(".palette-group-header");a.container.height(c.outerHeight()),a.container.addClass("collapsed-palette")}this._layoutPalettes()}},b.prototype._layoutPalettes=function(){for(var a=this._htmlElement.height(),b=0,c=[],d=0;d<this._groupsInfo.length;++d){var e=this._groupsInfo[d];if(a-=e.container.find(".palette-group-header").outerHeight(),e.expanded&&e.activePalette)for(var f=0;f<this._palettesInfo.length;++f){var g=this._palettesInfo[f];g.palette.getId()===e.activePalette&&(g.palette.isAutoSize()?b++:a-=g.panel.outerHeight(),c.push(g))}}var h=0;a>0&&b>0&&(a-=3*(c.length+1),h=a/b);for(var d=0;d<c.length;++d){var g=c[d];h>0&&g.palette.isAutoSize()?(g.savedHeight=g.panel.css("height"),g.panel.css("height",h.toString()+"px")):g.panel.css("height",g.savedHeight)}},a.GPalettes=b}(this),function(a){function b(a){this._htmlElement=a,this._collapseIcon=$('<span class="fa fa-stack collapse-icon"><span class="fa fa-stack-1x fa-angle-up"></span><span class="fa fa-stack-1x fa-angle-down"></span></span>')}b.CollapseMode={None:"none",Half:"half",Full:"full"},b.prototype._htmlElement=null,GPalettes.prototype._collapseIcon=null,b.prototype._panels=null,b.prototype._activePanel=null,b.prototype._collapseMode=null,b.prototype.getCollapseMode=function(){return this._collapseMode},b.prototype.setCollapseMode=function(a){a!==this._collapseMode&&(this._collapseMode&&this._htmlElement.removeClass("collapse-"+this._collapseMode),this._collapseMode=a,this._collapseMode&&this._htmlElement.addClass("collapse-"+this._collapseMode))},b.prototype.toggleCollapseMode=function(){switch(this._collapseMode){case b.CollapseMode.Full:this.setCollapseMode(b.CollapseMode.None);break;case b.CollapseMode.Half:this.setCollapseMode(b.CollapseMode.Full);break;case b.CollapseMode.None:this.setCollapseMode(b.CollapseMode.Half)}},b.prototype.getActivePanel=function(){return this._activePanel},b.prototype.setActivePanel=function(a){if(a===this._activePanel)this.toggleCollapseMode();else{for(var b=0;b<this._panels.length;++b){var c=this._panels[b],d=c.panel.getId();d===a?(c.container.css("display",""),c.tab.addClass("g-active"),c.panel.activate()):(c.container.css("display","none"),c.tab.removeClass("g-active"),d===this._activePanel&&c.panel.deactivate())}this._activePanel=a}},b.prototype.setPanelEnabled=function(a,b){var c=this._getPanelInfo(a);if(c)if(b)c.container.find(".g-disabled-overlay").remove(),c.container.removeClass("g-disabled");else{var d=c.container.find(".g-disabled-overlay");0===d.length&&(d=$("<div></div>").addClass("g-disabled-overlay").appendTo(c.container)),c.container.addClass("g-disabled")}},b.prototype.init=function(){this._panels=[];var a=$("<div></div>").addClass("panels-tabs").appendTo(this._htmlElement),c=$("<div></div>").addClass("panels-frame").appendTo(this._htmlElement),d=function(b){var d=$("<button></button>").addClass("panel-tab").attr("data-panel-id",b.getId()).text(ifLocale.get(b.getTitle())).on("click",function(a){this.setActivePanel($(a.target).closest("button").attr("data-panel-id"))}.bind(this)).prepend(this._collapseIcon.clone()).appendTo(a),e=$("<div></div>").addClass("panel-container panel-"+b.getId()).css("display","none").appendTo(c);b.init(e),this.setPanelEnabled(b.getId(),b.isEnabled()),this._panels.push({tab:d,container:e,panel:b}),b.addEventListener(GView.UpdateEvent,function(){this.setPanelEnabled(b.getId(),b.isEnabled())}.bind(this))}.bind(this);if(gravit.panels)for(var e=0;e<gravit.panels.length;++e){var f=gravit.panels[e];d(f),this._activePanel||this.setActivePanel(f.getId())}this.setCollapseMode(b.CollapseMode.None)},b.prototype.relayout=function(){},b.prototype._getPanelInfo=function(a){for(var b=0;b<this._panels.length;++b){var c=this._panels[b].panel;if(c.getId()===a)return this._panels[b]}},a.GPanels=b}(this),function(a){function b(a){this._htmlElement=a}b.prototype._htmlElement=null,b.prototype._sidebars=null,b.prototype._activeSidebar=null,b.prototype.getActiveSidebar=function(){return this._activeSidebar},b.prototype.setActiveSidebar=function(a){if(a!==this._activeSidebar){for(var b=0;b<this._sidebars.length;++b){var c=this._sidebars[b],d=c.sidebar.getId();d===a?(c.container.css("display",""),c.sidebar.activate()):(c.container.css("display","none"),d===this._activeSidebar&&c.sidebar.deactivate())}this._activeSidebar=a}},b.prototype.setSidebarEnabled=function(a,b){var c=this._getSidebarInfo(a);if(c)if(b)c.container.find(".g-disabled-overlay").remove(),c.container.removeClass("g-disabled");else{var d=c.container.find(".g-disabled-overlay");0===d.length&&(d=$("<div></div>").addClass("g-disabled-overlay").appendTo(c.container)),c.container.addClass("g-disabled")}},b.prototype.init=function(){this._sidebars=[];var a=function(a){var b=$("<div></div>").addClass("sidebar-container sidebar-"+a.getId()).css("display","none").appendTo(this._htmlElement);a.init(b),this.setSidebarEnabled(a.getId(),a.isEnabled()),this._sidebars.push({container:b,sidebar:a}),a.addEventListener(GView.UpdateEvent,function(){this.setSidebarEnabled(a.getId(),a.isEnabled())}.bind(this))}.bind(this);if(gravit.sidebars)for(var b=0;b<gravit.sidebars.length;++b){var c=gravit.sidebars[b];a(c)}},b.prototype.relayout=function(){},b.prototype._getSidebarInfo=function(a){for(var b=0;b<this._sidebars.length;++b){var c=this._sidebars[b].sidebar;if(c.getId()===a)return this._sidebars[b]}},a.GSidebars=b}(this),function(a){function b(a){this._htmlElement=a,a.append($("<div></div>").addClass("section sidebars")).append($("<div></div>").addClass("section toolpanel"))}b.prototype._htmlElement=null,b.prototype._groupedTools=null,b.prototype.init=function(){if(gravit.sidebars&&gravit.sidebars.length>0)for(var a=this._htmlElement.find(".sidebars"),b=0;b<gravit.sidebars.length;++b){var c=gravit.sidebars[b];$("<button></button>").append($(c.getIcon())).attr("title",ifLocale.get(c.getTitle())).attr("data-sidebar-id",c.getId()).on("click",function(){var b=$(this),c=b.hasClass("g-active");a.find("button").each(function(a,b){$(b).removeClass("g-active")}),c?(gApp.getSidebars().setActiveSidebar(null),gApp.setPartVisible(GApplication.Part.Sidebars,!1)):(gApp.getSidebars().setActiveSidebar(b.attr("data-sidebar-id")),gApp.setPartVisible(GApplication.Part.Sidebars,!0),b.addClass("g-active"))}).appendTo(a)}var d=this._htmlElement.find(".toolpanel");this._groupedTools=[];for(var b=0;b<gravit.tools.length;++b){for(var e=gravit.tools[b],f=!1,g=0;g<this._groupedTools.length;++g)this._groupedTools[g].group===e.group&&(this._groupedTools[g].tools.push(e),f=!0);f||this._groupedTools.push({group:e.group,tools:[e]})}for(var h=null,b=0;b<this._groupedTools.length;++b){var i=this._groupedTools[b].group,j=this._groupedTools[b].tools,k=j[0],l=ifLocale.get(k.category);l!=h&&(null!==h&&$("<hr>").appendTo(d),h=l);{$("<button></button>").attr("data-group",i).appendTo(d)}j.length>1,this._updateGroupTool(k.instance)}gApp.getToolManager().addEventListener(IFToolManager.ToolChangedEvent,this._toolChanged,this)},b.prototype.relayout=function(){},b.prototype._toolChanged=function(a){a.previousTool&&this._updateGroupTool(a.previousTool),a.newTool&&this._updateGroupTool(a.newTool)},b.prototype._updateGroupTool=function(a){for(var b=this._getToolInfo(a),c=[],d=0;d<this._groupedTools.length;++d)this._groupedTools[d].group===b.group&&(c=this._groupedTools[d].tools.slice());var e=this._htmlElement.find('.toolpanel button[data-group="'+b.group+'"]');e.empty().toggleClass("g-active",a==gApp.getToolManager().getActiveTool()).attr("title",this._getToolTitle(b)).append($(b.icon).attr("width","18px").attr("height","18px")).off("mousedown").on("mousedown",function(){if(gApp.getToolManager().activateTool(a),c.length>1){var b=setTimeout(function(){for(var a=$("<div></div>").gOverlay({releaseOnClose:!0}),b=function(b){$("<button></button>").addClass("toolbar-tool-button").append($("<span></span>").addClass("fa fa-check fa-fw").css("visibility",b.instance!==gApp.getToolManager().getActiveTool()?"hidden":"")).append($(b.icon).attr("width","18px").attr("height","18px")).append($("<span></span>").html("&nbsp;"+this._getToolTitle(b))).on("mouseenter",function(){$(this).addClass("g-hover")}).on("mouseleave",function(){$(this).removeClass("g-hover")}).on("mouseup",function(){gApp.getToolManager().activateTool(b.instance),a.gOverlay("close")}).on("click",function(){gApp.getToolManager().getActiveTool()!==b.instance&&(gApp.getToolManager().activateTool(b.instance),a.gOverlay("close"))}).appendTo(a)}.bind(this),d=0;d<c.length;++d)b(c[d]);a.gOverlay("open",e)}.bind(this),250);e.off("mouseup").on("mouseup",function(){clearTimeout(b),b=null})}}.bind(this)),c.length>1&&e.append($("<span></span>").addClass("fa fa-caret-down"))},b.prototype._getToolTitle=function(a){var b=ifLocale.get(a.title);if(a.keys&&a.keys.length>0){for(var c=0;c<a.keys.length;++c)b+=0==c?" (":", ",b+=a.keys[c];b+=")"}return b},b.prototype._getToolInfo=function(a){for(var b=0;b<gravit.tools.length;++b)if(gravit.tools[b].instance===a)return gravit.tools[b];return null},a.GToolbar=b}(this),function(a){function b(a){this._container=$("<div></div>"),this._document=a,this._view=new IFEditorView(this._document.getEditor()),this._view.setViewMargin([b.VIEW_MARGIN,b.VIEW_MARGIN,b.VIEW_MARGIN,b.VIEW_MARGIN]),this._container.append(this._view._htmlElement),this._container.on("mousedown",function(){this._view.focus()}.bind(this));var c=this._createContextMenu();this._container.on("contextmenu",function(a){var b=gApp.getToolManager(),d=b.getActiveTool();return d&&d.catchesContextMenu()?void 0:(this._contextMenuClientPosition=new IFPoint(a.clientX,a.clientY),c.open({x:a.pageX,y:a.pageY}),!0)}.bind(this))}IFObject.inherit(b,IFEventTarget),b.VIEW_MARGIN=10,b.prototype._container=null,b.prototype._document=null,b.prototype._view=null,b.prototype._contextMenuClientPosition=null,b.prototype.getDocument=function(){return this._document},b.prototype.getView=function(){return this._view},b.prototype.getTitle=function(){var a=this._document.getTitle(),b=this._document._windows.indexOf(this);return b>0&&(a+=":"+b.toString()),a},b.prototype.activate=function(){},b.prototype.deactivate=function(){this._document.getEditor().closeInlineEditor()},b.prototype.release=function(){this._view.release()},b.prototype._createContextMenu=function(){var a=new GMenu,b=new GMenuItem(GMenuItem.Type.Menu);return b.setCaption("Select"),b.addEventListener(GMenuItem.UpdateEvent,function(){b.getMenu().clearItems(),b.setEnabled(!1);var a=this._document.getScene().hitTest(this._contextMenuClientPosition,this._view.getWorldTransform(),function(){return!0}.bind(this),!0,-1,this._document.getScene().getProperty("pickDist"),!0);if(a&&a.length>0){b.setEnabled(!0);for(var c=0;c<a.length;++c){var d=this,e=a[c].element,f=e instanceof IFBlock?e.getLabel():e.getNodeNameTranslated();b.getMenu().createAddItem((c+1).toString()+". "+f,function(){this.element.removeFlag(IFNode.Flag.Highlighted),d._document.getEditor().updateSelection(ifPlatform.modifiers.shiftKey,[this.element])},function(){this.element.setFlag(IFNode.Flag.Highlighted)},function(){this.element.removeFlag(IFNode.Flag.Highlighted)}).element=e}}}.bind(this)),a.addItem(b),a},a.GWindow=b}(this),function(a){function b(a){this._htmlElement=a,this._windows=[]}IFObject.inherit(b,IFEventTarget),b.WindowEvent=function(a,b){this.type=a,this.window=b},IFObject.inherit(b.WindowEvent,IFEvent),b.WindowEvent.Type={Added:0,Removed:1,Deactivated:10,Activated:11},b.WindowEvent.prototype.type=null,b.WindowEvent.prototype.window=null,b.WindowEvent.prototype.toString=function(){return"[Object GWindows.WindowEvent]"},b.prototype._htmlElement=null,b.prototype._windows=null,b.prototype._activeWindow=null,b.prototype._viewOffset=null,b.prototype.getWindows=function(){return this._windows},b.prototype.getActiveWindow=function(){return this._activeWindow},b.prototype.activateWindow=function(a){if(a!=this._activeWindow){this._activeWindow&&(this._activeWindow.deactivate(),this._activeWindow.getDocument()._activeWindow=null,this._activeWindow._container.detach()),null===a?gApp.activateDocument(null,!0):(a&&this._activeWindow&&a.getDocument()!==this._activeWindow.getDocument()||!this._activeWindow)&&gApp.activateDocument(a.getDocument(),!0);var c=this._activeWindow;this._activeWindow=a,c&&this.hasEventListeners(b.WindowEvent)&&this.trigger(new b.WindowEvent(b.WindowEvent.Type.Deactivated,c)),a&&(this._activeWindow.activate(),a.getDocument()._activeWindow=a,this._htmlElement.append(a._container),this._relayoutWindow(a),a.getView().focus(),this.hasEventListeners(b.WindowEvent)&&this.trigger(new b.WindowEvent(b.WindowEvent.Type.Activated,a)))}},b.prototype.addWindow=function(a){var b=a instanceof GWindow?a.getDocument():a,c=this._addWindow(b);if(a instanceof GWindow){var d=a.getView();c.getView().transform(d.getScrollX(),d.getScrollY(),d.getZoom())}else c.getView().zoomActivePage();return c},b.prototype.closeWindow=function(a){var c=a.getDocument();if(a===this._activeWindow){var d=this._windows.indexOf(a);this.activateWindow(d>0?this._windows[d-1]:d+1<this._windows.length?this._windows[d+1]:null)}c._windows.splice(c._windows.indexOf(a),1),this._windows.splice(this._windows.indexOf(a),1),a._container.remove(),this.hasEventListeners(b.WindowEvent)&&this.trigger(new b.WindowEvent(b.WindowEvent.Type.Removed,a)),a.release(),0===c._windows.length&&gApp.closeDocument(c)},b.prototype.init=function(){},b.prototype.relayout=function(a){this._viewOffset=a?a:this._viewOffset,this._activeWindow&&this._relayoutWindow(this._activeWindow)},b.prototype._relayoutWindow=function(a){var b=this._htmlElement.width(),c=this._htmlElement.height();a._container.width(b),a._container.height(c),a.getView().setViewOffset(this._viewOffset);var d=a.getView().getWidth(),e=a.getView().getHeight();a.getView().resize(b,c),null==d||null==e||d==b&&e==c||a.getView().scrollBy((d-b)/2,(e-c)/2)},b.prototype._addWindow=function(a){var c=new GWindow(a);return a._windows.push(c),this._windows.push(c),this.hasEventListeners(b.WindowEvent)&&this.trigger(new b.WindowEvent(b.WindowEvent.Type.Added,c)),this.activateWindow(c),c},a.GWindows=b}(this),function(a){function b(a,b){var l=a.L,m=a.a,n=a.b,o=b.L,p=b.a,q=b.b,r=1,s=1,t=1,u=e(f(m,2)+f(n,2)),v=e(f(p,2)+f(q,2)),w=(u+v)/2,x=.5*(1-e(f(w,7)/(f(w,7)+f(25,7)))),y=(1+x)*m,z=(1+x)*p,A=e(f(y,2)+f(n,2)),B=e(f(z,2)+f(q,2)),C=function(a,b){if(0==a&&0==b)return 0;var d=c(h(a,b));return d>=0?d:d+360},D=C(n,y),E=C(q,z),F=o-l,G=B-A,H=function(a,b,c,d){if(a*b==0)return 0;if(j(d-c)<=180)return d-c;if(d-c>180)return d-c-360;if(-180>d-c)return d-c+360;throw new Error},I=H(u,v,D,E),J=2*e(A*B)*i(d(I)/2),K=(l+o)/2,L=(A+B)/2,M=function(a,b,c,d){if(a*b==0)return c+d;if(j(c-d)<=180)return(c+d)/2;if(j(c-d)>180&&360>c+d)return(c+d+360)/2;if(j(c-d)>180&&c+d>=360)return(c+d-360)/2;throw new Error},N=M(u,v,D,E),O=1-.17*g(d(N-30))+.24*g(d(2*N))+.32*g(d(3*N+6))-.2*g(d(4*N-63)),P=30*k(-f((N-275)/25,2)),Q=e(f(L,7)/(f(L,7)+f(25,7))),R=1+.015*f(K-50,2)/e(20+f(K-50,2)),S=1+.045*L,T=1+.015*L*O,U=-2*Q*i(d(2*P)),V=e(f(F/(R*r),2)+f(G/(S*s),2)+f(J/(T*t),2)+U*(G/(S*s))*(J/(T*t)));return V}function c(a){return a*(180/l)}function d(a){return a*(l/180)}a.ciede2000=b;var e=Math.sqrt,f=Math.pow,g=Math.cos,h=Math.atan2,i=Math.sin,j=Math.abs,k=Math.exp,l=Math.PI}(this),function(a){a.image2Canvas=function(b,c){if("string"==typeof b&&"data:"!==b.substr(0,5)){var d=new Image;d.src=b,d.onload=function(){a.image2Canvas(d,c)}}else{var e=document.createElement("canvas");e.width=b.naturalWidth,e.height=b.naturalHeight;var f=e.getContext("2d");f.drawImage(b,0,0),c(e)}},a.image2Base64=function(b,c){a.image2Canvas(b,function(a){c(a.toDataURL("image/png"))})},a.image2ArrayBuffer=function(b,c){a.image2Canvas(b,function(a){a.toBlob(function(a){var b=new FileReader;b.onload=function(a){c(a.target.result)},b.readAsArrayBuffer(a)})})}}(this),function(a){a.expr[":"].editable=function(b){var c=a(b);if("true"===c.attr("contenteditable")||b.isContentEditable)return!0;if(c.is(":input")){var d=c.attr("type");return!d||""===d||"text"===d}return c.is("textArea")?!0:!1},a.ajaxTransport("+*",function(a,b,c){return window.FormData&&(a.dataType&&("blob"==a.dataType||"arraybuffer"==a.dataType)||a.data&&(window.Blob&&a.data instanceof Blob||window.ArrayBuffer&&a.data instanceof ArrayBuffer))?{send:function(b,c){var d=new XMLHttpRequest,e=a.url||window.location.href,f=a.type||"GET",g=a.dataType||"text",h=a.data||null,i=a.async||!0;d.addEventListener("load",function(){var a={};a[g]=d.response,c(d.status,d.statusText,a,d.getAllResponseHeaders())}),d.open(f,e,i),d.responseType=g,d.send(h)},abort:function(){c.abort()}}:void 0})}(jQuery);var CubicSpline,MonotonicCubicSpline;MonotonicCubicSpline=function(){function a(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(i=a.length,e=[],h=[],c=[],d=[],f=[],j=[],g=0,p=i-1;p>=0?p>g:g>p;p>=0?g+=1:g-=1)e[g]=(b[g+1]-b[g])/(a[g+1]-a[g]),g>0&&(h[g]=(e[g-1]+e[g])/2);for(h[0]=e[0],h[i-1]=e[i-2],k=[],g=0,q=i-1;q>=0?q>g:g>q;q>=0?g+=1:g-=1)0===e[g]&&k.push(g);for(l=0,n=k.length;n>l;l++)g=k[l],h[g]=h[g+1]=0;for(g=0,r=i-1;r>=0?r>g:g>r;r>=0?g+=1:g-=1)c[g]=h[g]/e[g],d[g]=h[g+1]/e[g],f[g]=Math.pow(c[g],2)+Math.pow(d[g],2),j[g]=3/Math.sqrt(f[g]);for(k=[],g=0,s=i-1;s>=0?s>g:g>s;s>=0?g+=1:g-=1)f[g]>9&&k.push(g);for(m=0,o=k.length;o>m;m++)g=k[m],h[g]=j[g]*c[g]*e[g],h[g+1]=j[g]*d[g]*e[g];this.x=a.slice(0,i),this.y=b.slice(0,i),this.m=h}return a.prototype.interpolate=function(a){var b,c,d,e,f,g,h,i,j,k,l;for(g=l=this.x.length-2;(0>=l?0>=g:g>=0)&&!(this.x[g]<=a);0>=l?g+=1:g-=1);return b=this.x[g+1]-this.x[g],h=(a-this.x[g])/b,i=Math.pow(h,2),j=Math.pow(h,3),c=2*j-3*i+1,e=j-2*i+h,d=-2*j+3*i,f=j-i,k=c*this.y[g]+e*b*this.m[g]+d*this.y[g+1]+f*b*this.m[g+1]},a}(),CubicSpline=function(){function a(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(null!=a&&null!=b){for(g=null!=c&&null!=d,m=a.length-1,i=[],p=[],l=[],o=[],q=[],f=[],e=[],h=[],k=[],n=[],j=0;m>=0?m>j:j>m;m>=0?j+=1:j-=1)i[j]=a[j+1]-a[j],k[j]=b[j+1]-b[j],n[j]=k[j]/i[j];for(g&&(p[0]=3*(b[1]-b[0])/i[0]-3*c,p[m]=3*d-3*(b[m]-b[m-1])/i[m-1]),j=1;m>=1?m>j:j>m;m>=1?j+=1:j-=1)p[j]=3/i[j]*(b[j+1]-b[j])-3/i[j-1]*(b[j]-b[j-1]);for(g?(l[0]=2*i[0],o[0]=.5,q[0]=p[0]/l[0]):(l[0]=1,o[0]=0,q[0]=0),j=1;m>=1?m>j:j>m;m>=1?j+=1:j-=1)l[j]=2*(a[j+1]-a[j-1])-i[j-1]*o[j-1],o[j]=i[j]/l[j],q[j]=(p[j]-i[j-1]*q[j-1])/l[j];for(g?(l[m]=i[m-1]*(2-o[m-1]),q[m]=(p[m]-i[m-1]*q[m-1])/l[m],f[m]=q[m]):(l[m]=1,q[m]=0,f[m]=0),j=r=m-1;0>=r?0>=j:j>=0;0>=r?j+=1:j-=1)f[j]=q[j]-o[j]*f[j+1],e[j]=(b[j+1]-b[j])/i[j]-i[j]*(f[j+1]+2*f[j])/3,h[j]=(f[j+1]-f[j])/(3*i[j]);this.x=a.slice(0,m+1),this.a=b.slice(0,m),this.b=e,this.c=f.slice(0,m),this.d=h}}return a.prototype.derivative=function(){var a,b,c,d,e,f,g,h,i,j,k;for(c=new this.constructor,c.x=this.x.slice(0,this.x.length),c.a=this.b.slice(0,this.b.length),i=this.c,e=0,g=i.length;g>e;e++)a=i[e],c.b=2*a;for(j=this.d,f=0,h=j.length;h>f;f++)b=j[f],c.c=3*b;for(d=0,k=this.d.length;k>=0?k>d:d>k;k>=0?d+=1:d-=1)c.d=0;return c},a.prototype.interpolate=function(a){var b,c,d,e;for(c=e=this.x.length-1;(0>=e?0>=c:c>=0)&&!(this.x[c]<=a);0>=e?c+=1:c-=1);return b=a-this.x[c],d=this.a[c]+this.b[c]*b+this.c[c]*Math.pow(b,2)+this.d[c]*Math.pow(b,3)},a}(),function(a){function b(){}IFObject.inherit(b,IFEventTarget),b.prototype.isDevelopment=function(){return!1},b.prototype.prepare=function(){},b.prototype.start=function(){gApp.createNewDocument()},b.prototype.addMenu=function(){throw new Error("Not Supported.")},b.prototype.addMenuSeparator=function(){throw new Error("Not Supported.")},b.prototype.addMenuItem=function(){throw new Error("Not Supported.")},b.prototype.updateMenuItem=function(){throw new Error("Not Supported.")},b.prototype.removeMenuItem=function(){throw new Error("Not Supported.")},b.prototype.getClipboardMimeTypes=function(){throw new Error("Not Supported.")},b.prototype.getClipboardContent=function(){throw new Error("Not Supported.")},b.prototype.setClipboardContent=function(){throw new Error("Not Supported.")},a.GShell=b,a.gShell=null}(this),function(a){function b(){this._actions=[],this._toolManager=new IFToolManager,this._documents=[],document.addEventListener("touchstart",this._touchHandler,!0),document.addEventListener("touchmove",this._touchHandler,!0),document.addEventListener("touchend",this._touchHandler,!0),document.addEventListener("touchcancel",this._touchHandler,!0),document.addEventListener("keydown",function(){var a=this._windows.getActiveWindow();!a||document.activeElement&&$(document.activeElement).is(":editable")||a.getView().focus()}.bind(this),!1),document.addEventListener("contextmenu",function(a){return $(a.target).is(":editable")?(a.stopPropagation(),!0):(a.preventDefault(),!1)},!0)}IFObject.inherit(b,IFEventTarget),b.CATEGORY_FILE=new IFLocale.Key(b,"category.file"),b.CATEGORY_EDIT=new IFLocale.Key(b,"category.edit"),b.CATEGORY_MODIFY=new IFLocale.Key(b,"category.modify"),b.CATEGORY_MODIFY_ARRANGE=new IFLocale.Key(b,"category.modify.arrange"),b.CATEGORY_MODIFY_ALIGN=new IFLocale.Key(b,"category.modify.align"),b.CATEGORY_MODIFY_TRANSFORM=new IFLocale.Key(b,"category.modify.transform"),b.CATEGORY_MODIFY_PAGE=new IFLocale.Key(b,"category.modify.page"),b.CATEGORY_MODIFY_LAYER=new IFLocale.Key(b,"category.modify.layer"),b.CATEGORY_VIEW=new IFLocale.Key(b,"category.view"),b.CATEGORY_VIEW_MAGNIFICATION=new IFLocale.Key(b,"category.view.magnification"),b.CATEGORY_HELP=new IFLocale.Key(b,"category.help"),b.TOOL_CATEGORY_SELECT=new IFLocale.Key(b,"tool-category.select"),b.TOOL_CATEGORY_IMAGE=new IFLocale.Key(b,"tool-category.image"),b.TOOL_CATEGORY_VECTOR=new IFLocale.Key(b,"tool-category.vector"),b.TOOL_CATEGORY_OTHER=new IFLocale.Key(b,"tool-category.other"),b.TOOL_CATEGORY_COLOR=new IFLocale.Key(b,"tool-category.color"),b.TOOL_CATEGORY_VIEW=new IFLocale.Key(b,"tool-category.view"),b.Part={Header:{id:"header"},Toolbar:{id:"toolbar"},Panels:{id:"panels"},Sidebars:{id:"sidebars"},Windows:{id:"windows"},Palettes:{id:"palettes"}},b.DocumentEvent=function(a,b){this.type=a,this.document=b
},IFObject.inherit(b.DocumentEvent,IFEvent),b.DocumentEvent.Type={Added:0,Removed:1,Deactivated:10,Activated:11,UrlUpdated:12},b.DocumentEvent.prototype.type=null,b.DocumentEvent.prototype.document=null,b.DocumentEvent.prototype.toString=function(){return"[Object GApplication.DocumentEvent]"},b.prototype._initialized=!1,b.prototype._toolManager=null,b.prototype._documentUntitledCount=0,b.prototype._documents=null,b.prototype._activeDocument=null,b.prototype._view=null,b.prototype._header=null,b.prototype._toolbar=null,b.prototype._panels=null,b.prototype._sidebars=null,b.prototype._windows=null,b.prototype._palettes=null,b.prototype._resizeTimerId=null,b.prototype._actions=null,b.prototype.getToolManager=function(){return this._toolManager},b.prototype.getDocuments=function(){return this._documents},b.prototype.getActiveDocument=function(){return this._activeDocument?this._activeDocument:null},b.prototype.getHeader=function(){return this._header},b.prototype.getToolbar=function(){return this._toolbar},b.prototype.getPanels=function(){return this._panels},b.prototype.getSidebars=function(){return this._sidebars},b.prototype.getWindows=function(){return this._windows},b.prototype.getPalettes=function(){return this._palettes},b.prototype.isPartVisible=function(a){return"none"!==this.getPart(a).css("display")},b.prototype.setPartVisible=function(a,b){b!=this.isPartVisible(a)&&(this.getPart(a).css("display",b?"block":"none"),this.relayout())},b.prototype.getPart=function(a){return this._view.find("#"+a.id)},b.prototype.getActions=function(){return this._actions},b.prototype.getAction=function(a){for(var b=0;b<this._actions.length;++b)if(this._actions[b].getId()===a)return this._actions[b];return null},b.prototype.getStorage=function(a){var b=new URI(a).protocol();if(b&&b.length)for(var c=0;c<gravit.storages.length;++c)if(gravit.storages[c].getProtocol()===b)return gravit.storages[c];return null},b.prototype.getMatchingStorage=function(a,b,c,d,e){var f=[];e&&f.push(e);for(var g=0;g<gravit.storages.length;++g){var h=gravit.storages[g];h!==e&&f.push(h)}for(var g=0;g<f.length;++g){var h=f[g];if(!(a&&!h.isPrompting()||b&&!h.isSaving())){if(c&&""!==c){var i=h.getExtensions();if(i&&i.length&&i.indexOf(c)<0)continue}if(!d||h.isDirectory())return h}}return null},b.prototype.createNewDocument=function(){var a=new IFScene;a.setProperty("unit",IFLength.Unit.PX);var b=new IFStyle;b.setProperties(["name","_sdf","ps","_bpt","_fpt"],["Shape Default","shape",[IFStylable.PropertySet.Style,IFStylable.PropertySet.Effects,IFStylable.PropertySet.Fill,IFStylable.PropertySet.Border],IFRGBColor.BLACK,IFRGBColor.WHITE]);var c=new IFStyle;c.setProperties(["name","_sdf","ps","_fpt"],["Text Default","text",[IFStylable.PropertySet.Style,IFStylable.PropertySet.Effects,IFStylable.PropertySet.Fill,IFStylable.PropertySet.Border,IFStylable.PropertySet.Text,IFStylable.PropertySet.Paragraph],IFRGBColor.BLACK]),a.getStyleCollection().appendChild(b),a.getStyleCollection().appendChild(c);var d=this.addDocument(a);d.createNewPage(!0)},b.prototype.addDocument=function(a,b){var c=new GDocument(a,null,b?b:"Untitled-"+(++this._documentUntitledCount).toString());return this._addDocument(c),c},b.prototype.openDocument=function(a){for(var b=!1,c=0;c<this._documents.length;++c){var d=this._documents[c];d.getUrl()===a&&(this.activateDocument(d),b=!0)}if(!b){var e=this.getStorage(a);e&&e.load(a,!0,function(b,c){var d=function(b){var d=new IFScene,e=new GDocument(d,a,c);try{var f=JSON.parse(b);if(!f)throw new Error("Unable to parse JSON.");IFNode.restoreInstance(f,d)}catch(g){e.release(),d=null,e=null,console.log(g),vex.dialog.alert("An error has ocurred while trying to open the document.")}e&&this._addDocument(e)}.bind(this),e=new Uint8Array(b);if(31===e[0]&&139===e[1]&&8===e[2]){var f=pako.ungzip(e,{to:"string"});d(f)}else{var g=new FileReader;g.onload=function(a){d(a.target.result)},g.readAsText(new Blob([b]))}}.bind(this))}},b.prototype.openDocumentFrom=function(a){var b=gApp.getActiveDocument()?gApp.getActiveDocument().getUrl():null;a.openResourcePrompt(b&&""!==b?b:null,["gravit"],function(a){gApp.openDocument(a)})},b.prototype.saveDocumentAs=function(a,c){var c=c||this.getActiveDocument();c&&a.saveResourcePrompt(null,c.getTitle(),"gravit",function(a){c.setUrl(a),c.save(),this.hasEventListeners(b.DocumentEvent)&&this.trigger(new b.DocumentEvent(b.DocumentEvent.Type.UrlUpdated,c))}.bind(this))},b.prototype.activateDocument=function(a,c){a!=this._activeDocument&&(this._activeDocument&&(this._activeDocument&&(this._activeDocument.deactivate(),this.hasEventListeners(b.DocumentEvent)&&this.trigger(new b.DocumentEvent(b.DocumentEvent.Type.Deactivated,this._activeDocument))),this._activeDocument=null),a&&(c||this._windows.activateWindow(a.getActiveWindow()),a.activate(),this._activeDocument=a,this.hasEventListeners(b.DocumentEvent)&&this.trigger(new b.DocumentEvent(b.DocumentEvent.Type.Activated,a))))},b.prototype.closeDocument=function(a){var c=a.getWindows().length;if(c.length)for(;c.length>0;)c.closeWindow(c[0]);else a===this.getActiveDocument()&&this.activateDocument(null),a.release(),this._documents.splice(this._documents.indexOf(a),1),this.hasEventListeners(b.DocumentEvent)&&this.trigger(new b.DocumentEvent(b.DocumentEvent.Type.Removed,a))},b.prototype.canExecuteAction=function(a,b){var c=this.getAction(a);return c?c.isAvailable()&&c.isEnabled.apply(c,b):!1},b.prototype.executeAction=function(a,b){var c=this.getAction(a);if(!c)throw new Error("Unable to execute action '"+a+"' - not registered.");if(c.isAvailable()&&c.isEnabled.apply(c,b)){var d=c.execute.apply(c,b);return"undefined"!=typeof d?d:!0}return!1},b.prototype.init=function(){for(var a=$("body"),c=0;c<gravit.modules.length;++c){var d=gravit.modules[c];console.log("Init module <"+d.toString()+">"),d.init()}this._view=$("<div></div>").attr("id","workspace").css("display","none").prependTo(a);var e=$("<div></div>").attr("id",b.Part.Windows.id).appendTo(this._view);this._windows=new GWindows(e);var f=$("<div></div>").attr("id",b.Part.Header.id).appendTo(this._view);this._header=new GHeader(f);var g=$("<div></div>").attr("id",b.Part.Toolbar.id).appendTo(this._view);this._toolbar=new GToolbar(g);var h=$("<div></div>").attr("id",b.Part.Panels.id).appendTo(this._view);this._panels=new GPanels(h);var i=$("<div></div>").attr("id",b.Part.Sidebars.id).appendTo(this._view);this._sidebars=new GSidebars(i);var j=$("<div></div>").attr("id",b.Part.Palettes.id).appendTo(this._view);switch(this._palettes=new GPalettes(j),IFSystem.hardware){case IFSystem.Hardware.Desktop:a.addClass("g-desktop");break;case IFSystem.Hardware.Tablet:a.addClass("g-touch"),a.addClass("g-tablet");break;case IFSystem.Hardware.Phone:a.addClass("g-touch"),a.addClass("g-phone")}if($(window).resize(function(){null!=this._resizeTimerId&&(clearTimeout(this._resizeTimerId),this._resizeTimerId=null),this._windows.relayout(),this._resizeTimerId=setTimeout(function(){this.relayout(),this._resizeTimerId=null}.bind(this),200)}.bind(this)),this._actions=gravit.actions.slice(),this._createMainMenu(),gravit.tools)for(var k=function(a){return function(){this._toolManager.activateTool(a)}.bind(this)}.bind(this),c=0;c<gravit.tools.length;++c){var l=gravit.tools[c];if(this._toolManager.addTool(l.instance),l.keys&&l.keys.length>0)for(var m=k(l.instance),n=0;n<l.keys.length;++n)this.registerShortcut([l.keys[n]],m)}this._header.init(),this._toolbar.init(),this._panels.init(),this._sidebars.init(),this._windows.init(),this._palettes.init(),this.setPartVisible(b.Part.Sidebars,!1),this._view.css("display",""),this._initialized=!0,this._windows.addEventListener(GWindows.WindowEvent,this._windowEvent,this)},b.prototype.relayout=function(){this._initialized&&setTimeout(function(){var a=0,c=0,d=0,e=0,f=this.getPart(b.Part.Header);a+=this.isPartVisible(b.Part.Header)?f.outerHeight():0;var g=this.getPart(b.Part.Toolbar);g.css("top",a.toString()+"px"),g.height(this._view.height()-a-3),c+=this.isPartVisible(b.Part.Toolbar)?g.outerWidth():0;var h=this.getPart(b.Part.Sidebars);h.css("top",a.toString()+"px"),h.css("left",c.toString()+"px"),h.height(this._view.height()-a),c+=this.isPartVisible(b.Part.Sidebars)?h.outerWidth():0;var i=this.getPart(b.Part.Palettes);i.css("top",a.toString()+"px"),i.height(this._view.height()-a),d+=this.isPartVisible(b.Part.Palettes)?i.outerWidth():0;var j=this.getPart(b.Part.Panels);j.css("left",c.toString()+"px"),j.css("width",(this._view.width()-c-d).toString()+"px"),e+=this.isPartVisible(b.Part.Panels)?j.outerHeight():0,this._header.relayout(),this._toolbar.relayout(),this._panels.relayout(),this._sidebars.relayout(),this._windows.relayout([c,a,d,e]),this._palettes.relayout()}.bind(this),0)},b.prototype.registerShortcut=function(a,b){Mousetrap.bind(this._shortcutToMouseTrapShortcut(a),function(){return b(),!1}.bind(this))},b.prototype._addDocument=function(a){this.hasEventListeners(b.DocumentEvent)&&this.trigger(new b.DocumentEvent(b.DocumentEvent.Type.Added,a)),this._windows.addWindow(a)},b.prototype._createMainMenu=function(){for(var a=[],c={items:[]},d=function(b){for(var c=0;c<a.length;++c)if(a[c].item===b)return a[c].group},e=function(b,c,e){if(b.items.length>0){var f=d(b.items[b.items.length-1]);f!==e&&b.items.push({type:"divider"})}a.push({item:c,group:e})},f=0;f<this._actions.length;++f){var g=this._actions[f];if(g.isAvailable()){var h=ifLocale.get(g.getCategory()),i=g.getGroup(),j=h?h.split("/"):null,k=i?[""].concat(i.split("/")):null;if(k&&j&&j.length!==k.length-1)throw new Error("Number of categories different thant number of groups.");var l=c;if(j)for(var m=0;m<j.length;++m){for(var h=j[m],i=k?k[m]:null,n=null,o=0;o<l.items.length;++o)h==l.items[o].caption&&(n=l.items[o]);n||(n={type:"menu",caption:h,items:[],windowMenu:b.CATEGORY_WINDOW===g.getCategory()&&l===c},e(l,n,i),l.items.push(n)),l=n}var p={type:"item",action:g};e(l,p,k?k[k.length-1]:null),l.items.push(p)}}for(var q=function(a,b){"menu"===a.type?a.menu=r(a,b):"divider"===a.type?a.separator=gShell.addMenuSeparator(b):"item"===a.type&&(a.item=gShell.addMenuItem(b,ifLocale.get(a.action.getTitle()),a.action.isCheckable(),a.action.getShortcut(),function(){this.executeAction(a.action.getId())}.bind(this)))}.bind(this),r=function(a,b){for(var c=gShell.addMenu(b,a.caption,function(){for(var b=0;b<a.items.length;++b){var c=a.items[b];"item"===c.type&&gShell.updateMenuItem(c.item,ifLocale.get(c.action.getTitle()),c.action.isEnabled(),c.action.isCheckable()?c.action.isChecked():!1)}}),d=0;d<a.items.length;++d)q(a.items[d],c);return c},f=0;f<c.items.length;++f){var n=c.items[f];r(c.items[f],null)}},b.prototype._windowEvent=function(a){switch(a.type){case GWindows.WindowEvent.Type.Added:case GWindows.WindowEvent.Type.Removed:this._updateTitle();break;case GWindows.WindowEvent.Type.Activated:this._toolManager.setView(a.window.getView()),this._updateTitle();break;case GWindows.WindowEvent.Type.Deactivated:this._toolManager.setView(null),this._updateTitle()}},b.prototype._updateTitle=function(){var a="Gravit",b=this.getWindows().getActiveWindow();b&&(a+=" - "+b.getTitle()),document.title=a},b.prototype._touchHandler=function(a){function b(a,b){var c=document.createEvent("MouseEvent");c.initMouseEvent(a,!0,!0,window,1,b.screenX,b.screenY,b.clientX,b.clientY,!1,!1,!1,!1,0,null),b.target.dispatchEvent(c)}if(!(a.touches.length>1)){var c=a.changedTouches[0];switch(a.type){case"touchstart":b("mousedown",c);break;case"touchmove":b("mousemove",c);break;case"touchend":b("mouseup",c),b("click",c);break;default:return}a.preventDefault(),a.stopPropagation()}},b.prototype._shortcutToMouseTrapShortcut=function(a){for(var b="",c=0;c<a.length;++c){c>0&&(b+="+");var d=a[c];if("number"==typeof d)switch(d){case IFKey.Constant.META:b+="meta";break;case IFKey.Constant.OPTION:b+="option";break;case IFKey.Constant.REMOVE:b+="del";break;case IFKey.Constant.SPACE:b+="space";break;case IFKey.Constant.ENTER:b+="enter";break;case IFKey.Constant.TAB:b+="tab";break;case IFKey.Constant.BACKSPACE:b+="backspace";break;case IFKey.Constant.CONTROL:b+="ctrl";break;case IFKey.Constant.SHIFT:b+="shift";break;case IFKey.Constant.ALT:b+="alt";break;case IFKey.Constant.LEFT:b+="left";break;case IFKey.Constant.UP:b+="up";break;case IFKey.Constant.RIGHT:b+="right";break;case IFKey.Constant.DOWN:b+="down";break;case IFKey.Constant.PAGE_UP:b+="pageup";break;case IFKey.Constant.PAGE_DOWN:b+="pagedown";break;case IFKey.Constant.HOME:b+="home";break;case IFKey.Constant.END:b+="end";break;case IFKey.Constant.INSERT:b+="ins";break;case IFKey.Constant.DELETE:b+="del";break;case IFKey.Constant.COMMAND:b+="meta";break;case IFKey.Constant.F1:b+="f1";break;case IFKey.Constant.F2:b+="f2";break;case IFKey.Constant.F3:b+="f3";break;case IFKey.Constant.F4:b+="f4";break;case IFKey.Constant.F5:b+="f5";break;case IFKey.Constant.F6:b+="f6";break;case IFKey.Constant.F7:b+="f7";break;case IFKey.Constant.F8:b+="f8";break;case IFKey.Constant.F9:b+="f9";break;case IFKey.Constant.F10:b+="f10";break;case IFKey.Constant.F11:b+="f11";break;case IFKey.Constant.F12:b+="f12";break;default:throw new Error("Unknown key code")}else b+=d.toLowerCase()}return b},a.GApplication=b}(this),function(a){function b(a,b,c){this.setUrl(b),this._scene=a,this._editor=new IFEditor(a),this._windows=[],this._activeWindow=null,this._title=c,this._scene.addEventListener(IFScene.ResolveUrlEvent,this._resolveUrl,this)}IFObject.inherit(b,IFEventTarget),b.prototype._scene=null,b.prototype._url=null,b.prototype._editor=null,b.prototype._windows=null,b.prototype._activeWindow=null,b.prototype._title=null,b.prototype.getScene=function(){return this._scene},b.prototype.getStorage=function(){return this._storage},b.prototype.getUrl=function(){return this._url},b.prototype.setUrl=function(a){a!==this._url&&(this._storage&&this._storage.releaseUrl(this._url),this._url=a,this._storage=a?gApp.getStorage(a):null)},b.prototype.getEditor=function(){return this._editor},b.prototype.getWindows=function(){return this._windows},b.prototype.getActiveWindow=function(){return this._activeWindow},b.prototype.getTitle=function(){return this._title},b.prototype.isSaveable=function(){return!!this._storage},b.prototype.save=function(){if(this._url){var a=IFNode.serialize(this._scene),b=pako.gzip(a,{level:9});this._storage.save(this._url,b.buffer,!0,function(a){this._title=a}.bind(this))}},b.prototype.createNewPage=function(a){var b=this._scene,c=this._scene.getPageInsertPosition(),d=new IFPage;d.setProperties(["name","x","y","w","h","bck"],["Page "+(b.queryCount("> page")+1).toString(),c.getX(),c.getY(),800,600,IFRGBColor.WHITE]);var e=new IFLayer;e.setProperties(["name"],["Background"]),d.appendChild(e);var f=function(){b.appendChild(d),b.setActiveLayer(e)};return a?f():IFEditor.tryRunTransaction(b,f,"Add new Page"),d},b.prototype.activate=function(){},b.prototype.deactivate=function(){},b.prototype.release=function(){this._editor.release(),this._scene.removeEventListener(IFScene.ResolveUrlEvent,this._resolveUrl,this),this._storage&&this._storage.releaseUrl(this._url)},b.prototype._resolveUrl=function(a){var b=new URI(a.url);if(0===b.protocol().length&&(b=b.absoluteTo(this._url)),b.protocol().length>0){("http"===b.protocol()||"https"===b.protocol())&&a.resolved(a.url);var c=gApp.getStorage(b.protocol()+":");c&&c.resolveUrl(b.toString(),a.resolved)}},a.GDocument=b}(this);var gravit={modules:[],storages:[],exporters:[],actions:[],palettes:[],sidebars:[],panels:[],tools:[],properties:[]},gLoaderCode='<div style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; background: rgb(213, 223, 0);">\n    <style type="text/css">\n        .spinner {\n            width: 120px;\n            height: 120px;\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            margin: -80px 0 0 -60px;\n            text-align: center;\n            -webkit-animation: rotate 2.0s infinite linear;\n            animation: rotate 2.0s infinite linear;\n        }\n\n        .spinner-dot1, .spinner-dot2 {\n            width: 60%;\n            height: 60%;\n            display: inline-block;\n            position: absolute;\n            top: 0;\n            background-color: rgb(229, 71, 97);\n            border-radius: 100%;\n            -webkit-animation: bounce 2.0s infinite ease-in-out;\n            animation: bounce 2.0s infinite ease-in-out;\n        }\n\n        .spinner-dot1 {\n            top: auto;\n            bottom: 0px;\n            -webkit-animation-delay: -1.0s;\n            animation-delay: -1.0s;\n        }\n\n        @-webkit-keyframes rotate { 100% { -webkit-transform: rotate(360deg) }}\n        @keyframes rotate { 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg) }}\n\n        @-webkit-keyframes bounce {\n            0%, 100% { -webkit-transform: scale(0.0) }\n            50% { -webkit-transform: scale(1.0) }\n        }\n\n        @keyframes bounce {\n            0%, 100% {\n                transform: scale(0.0);\n                -webkit-transform: scale(0.0);\n            } 50% {\n                  transform: scale(1.0);\n                  -webkit-transform: scale(1.0);\n              }\n        }\n    </style>\n    <div class="spinner">\n        <div class="spinner-dot1"></div>\n        <div class="spinner-dot2"></div>\n    </div>\n</div>',gShell=null,gApp=null,__loader=null;$(document).ready(function(){if(!gShell)throw new Error("Shell needs to be initialized, first.");__loader=$(gLoaderCode).appendTo($("body")),ifFont.addType("Open Sans",IFFont.Style.Normal,IFFont.Weight.Light,"font/OpenSans-Light.ttf",IFFont.Category.Serif),ifFont.addType("Open Sans",IFFont.Style.Italic,IFFont.Weight.Light,"font/OpenSans-LightItalic.ttf"),ifFont.addType("Open Sans",IFFont.Style.Normal,IFFont.Weight.Regular,"font/OpenSans-Regular.ttf"),ifFont.addType("Open Sans",IFFont.Style.Italic,IFFont.Weight.Regular,"font/OpenSans-Italic.ttf"),ifFont.addType("Open Sans",IFFont.Style.Normal,IFFont.Weight.SemiBold,"font/OpenSans-Semibold.ttf"),ifFont.addType("Open Sans",IFFont.Style.Italic,IFFont.Weight.SemiBold,"font/OpenSans-SemiboldItalic.ttf"),ifFont.addType("Open Sans",IFFont.Style.Normal,IFFont.Weight.Bold,"font/OpenSans-Bold.ttf"),ifFont.addType("Open Sans",IFFont.Style.Italic,IFFont.Weight.Bold,"font/OpenSans-BoldItalic.ttf"),ifFont.addType("Open Sans",IFFont.Style.Normal,IFFont.Weight.ExtraBold,"font/OpenSans-ExtraBold.ttf"),ifFont.addType("Open Sans",IFFont.Style.Italic,IFFont.Weight.ExtraBold,"font/OpenSans-ExtraBoldItalic.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.ExtraLight,"font/SourceSansPro-ExtraLight.ttf",IFFont.Category.Serif),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.ExtraLight,"font/SourceSansPro-ExtraLightIt.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.Light,"font/SourceSansPro-Light.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.Light,"font/SourceSansPro-LightIt.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.Regular,"font/SourceSansPro-Regular.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.Regular,"font/SourceSansPro-It.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.SemiBold,"font/SourceSansPro-Semibold.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.SemiBold,"font/SourceSansPro-SemiboldIt.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.Bold,"font/SourceSansPro-Bold.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.Bold,"font/SourceSansPro-BoldIt.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Normal,IFFont.Weight.Heavy,"font/SourceSansPro-Black.ttf"),ifFont.addType("Source Sans Pro",IFFont.Style.Italic,IFFont.Weight.Heavy,"font/SourceSansPro-BlackIt.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.ExtraLight,"font/SourceCodePro-ExtraLight.ttf",IFFont.Category.Monospace),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.Light,"font/SourceCodePro-Light.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.Regular,"font/SourceCodePro-Regular.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.Medium,"font/SourceCodePro-Medium.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.SemiBold,"font/SourceCodePro-Semibold.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.Bold,"font/SourceCodePro-Bold.ttf"),ifFont.addType("Source Code Pro",IFFont.Style.Normal,IFFont.Weight.Heavy,"font/SourceCodePro-Black.ttf"),ifFont.addType("FontAwesome",IFFont.Style.Normal,IFFont.Weight.Regular,gShell.isDevelopment()?"../bower_components/font-awesome/fonts/fontawesome-webfont.ttf":"font/fontawesome-webfont.ttf",IFFont.Category.Iconic)}),$(window).load(function(){rangy.init()}),ifLocale.setValues(GApplication,IFLocale.Language.English,["category.file","category.edit","category.modify","category.modify.arrange","category.modify.align","category.modify.transform","category.modify.page","category.modify.layer","category.arrange","category.arrange.transform","category.view","category.view.magnification","category.help","tool-category.select","tool-category.image","tool-category.vector","tool-category.other","tool-category.color","tool-category.view"],["File","Edit","Modify","Modify/Arrange","Modify/Align","Modify/Transform","Modify/Page","Modify/Layer","Arrange","Arrange/Transform","View","View/Magnification","Help","Select","Image","Vector","Other","Color","View"]),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.add-layer",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_LAYER},b.prototype.getGroup=function(){return"structure/modify"},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){var a=gApp.getActiveDocument().getScene(),b=a.getActivePage();IFEditor.tryRunTransaction(b,function(){var c=new IFLayer;c.setProperty("name","Layer "+a.queryCount("layer").toString()),b.appendChild(c),a.setActiveLayer(c)},ifLocale.get(this.getTitle()))},b.prototype.toString=function(){return"[Object GAddLayerAction]"},a.GAddLayerAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.delete-layer",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_LAYER},b.prototype.getGroup=function(){return"structure/modify"},b.prototype.isEnabled=function(a){return a||(a=gApp.getActiveDocument()?gApp.getActiveDocument().getScene().getActiveLayer():null),!!a},b.prototype.execute=function(a){var a=a||gApp.getActiveDocument().getScene().getActiveLayer(),b=a.getScene();if(!b)throw new Error("No scene on layer.");for(var c=null,d=a.getPrevious();null!==d;d=d.getPrevious())if(d instanceof IFLayer){c=d;break}if(!c)for(var d=a.getNext();null!==d;d=d.getNext())if(d instanceof IFLayer){c=d;break}return!c&&a.getParent()instanceof IFLayer&&(c=a.getParent()),c?(a.hasFlag(IFNode.Flag.Active)&&b.setActiveLayer(c),void IFEditor.tryRunTransaction(b,function(){a.getParent().removeChild(a)},ifLocale.get(this.getTitle()))):void vex.dialog.alert("Unable to delete - the page needs to contain at least one layer.")},b.prototype.toString=function(){return"[Object GDeleteLayerAction]"},a.GDeleteLayerAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.add-page",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_PAGE},b.prototype.getGroup=function(){return"structure/modify"},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){gApp.getActiveDocument().createNewPage()},b.prototype.toString=function(){return"[Object GAddPageAction]"},a.GAddPageAction=b}(this),function(a){function b(a){this._type=a,this._title=new IFLocale.Key(b,"title."+a)}IFObject.inherit(b,GAction),b.Type={AlignLeft:"align-left",AlignCenter:"align-center",AlignRight:"align-right",AlignTop:"align-top",AlignMiddle:"align-middle",AlignBottom:"align-bottom",AlignJustifyHorizontal:"align-justify-horizontal",AlignJustifyVertical:"align-justify-vertical"},b.ID="arrange.align",b.prototype._type=null,b.prototype._title=null,b.prototype.getId=function(){return b.ID+"."+this._type},b.prototype.getTitle=function(){return this._title},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_ALIGN},b.prototype.getGroup=function(){var a="";switch(this._type){case b.Type.AlignLeft:case b.Type.AlignCenter:case b.Type.AlignRight:case b.Type.AlignJustifyHorizontal:a="horizontal";break;case b.Type.AlignTop:case b.Type.AlignMiddle:case b.Type.AlignBottom:case b.Type.AlignJustifyVertical:a="vertical"}return"arrange/align-"+a},b.prototype.getShortcut=function(){return null},b.prototype.isEnabled=function(a,b,c,d){return a=a||(gApp.getActiveDocument()?gApp.getActiveDocument().getEditor().getSelection():null),a?d?a.length>0:a.length>1:!1},b.prototype.execute=function(a,c,d,e){var f=gApp.getActiveDocument(),g=f.getScene();a||(a=f.getEditor().getSelection());for(var h=a,a=[],i=null,j=0;j<h.length;++j){var k=h[j];if(k.hasMixin(IFElement.Transform)){var l=d?k.getGeometryBBox():k.getPaintBBox();if(!l||l.isEmpty())continue;i=i?i.united(l):l,a.push({bbox:l,element:k})}}if(!e)for(var j=0;j<a.length;++j){var l=a[j].element.getPaintBBox();l&&!l.isEmpty()&&(e=e?e.united(l):l)}e&&!e.isEmpty()&&IFEditor.tryRunTransaction(g,function(){for(var d=0;d<a.length;++d){var f=c?i:a[d].bbox,g=a[d].element,h=IFElementEditor.getEditor(g);switch(this._type){case b.Type.AlignLeft:h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignLeft,e.getX(),null):e.getX()!==f.getX()&&g.transform(new IFTransform(1,0,0,1,e.getX()-f.getX(),0));break;case b.Type.AlignCenter:var j=e.getX()+e.getWidth()/2;h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignCenter,j,null):j!==f.getX()+f.getWidth()/2&&g.transform(new IFTransform(1,0,0,1,j-f.getX()-f.getWidth()/2,0));break;case b.Type.AlignRight:var k=e.getX()+e.getWidth();h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignRight,k,null):k!==f.getX()+f.getWidth()&&g.transform(new IFTransform(1,0,0,1,k-f.getWidth()-f.getX(),0));break;case b.Type.AlignTop:h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignTop,null,e.getY()):e.getY()!==f.getY()&&g.transform(new IFTransform(1,0,0,1,0,e.getY()-f.getY()));break;case b.Type.AlignMiddle:var j=e.getY()+e.getHeight()/2;h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignMiddle,null,j):j!==f.getY()+f.getHeight()/2&&g.transform(new IFTransform(1,0,0,1,0,j-f.getY()-f.getHeight()/2));break;case b.Type.AlignBottom:var l=e.getY()+e.getHeight();h&&h.isAlignPartsAllowed()?h.alignParts(b.Type.AlignBottom,null,l):l!==f.getY()+f.getHeight()&&g.transform(new IFTransform(1,0,0,1,0,l-f.getHeight()-f.getY()));break;case b.Type.AlignJustifyHorizontal:(e.getX()!==f.getX()||f.getWidth()!==e.getWidth())&&g.transform(new IFTransform(1,0,0,1,0,0).translated(-f.getX(),-f.getY()).scaled(e.getWidth()/f.getWidth(),1).translated(f.getX(),f.getY()).translated(e.getX()-f.getX(),0));break;case b.Type.AlignJustifyVertical:(e.getY()!==f.getY()||f.getHeight()!==e.getHeight())&&g.transform(new IFTransform(1,0,0,1,0,0).translated(-f.getX(),-f.getY()).scaled(1,e.getHeight()/f.getHeight()).translated(f.getX(),f.getY()).translated(0,e.getY()-f.getY()))}}}.bind(this),ifLocale.get(this.getTitle()))},b.prototype.toString=function(){return"[Object GAlignAction]"},a.GAlignAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.clone",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"selection"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"D"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();return a&&null!=a.getEditor().getSelection()},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor();a.beginTransaction();try{a.cloneSelection()}finally{a.commitTransaction(ifLocale.get(this.getTitle()))}},b.prototype.toString=function(){return"[Object GCloneAction]"},a.GCloneAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.converttopath",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY},b.prototype.getGroup=function(){return"structure-convert"},b.prototype.getShortcut=function(){return[]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();if(a){var b=a.getEditor().getSelection();if(b)for(var c=0;c<b.length;++c)if(b[c]instanceof IFPathBase&&!(b[c]instanceof IFPath)||b[c].hasMixin(IFVertexSource))return!0}return!1},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor();a.convertSelectionToPaths()},b.prototype.toString=function(){return"[Object GConvertToPathAction]"},a.GConvertToPathAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.close",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"close"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"Q"]},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.execute=function(){gApp.getWindows().closeWindow(gApp.getWindows().getActiveWindow())},b.prototype.toString=function(){return"[Object GCloseAction]"},a.GCloseAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.close-all",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"close"},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){for(;gApp.getActiveDocument();)gApp.closeDocument(gApp.getActiveDocument())},b.prototype.toString=function(){return"[Object GCloseAllAction]"},a.GCloseAllAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.copy",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"ccp"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"C"]},b.prototype.isEnabled=function(){return document.activeElement&&$(document.activeElement).is(":editable")?!0:gApp.getActiveDocument()&&gApp.getActiveDocument().getEditor().getSelection()?!0:!1},b.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))document.execCommand("copy");else{var a=IFNode.order(gApp.getActiveDocument().getEditor().getSelectionCopy()),b=IFNode.serialize(a);gShell.setClipboardContent(IFNode.MIME_TYPE,b)}},b.prototype.toString=function(){return"[Object GCopyAction]"},a.GCopyAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.cut",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"ccp"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"X"]},b.prototype.isEnabled=function(){return document.activeElement&&$(document.activeElement).is(":editable")?!0:gApp.getActiveDocument()&&gApp.getActiveDocument().getEditor().getSelection()?!0:!1
},b.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))document.execCommand("cut");else{var a=gApp.getActiveDocument().getEditor();gApp.executeAction(GCopyAction.ID),a.beginTransaction();try{a.deleteSelection(!0)}finally{a.commitTransaction("Cut Selection")}}},b.prototype.toString=function(){return"[Object GCutAction]"},a.GCutAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.delete",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"ccp"},b.prototype.getShortcut=function(){return[IFKey.Constant.REMOVE]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();if(a){var b=a.getEditor().getSelection();if(b)for(var c=0;c<b.length;++c)if(b[c]instanceof IFItem)return!0}return!1},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor();a.deleteSelection()},b.prototype.toString=function(){return"[Object GDeleteAction]"},a.GDeleteAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.delete-page",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_PAGE},b.prototype.getGroup=function(){return"structure/modify"},b.prototype.isEnabled=function(a){return a||(a=gApp.getActiveDocument()?gApp.getActiveDocument().getScene().getActivePage():null),!!a},b.prototype.execute=function(a){var a=a||gApp.getActiveDocument().getScene().getActivePage(),b=a.getScene();if(!b)throw new Error("No scene on page.");for(var c=null,d=a.getPrevious();null!==d;d=d.getPrevious())if(d instanceof IFPage){c=d;break}if(!c)for(var d=a.getNext();null!==d;d=d.getNext())if(d instanceof IFPage){c=d;break}return c?(a.hasFlag(IFNode.Flag.Active)&&b.setActivePage(c),void IFEditor.tryRunTransaction(b,function(){a.getParent().removeChild(a)},ifLocale.get(this.getTitle()))):void vex.dialog.alert("Unable to delete - the document needs to contain at least one page.")},b.prototype.toString=function(){return"[Object GDeletePageAction]"},a.GDeletePageAction=b}(this),function(a){function b(a){this._type=a,this._title=new IFLocale.Key(b,"title."+a)}IFObject.inherit(b,GAction),b.Type={Horizontal:"horizontal",Vertical:"vertical"},b.ID="arrange.distribute",b.prototype._type=null,b.prototype._title=null,b.prototype.getId=function(){return b.ID+"."+this._type},b.prototype.getTitle=function(){return this._title},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_ALIGN},b.prototype.getGroup=function(){return"arrange/align-distribute"},b.prototype.getShortcut=function(){return null},b.prototype.isEnabled=function(a,b,c){return a=a||(gApp.getActiveDocument()?gApp.getActiveDocument().getEditor().getSelection():null),a?c?a.length>1:a.length>2:!1},b.prototype.execute=function(a,c,d,e){var f=gApp.getActiveDocument(),g=f.getScene();a||(a=f.getEditor().getSelection());for(var h=a,a=[],i=0;i<h.length;++i){var j=h[i];if(j.hasMixin(IFElement.Transform)){var k=c?j.getGeometryBBox():j.getPaintBBox();if(!k||k.isEmpty())continue;a.push({bbox:k,element:j})}}if(!d)for(var i=0;i<a.length;++i){var k=a[i].element.getPaintBBox();k&&!k.isEmpty()&&(d=d?d.united(k):k)}if(d&&!d.isEmpty())if(this._type===b.Type.Horizontal){if(a.sort(function(a,b){return a.bbox.getX()>b.bbox.getX()}),!e){for(var l=0,i=0;i<a.length;++i)l+=a[i].bbox.getWidth();e=(d.getWidth()-l)/(a.length-1)}IFEditor.tryRunTransaction(g,function(){for(var b=d.getX(),c=0;c<a.length;++c)b!==a[c].bbox.getX()&&a[c].element.transform(new IFTransform(1,0,0,1,b-a[c].bbox.getX(),0)),b+=a[c].bbox.getWidth()+e}.bind(this),ifLocale.get(this.getTitle()))}else if(this._type===b.Type.Vertical){if(a.sort(function(a,b){return a.bbox.getY()>b.bbox.getY()}),!e){for(var l=0,i=0;i<a.length;++i)l+=a[i].bbox.getHeight();e=(d.getHeight()-l)/(a.length-1)}IFEditor.tryRunTransaction(g,function(){for(var b=d.getY(),c=0;c<a.length;++c)b!==a[c].bbox.getY()&&a[c].element.transform(new IFTransform(1,0,0,1,0,b-a[c].bbox.getY())),b+=a[c].bbox.getHeight()+e}.bind(this),ifLocale.get(this.getTitle()))}},b.prototype.toString=function(){return"[Object GDistributeAction]"},a.GDistributeAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.duplicate",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"selection"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"D"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();return a&&null!=a.getEditor().getSelection()},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor();a.beginTransaction();try{a.cloneSelection(!0,!0)}finally{a.commitTransaction(ifLocale.get(this.getTitle()))}},b.prototype.toString=function(){return"[Object GDuplicateAction]"},a.GDuplicateAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.fit.all",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"zoom"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"O"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument(),b=a?a.getScene().getPaintBBox():null;return b&&!b.isEmpty()},b.prototype.execute=function(){var a=gApp.getActiveDocument();if(a.getScene().getProperty("singlePage")){var b=a.getScene().getActivePage();a.getActiveWindow().getView().zoomAll(b.getPaintBBox(),!1)}else a.getActiveWindow().getView().zoomAll(a.getScene().getPaintBBox(),!1)},b.prototype.toString=function(){return"[Object GFitAllAction]"},a.GFitAllAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.fit-current-layer",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"zoom"},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument(),b=a?a.getScene().getActiveLayer():null;return b&&b.getPaintBBox()&&!b.getPaintBBox().isEmpty()},b.prototype.execute=function(){var a=gApp.getActiveDocument(),b=a.getScene().getActiveLayer();a.getActiveWindow().getView().zoomAll(b.getPaintBBox(),!1)},b.prototype.toString=function(){return"[Object GFitCurrentLayerAction]"},a.GFitCurrentLayerAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.fit-current-page",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"zoom"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,IFKey.Constant.SHIFT,"W"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument(),b=a?a.getScene().getActivePage():null;return b&&b.getPaintBBox()&&!b.getPaintBBox().isEmpty()},b.prototype.execute=function(){var a=gApp.getActiveDocument(),b=a.getScene().getActivePage();a.getActiveWindow().getView().zoomAll(b.getPaintBBox(),!1)},b.prototype.toString=function(){return"[Object GFitCurrentPageAction]"},a.GFitCurrentPageAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.fit-selection",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"zoom"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,IFKey.Constant.OPTION,"O"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument(),b=a?a.getEditor():null;return b&&b.hasSelection()},b.prototype.execute=function(){for(var a=gApp.getActiveDocument(),b=a?a.getEditor():null,c=b.getSelection(),d=null,e=0;e<c.length;++e){var f=c[e].getPaintBBox();f&&!f.isEmpty()&&(d=d?d.united(f):f)}d&&!d.isEmpty()&&a.getActiveWindow().getView().zoomAll(d,!1)},b.prototype.toString=function(){return"[Object GFitSelectionAction]"},a.GFitSelectionAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.group",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY},b.prototype.getGroup=function(){return"structure-group"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"G"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();if(a){var b=a.getEditor().getSelection();return b&&b.length>1}return!1},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor(),b=a.getSelection();a.beginTransaction();try{for(var c=new IFShapeSet,d=[],e=0;e<b.length;++e){var f=b[e];f.validateInsertion(c)&&d.push(f)}if(d.length>0){for(var e=0;e<d.length;++e){var f=d[e];f.getParent().removeChild(f),c.appendChild(f)}a.insertElements([c],!0,!0)}}finally{a.commitTransaction("Group")}},b.prototype.toString=function(){return"[Object GGroupAction]"},a.GGroupAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.place-image",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"insert"},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();return a&&a.isSaveable()?!0:!1},b.prototype.execute=function(){var a=gApp.getActiveDocument();a.getStorage().openResourcePrompt(a.getUrl(),["jpg","jpeg","png","gif","svg"],function(b){var c=new URI(b);b=c.relativeTo(a.getUrl()).toString();var d=c.filename(),e=c.suffix(),f=e.length>0?d.substr(0,d.length-e.length-1):d,g=a.getScene().getActivePage().getGeometryBBox().getSide(IFRect.Side.TOP_LEFT),h=new IFImage;h.setProperties(["name","url","transform"],[f,b,new IFTransform(1,0,0,1,g.getX(),g.getY())]),h.transform(),a.getEditor().insertElements([h])})},b.prototype.toString=function(){return"[Object GPlaceImageAction]"},a.GPlaceImageAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.invert-selection",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"select"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"A"]},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){var a=gApp.getActiveDocument(),b=a.getScene(),c=null;c=b.getProperty("singlePage")?b.getActivePage():b;var d=[];c.accept(function(a){a instanceof IFItem&&a.getParent()instanceof IFLayer&&!a.hasFlag(IFNode.Flag.Selected)&&d.push(a)}),a.getEditor().updateSelection(!1,d)},b.prototype.toString=function(){return"[Object GInvertSelectionAction]"},a.GInvertSelectionAction=b}(this),function(a){function b(a){this._layerType=a}IFObject.inherit(b,GAction),b.ID="modify.layer-type",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._layerType=null,b.prototype.getId=function(){return b.ID+"."+this._layerType},b.prototype.getTitle=function(){return ifLocale.get(b.TITLE).replace("%name%",ifLocale.get(IFLayer.TypeName[this._layerType]))},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_LAYER},b.prototype.getGroup=function(){return"structure/type"},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){var a=gApp.getActiveDocument()?gApp.getActiveDocument().getScene().getActiveLayer():null;return a?a.getProperty("tp")===this._layerType:!1},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){var a=gApp.getActiveDocument()?gApp.getActiveDocument().getScene().getActiveLayer():null;a&&a.setProperty("tp",this._layerType)},b.prototype.toString=function(){return"[Object GLayerTypeAction]"},a.GLayerTypeAction=b}(this),function(a){function b(a,b){this._magnification=a,this._shortcut=b}IFObject.inherit(b,GAction),b.ID="view.magnification",b.prototype._magnification=null,b.prototype._shortcut=null,b.prototype.getId=function(){return b.ID+"."+this._magnification.toString()},b.prototype.getTitle=function(){return this._magnification.toString()+"%"},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW_MAGNIFICATION},b.prototype.getGroup=function(){return"zoom/magnification-level"},b.prototype.getShortcut=function(){return this._shortcut},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView(),b=this._magnification/100,c=a.getScene(),d=null;if(c.getProperty("singlePage")){var e=c.getActivePage().getGeometryBBox();e&&!e.isEmpty()&&(d=e.getSide(IFRect.Side.CENTER))}d||(d=a.getViewTransform().mapPoint(new IFPoint(a.getWidth()/2,a.getHeight()/2))),a.zoomAt(d,b)},b.prototype.toString=function(){return"[Object GMagnificationAction]"},a.GMagnificationAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.new",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"file"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"N"]},b.prototype.execute=function(){gApp.createNewDocument()},b.prototype.toString=function(){return"[Object GNewAction]"},a.GNewAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.clone",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"view"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,IFKey.Constant.OPTION,"N"]},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.execute=function(){gApp.getWindows().addWindow(gApp.getWindows().getActiveWindow())},b.prototype.toString=function(){return"[Object GNewWindowAction]"},a.GNewWindowAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.open",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"file"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"O"]},b.prototype.isEnabled=function(){return!!this._getViableStorage()},b.prototype.execute=function(){gApp.openDocumentFrom(this._getViableStorage())},b.prototype._getViableStorage=function(){for(var a=0;a<gravit.storages.length;++a){var b=gravit.storages[a];if(b.isAvailable()&&b.isPrompting()){var c=b.getExtensions();if(!c||c.isEmpty()||c.indexOf("gravit")>=0)return b}}return null},b.prototype.toString=function(){return"[Object GOpenAction]"},a.GOpenAction=b}(this),function(a){function b(a){this._type=a,this._title=new IFLocale.Key(b,"title."+a)}IFObject.inherit(b,GAction),b.Type={SendToFront:"send-front",BringForward:"bring-forward",SendBackward:"send-backward",SendToBack:"send-back"},b.ID="arrange.order",b.prototype._type=null,b.prototype._title=null,b.prototype.getId=function(){return b.ID+"."+this._type},b.prototype.getTitle=function(){return this._title},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_ARRANGE},b.prototype.getGroup=function(){return"arrange/arrange"},b.prototype.getShortcut=function(){switch(this._type){case b.Type.SendToFront:return[IFKey.Constant.SHIFT,IFKey.Constant.META,IFKey.Constant.UP];case b.Type.BringForward:return[IFKey.Constant.META,IFKey.Constant.UP];case b.Type.SendBackward:return[IFKey.Constant.META,IFKey.Constant.DOWN];case b.Type.SendToBack:return[IFKey.Constant.SHIFT,IFKey.Constant.META,IFKey.Constant.DOWN]}return null},b.prototype.isEnabled=function(a){return a=a||(gApp.getActiveDocument()?gApp.getActiveDocument().getEditor().getSelection():null),a&&a.length>0},b.prototype.execute=function(a){var c=gApp.getActiveDocument(),d=c.getScene(),e=null;a||(e=c.getEditor().getSelection().slice(),a=e),a=IFNode.order(a,!0),IFEditor.tryRunTransaction(d,function(){for(var c=0;c<a.length;++c){var d=a[c],e=d.getParent();switch(this._type){case b.Type.SendToFront:null!==d.getNext()&&(e.removeChild(d),e.appendChild(d));break;case b.Type.BringForward:if(null!==d.getNext()){var f=d.getNext()?d.getNext().getNext():null;e.removeChild(d),e.insertChild(d,f)}break;case b.Type.SendBackward:if(null!==d.getPrevious()){var f=d.getPrevious()?d.getPrevious():e.getFirstChild();e.removeChild(d),e.insertChild(d,f)}break;case b.Type.SendToBack:null!==d.getPrevious()&&(e.removeChild(d),e.insertChild(d,e.getFirstChild()))}}}.bind(this),ifLocale.get(this.getTitle())),e&&c.getEditor().updateSelection(!1,e)},b.prototype.toString=function(){return"[Object GArrangeAction]"},a.GArrangeAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.original",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"zoom"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"0"]},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){var a=gApp.getActiveDocument(),b=a.getScene().getPaintBBox();a.getActiveWindow().getView().zoomAtCenter(b&&!b.isEmpty()?b.getSide(IFRect.Side.CENTER):new IFPoint(0,0),1)},b.prototype.toString=function(){return"[Object GOriginalViewAction]"},a.GOriginalViewAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.pixel-preview",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"render"},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){var a=gApp.getWindows().getActiveWindow();return a?a.getView().getViewConfiguration().pixelMode:!1},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView();a.getViewConfiguration().pixelMode=!a.getViewConfiguration().pixelMode,a.invalidate()},b.prototype.toString=function(){return"[Object GPixelPreviewAction]"},a.GPixelPreviewAction=b}(this),function(a){function b(a){this._paintMode=a}IFObject.inherit(b,GAction),b.ID="view.page.decoration",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._paintMode=null,b.prototype.getId=function(){return b.ID+"."+this._paintMode},b.prototype.getTitle=function(){return ifLocale.get(b.TITLE).replace("%name%",ifLocale.get(IFScenePaintConfiguration.PaintModeName[this._paintMode]))},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"paint-mode"},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){var a=gApp.getWindows().getActiveWindow();return a?a.getView().getViewConfiguration().paintMode===this._paintMode:!1},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView();a.getViewConfiguration().paintMode=this._paintMode,a.invalidate()},b.prototype.toString=function(){return"[Object GPaintModeAction]"},a.GPaintModeAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.paste",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"ccp"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"V"]},b.prototype.isEnabled=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))return!0;var a=gShell.getClipboardMimeTypes();return a&&a.indexOf(IFNode.MIME_TYPE)>=0?!!gApp.getActiveDocument():!1},b.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))document.execCommand("paste");else{var a=IFNode.deserialize(gShell.getClipboardContent(IFNode.MIME_TYPE));if(a&&a.length>0){for(var b=[],c=gApp.getActiveDocument().getEditor(),d=gApp.getActiveDocument().getScene().querySingle("page:active"),e=d.getGeometryBBox().getSide(IFRect.Side.CENTER),f=0;f<a.length;++f)if(a[f]instanceof IFElement){var g=a[f],h=g.getGeometryBBox(),i=h?h.getSide(IFRect.Side.CENTER):new IFPoint(0,0);g.transform(new IFTransform(1,0,0,1,-i.getX()+e.getX(),-i.getY()+e.getY())),b.push(g)}if(b.length>0){c.beginTransaction();try{c.insertElements(b,!0,!0)}finally{c.commitTransaction("Paste")}}}}},b.prototype.toString=function(){return"[Object GPasteAction]"},a.GPasteAction=b}(this),function(a){function b(){}IFObject.inherit(b,GPasteAction),b.ID="edit.paste.in-place",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"paste"},b.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))document.execCommand("paste");else{var a=IFNode.deserialize(gShell.getClipboardContent(IFNode.MIME_TYPE));if(a&&a.length>0){for(var b=[],c=gApp.getActiveDocument().getScene().querySingle("page:active"),d=0;d<a.length;++d)if(a[d]instanceof IFElement){var e=a[d];e.transform(new IFTransform(1,0,0,1,c.getProperty("x"),c.getProperty("y"))),b.push(e)}if(b.length>0){var f=gApp.getActiveDocument().getEditor();f.beginTransaction();try{f.insertElements(b,!0,!0)}finally{f.commitTransaction("Paste")}}}}},b.prototype.toString=function(){return"[Object GPasteInPlaceAction]"},a.GPasteInPlaceAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.paste.inside",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"paste"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"V"]},b.prototype.isEnabled=function(){var a=gShell.getClipboardMimeTypes();if(a&&a.indexOf(IFNode.MIME_TYPE)>=0){var b=gApp.getActiveDocument();if(b){var c=b.getEditor().getSelection();if(c)for(var d=0;d<c.length;++d)if(c[d].hasMixin(IFNode.Container))return!0}}return!1},b.prototype.execute=function(){var a=IFNode.deserialize(gShell.getClipboardContent(IFNode.MIME_TYPE));if(a&&a.length>0){for(var b=[],c=0;c<a.length;++c)a[c]instanceof IFElement&&b.push(a[c]);if(b.length>0){var d=gApp.getActiveDocument().getEditor(),e=d.getSelection(),f=[];d.beginTransaction();try{for(var c=0;c<e.length;++c){var g=e[c];if(g.hasMixin(IFNode.Container)){for(var h=[],i=0;i<b.length;++i)b[i].validateInsertion(g)&&h.push(b[i].clone());for(var j=IFElement.prototype.getGroupGeometryBBox(h),k=j?j.getSide(IFRect.Side.CENTER):new IFPoint(0,0),l=g instanceof IFElement?g.getGeometryBBox():null,m=l?l.getSide(IFRect.Side.CENTER):new IFPoint(0,0),i=0;i<h.length;++i)h[i].transform(new IFTransform(1,0,0,1,-k.getX()+m.getX(),-k.getY()+m.getY())),g.appendChild(h[i]),f.push(h[i])}}d.updateSelection(!1,f)}finally{d.commitTransaction("Paste Inside")}}}},b.prototype.toString=function(){return"[Object GPasteInsideAction]"},a.GPasteInsideAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.paste.style",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"paste"},b.prototype.getShortcut=function(){return[IFKey.Constant.F4]},b.prototype.isEnabled=function(){var a=gShell.getClipboardMimeTypes();if(a&&a.indexOf(IFNode.MIME_TYPE)>=0){var b=gApp.getActiveDocument();if(b){var c=b.getEditor().getSelection();if(c)for(var d=0;d<c.length;++d)if(c[d].hasMixin(IFStylable))return!0}}return!1},b.prototype.execute=function(){var a=IFNode.deserialize(gShell.getClipboardContent(IFNode.MIME_TYPE));if(a&&a.length>0){for(var b=null,c=0;c<a.length;++c)if(a[c].hasMixin(IFStylable)){b=a[c];break}var d=gApp.getActiveDocument().getEditor(),e=d.getSelection();d.beginTransaction();try{for(var c=0;c<e.length;++c){var f=e[c];f.hasMixin(IFStylable)&&f.assignStyleFrom(b)}}finally{d.commitTransaction("Paste Style")}}},b.prototype.toString=function(){return"[Object GPasteStyleAction]"},a.GPasteStyleAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.redo",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){var a=ifLocale.get(b.TITLE),c=gApp.getActiveDocument();return c&&c.getEditor().hasRedoState()&&(a+=" "+c.getEditor().getRedoStateName()),a},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"undo_redo"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"z"]},b.prototype.isEnabled=function(){return document.activeElement&&$(document.activeElement).is(":editable")?!0:gApp.getActiveDocument()&&gApp.getActiveDocument().getEditor().hasRedoState()?!0:!1},b.prototype.execute=function(){document.activeElement&&$(document.activeElement).is(":editable")?document.execCommand("redo"):gApp.getActiveDocument().getEditor().redoState()},b.prototype.toString=function(){return"[Object GRedoAction]"},a.GRedoAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.save",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"file"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"S"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();return a&&a.isSaveable()},b.prototype.execute=function(){gApp.getActiveDocument().save()},b.prototype.toString=function(){return"[Object GSaveAction]"},a.GSaveAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.save-all",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"file"},b.prototype.isEnabled=function(){for(var a=gApp.getDocuments(),b=0;b<a.length;++b)if(a[b].isSaveable())return!0;return!1},b.prototype.execute=function(){for(var a=gApp.getDocuments(),b=0;b<a.length;++b)a[b].isSaveable()&&a[b].save()},b.prototype.toString=function(){return"[Object GSaveAllAction]"},a.GSaveAllAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="file.save-as",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_FILE},b.prototype.getGroup=function(){return"file"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"S"]},b.prototype.isEnabled=function(){return!!this._getViableStorage()&&!!gApp.getActiveDocument()},b.prototype.execute=function(){gApp.saveDocumentAs(this._getViableStorage(),gApp.getActiveDocument())},b.prototype._getViableStorage=function(){for(var a=0;a<gravit.storages.length;++a){var b=gravit.storages[a];if(b.isAvailable()&&b.isPrompting()&&b.isSaving()){var c=b.getExtensions();if(!c||c.isEmpty()||c.indexOf("gravit")>=0)return b}}return null},b.prototype.toString=function(){return"[Object GSaveAsAction]"},a.GSaveAsAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.show-rulers",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"show"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,IFKey.Constant.OPTION,"R"]},b.prototype.isEnabled=function(){return!1},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){return!1},b.prototype.execute=function(){return!1},b.prototype.toString=function(){return"[Object GShowRulersAction]"},a.GShowRulersAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.select-all",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"select"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"A"]},b.prototype.isEnabled=function(){return document.activeElement&&$(document.activeElement).is(":editable")?!0:gApp.getActiveDocument()?!0:!1},b.prototype.execute=function(){if(document.activeElement&&$(document.activeElement).is(":editable"))document.execCommand("selectAll");else{var a=gApp.getActiveDocument().getEditor(),b=gApp.getActiveDocument().getScene(),c=null;c=b.getProperty("singlePage")?b.getActivePage():b;var d=[];c.accept(function(a){a instanceof IFItem&&a.getParent()instanceof IFLayer&&d.push(a)}),a.updateSelection(!1,d)}},b.prototype.toString=function(){return"[Object GSelectAllAction]"},a.GSelectAllAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.show-all-pages",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"render"},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){var a=gApp.getActiveDocument();return a?!a.getScene().getProperty("singlePage"):!1},b.prototype.isEnabled=function(){return!!gApp.getActiveDocument()},b.prototype.execute=function(){var a=gApp.getActiveDocument().getScene();a.setProperty("singlePage",!a.getProperty("singlePage"))},b.prototype.toString=function(){return"[Object GShowAllPagesAction]"},a.GShowAllPagesAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.show-grid",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW},b.prototype.getGroup=function(){return"show"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,IFKey.Constant.OPTION,"G"]},b.prototype.isEnabled=function(){return!!gApp.getWindows().getActiveWindow()},b.prototype.isCheckable=function(){return!0},b.prototype.isChecked=function(){var a=gApp.getWindows().getActiveWindow();return a?a.getView().getViewConfiguration().gridVisible===!0:!1},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView();a.getViewConfiguration().gridVisible=!a.getViewConfiguration().gridVisible,a.invalidate()},b.prototype.toString=function(){return"[Object GShowGridAction]"},a.GShowGridAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.slice-from-selection",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID
},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY},b.prototype.getGroup=function(){return"structure-convert"},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();return a?a.getEditor().hasSelection():!1},b.prototype.execute=function(){var a=gApp.getActiveDocument(),b=a.getScene(),c=a.getEditor(),d=a.getEditor().getSelectionBBox(!1);d&&!d.isEmpty()&&IFEditor.tryRunTransaction(b,function(){var a=new IFSlice;a.setProperty("trf",new IFTransform(d.getWidth()/2,0,0,d.getHeight()/2,d.getX()+d.getWidth()/2,d.getY()+d.getHeight()/2)),b.getActiveLayer().appendChild(a),c.updateSelection(!1,[a])},ifLocale.get(this.getTitle()))},b.prototype.toString=function(){return"[Object GSliceFromSelectionAction]"},a.GSliceFromSelectionAction=b}(this),function(a){function b(a){this._type=a,this._title=new IFLocale.Key(b,"title."+a)}IFObject.inherit(b,GAction),b.Type={FullUnit:"full",HalfUnit:"half"},b.ID="arrange.snap-unit",b.prototype._type=null,b.prototype._title=null,b.prototype.getId=function(){return b.ID+"."+this._type},b.prototype.getTitle=function(){return this._title},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_ALIGN},b.prototype.getGroup=function(){return"arrange/snap-unit"},b.prototype.getShortcut=function(){return null},b.prototype.isEnabled=function(a){return a=a||(gApp.getActiveDocument()?gApp.getActiveDocument().getEditor().getSelection():null),a&&a.length>0},b.prototype.execute=function(a){var c=gApp.getActiveDocument(),d=c.getScene();a||(a=c.getEditor().getSelection()),IFEditor.tryRunTransaction(d,function(){for(var c=0;c<a.length;++c){var d=a[c];if(d.hasMixin(IFElement.Transform)){var e=d.getGeometryBBox();if(e&&!e.isEmpty()){var f=IFMath.round(e.getX(),!0),g=IFMath.round(e.getY(),!0),h=IFMath.round(e.getWidth(),!0),i=IFMath.round(e.getHeight(),!0);this._type===b.Type.HalfUnit&&(f+=.5,g+=.5,h+=.5,i+=.5);var j=(new IFTransform).translated(-e.getX(),-e.getY()).scaled(h/e.getWidth(),i/e.getHeight()).translated(e.getX(),e.getY()).translated(f-e.getX(),g-e.getY());d.transform(j)}}}}.bind(this),ifLocale.get(this.getTitle()))},b.prototype.toString=function(){return"[Object GSnapUnitAction]"},a.GSnapUnitAction=b}(this),function(a){function b(a){this._type=a,this._title=new IFLocale.Key(b,"title."+a)}IFObject.inherit(b,GAction),b.Type={Rotate45Left:"rotate-45-left",Rotate90Left:"rotate-90-left",Rotate180Left:"rotate-180-left",Rotate45Right:"rotate-45-right",Rotate90Right:"rotate-90-right",Rotate180Right:"rotate-180-right",FlipVertical:"flip-vertical",FlipHorizontal:"flip-horizontal"},b.ID="arrange.transform",b.prototype._type=null,b.prototype._title=null,b.prototype.getId=function(){return b.ID+"."+this._type},b.prototype.getTitle=function(){return this._title},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY_TRANSFORM},b.prototype.getGroup=function(){var a="";switch(this._type){case b.Type.Rotate45Left:case b.Type.Rotate90Left:case b.Type.Rotate180Left:a="rotate-left";break;case b.Type.Rotate45Right:case b.Type.Rotate90Right:case b.Type.Rotate180Right:a="rotate-right";break;case b.Type.FlipVertical:case b.Type.FlipHorizontal:a="flip"}return"arrange/transform-"+a},b.prototype.getShortcut=function(){return null},b.prototype.isEnabled=function(a){return a=a||(gApp.getActiveDocument()?gApp.getActiveDocument().getEditor().getSelection():null),a&&a.length>0},b.prototype.execute=function(a){var c=gApp.getActiveDocument(),d=c.getScene();a||(a=c.getEditor().getSelection()),IFEditor.tryRunTransaction(d,function(){for(var c=0;c<a.length;++c){var d=a[c],e=d.getGeometryBBox();if(d.hasMixin(IFElement.Transform)&&e&&!e.isEmpty()){var f=e.getSide(IFRect.Side.CENTER),g=0,h=1,i=1;switch(this._type){case b.Type.Rotate45Left:g=-45;break;case b.Type.Rotate90Left:g=-90;break;case b.Type.Rotate180Left:g=-180;break;case b.Type.Rotate45Right:g=45;break;case b.Type.Rotate90Right:g=90;break;case b.Type.Rotate180Right:g=180;break;case b.Type.FlipVertical:i=-1;break;case b.Type.FlipHorizontal:h=-1}var j=(new IFTransform).translated(-f.getX(),-f.getY()).scaled(h,i).rotated(IFMath.toRadians(g)).translated(f.getX(),f.getY());d.transform(j)}}}.bind(this),ifLocale.get(this.getTitle()))},b.prototype.toString=function(){return"[Object GTransformAction]"},a.GTransformAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="edit.undo",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){var a=ifLocale.get(b.TITLE),c=gApp.getActiveDocument();return c&&c.getEditor().hasUndoState()&&(a+=" "+c.getEditor().getUndoStateName()),a},b.prototype.getCategory=function(){return GApplication.CATEGORY_EDIT},b.prototype.getGroup=function(){return"undo_redo"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"z"]},b.prototype.isEnabled=function(){return document.activeElement&&$(document.activeElement).is(":editable")?!0:gApp.getActiveDocument()&&gApp.getActiveDocument().getEditor().hasUndoState()?!0:!1},b.prototype.execute=function(){document.activeElement&&$(document.activeElement).is(":editable")&&!$(document.activeElement).is(":button")?document.execCommand("undo"):gApp.getActiveDocument().getEditor().undoState()},b.prototype.toString=function(){return"[Object GUndoAction]"},a.GUndoAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="modify.ungroup",b.TITLE=new IFLocale.Key(b,"title"),b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_MODIFY},b.prototype.getGroup=function(){return"structure-group"},b.prototype.getShortcut=function(){return[IFKey.Constant.SHIFT,IFKey.Constant.META,"G"]},b.prototype.isEnabled=function(){var a=gApp.getActiveDocument();if(a){var b=a.getEditor().getSelection();if(b)for(var c=0;c<b.length;++c)if(b[c]instanceof IFShapeSet)return!0}return!1},b.prototype.execute=function(){var a=gApp.getActiveDocument().getEditor(),b=a.getSelection();a.beginTransaction();try{for(var c=[],d=0;d<b.length;++d){var e=b[d];if(e instanceof IFShapeSet){var f=e.getParent(),g=e.getNext(),h=e.getChildren();f.removeChild(e);for(var i=0;i<h.length;++i){var j=h[i];e.removeChild(j),f.insertChild(j,g),c.push(j)}}}c.length>0&&a.updateSelection(!1,c)}finally{a.commitTransaction("Ungroup")}},b.prototype.toString=function(){return"[Object GUngroupAction]"},a.GUngroupAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="view.zoom.in",b.TITLE=new IFLocale.Key(b,"title"),b.ZOOM_STEP=2,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW_MAGNIFICATION},b.prototype.getGroup=function(){return"zoom/magnification"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"+"]},b.prototype.isEnabled=function(){var a=gApp.getWindows().getActiveWindow(),b=a?a.getView():null;return b&&b.getZoom()<IFView.options.maxZoomFactor},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView(),c=a.getZoom()*b.ZOOM_STEP,d=a.getScene(),e=null;if(d.getProperty("singlePage")){var f=d.getActivePage().getGeometryBBox();f&&!f.isEmpty()&&(e=f.getSide(IFRect.Side.CENTER))}e||(e=a.getViewTransform().mapPoint(new IFPoint(a.getWidth()/2,a.getHeight()/2))),a.zoomAt(e,c)},b.prototype.toString=function(){return"[Object GZoomInAction]"},a.GZoomInAction=b}(this),function(a){function b(){}IFObject.inherit(b,GAction),b.ID="zoom.out",b.TITLE=new IFLocale.Key(b,"title"),b.ZOOM_STEP=2,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getCategory=function(){return GApplication.CATEGORY_VIEW_MAGNIFICATION},b.prototype.getGroup=function(){return"zoom/magnification"},b.prototype.getShortcut=function(){return[IFKey.Constant.META,"-"]},b.prototype.isEnabled=function(){var a=gApp.getWindows().getActiveWindow(),b=a?a.getView():null;return b&&b.getZoom()>IFView.options.minZoomFactor},b.prototype.execute=function(){var a=gApp.getWindows().getActiveWindow().getView(),c=a.getZoom()/b.ZOOM_STEP,d=a.getScene(),e=null;if(d.getProperty("singlePage")){var f=d.getActivePage().getGeometryBBox();f&&!f.isEmpty()&&(e=f.getSide(IFRect.Side.CENTER))}e||(e=a.getViewTransform().mapPoint(new IFPoint(a.getWidth()/2,a.getHeight()/2))),a.zoomAt(e,c)},b.prototype.toString=function(){return"[Object GZoomOutAction]"},a.GZoomOutAction=b}(this),function(a){function b(a){this._style=a}b.prototype._style=null,b.prototype.open=function(a){var b=this._style.getProperty("ps"),c=function(a){var c="";switch(a){case IFStylable.PropertySet.Style:c="Style Settings";break;case IFStylable.PropertySet.Effects:c="Effects";break;case IFStylable.PropertySet.Fill:c="Fill";break;case IFStylable.PropertySet.Border:c="Border";break;case IFStylable.PropertySet.Text:c="Text";break;case IFStylable.PropertySet.Paragraph:c="Paragraph"}return $("<label></label>").css({display:"inline-block",width:"100px"}).append($("<input>").attr("type","checkbox").attr("data-property-set",a).prop("checked",b.indexOf(a)>=0)).append($("<span></span>").text(c))},d=$("<table></table>").addClass("g-form").css({}).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Style Name:")).append($("<td></td>").append($("<input>").attr("data-property","name").css("width","100%").val(this._style.getProperty("name"))))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Properties:")).append($("<td></td>").append(c(IFStylable.PropertySet.Style)).append(c(IFStylable.PropertySet.Effects)).append("<br/>").append(c(IFStylable.PropertySet.Fill)).append(c(IFStylable.PropertySet.Border)).append("<br/>").append(c(IFStylable.PropertySet.Text)).append(c(IFStylable.PropertySet.Paragraph))));vex.dialog.open({input:d,message:"",callback:function(b){var c=function(){var a=[];for(var b in IFStylable.PropertySet){var c=IFStylable.PropertySet[b];d.find('[data-property-set="'+c+'"]').is(":checked")&&a.push(c)}this._style.setProperties(["name","ps"],[d.find('[data-property="name"]').val(),a])}.bind(this);a&&a(!!b,c)}.bind(this)})},a.GStyleDialog=b}(this),function(a){function b(){GExporter.call(this)}IFObject.inherit(b,GExporter),b.prototype.isStandalone=function(){return!1},b.prototype.getName=function(){return"Raster Image"},b.prototype.getExtensions=function(){return["png","jpg"]},b.prototype.exportPart=function(a,b,c,d,e){var b=GExporter.parseSize(b),f=a.toBitmap(b.width,b.height?b.height:b.width,2);f&&f.toImageBuffer(this._getImageTypeByExt(e),function(a){c.save(d,a,!0)})},b.prototype._getImageTypeByExt=function(a){if("png"===a)return IFBitmap.ImageType.PNG;if("jpg"===a)return IFBitmap.ImageType.JPEG;throw new Error("Unknown image extension - "+a)},a.GImageExporter=b}(this),function(a){function b(){GPalette.call(this)}IFObject.inherit(b,GPalette),b.ID="align",b.TITLE=new IFLocale.Key(b,"title"),b._AlignTo={Selection:"selection",Layer:"layer",Page:"page",PageMargins:"page-margins",FirstElement:"first-element",LastElement:"last-element"},b.prototype._htmlElement=null,b.prototype._document=null,b.prototype._elements=null,b.prototype._savedAlignTo=b._AlignTo.Selection,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"modify"},b.prototype.isEnabled=function(){return null!==this._document&&this._elements&&this._elements.length>0},b.prototype.init=function(a,c){GPalette.prototype.init.call(this,a,c),this._htmlElement=a,a.css("height","115px").append($("<div></div>").css({position:"absolute",top:"5px",left:"5px"}).append($("<button></button>").attr("title","Align Left").attr("data-align",GAlignAction.Type.AlignLeft).append($("<span></span>").addClass("fa fa-align-left"))).append($("<button></button>").attr("title","Align Center").attr("data-align",GAlignAction.Type.AlignCenter).append($("<span></span>").addClass("fa fa-align-center"))).append($("<button></button>").attr("title","Align Right").attr("data-align",GAlignAction.Type.AlignRight).append($("<span></span>").addClass("fa fa-align-right"))).append($("<button></button>").attr("title","Justify Horizontal").attr("data-align",GAlignAction.Type.AlignJustifyHorizontal).append($("<span></span>").addClass("fa fa-align-justify fa-rotate-270"))).append($("<button></button>").css("margin-left","10px").attr("title","Distribute Horizontal").attr("data-dist",GDistributeAction.Type.Horizontal).append($("<span></span>").addClass("fa fa-reorder fa-rotate-270"))).append($("<input>").attr("title","Horizontal Spacing, zero will auto-space").attr("data-dist",GDistributeAction.Type.Horizontal).css("width","38px").val("0"))).append($("<div></div>").css({position:"absolute",top:"30px",left:"5px"}).append($("<button></button>").attr("title","Align Top").attr("data-align",GAlignAction.Type.AlignTop).append($("<span></span>").addClass("fa fa-align-right fa-rotate-270"))).append($("<button></button>").attr("title","Align Middle").attr("data-align",GAlignAction.Type.AlignMiddle).append($("<span></span>").addClass("fa fa-align-center fa-rotate-270"))).append($("<button></button>").attr("title","Align Bottom").attr("data-align",GAlignAction.Type.AlignBottom).append($("<span></span>").addClass("fa fa-align-left fa-rotate-270"))).append($("<button></button>").attr("title","Justify Vertical").attr("data-align",GAlignAction.Type.AlignJustifyVertical).append($("<span></span>").addClass("fa fa-align-justify"))).append($("<button></button>").css("margin-left","10px").attr("title","Distribute Vertical").attr("data-dist",GDistributeAction.Type.Vertical).append($("<span></span>").addClass("fa fa-reorder"))).append($("<input>").attr("title","Vertical Spacing, zero will auto-space").attr("data-dist",GDistributeAction.Type.Vertical).css("width","38px").val("0"))).append($("<label></label>").css({position:"absolute",top:"65px",right:"5px"}).text("Use Geometry:").append($("<input>").attr("type","checkbox").attr("data-align-geometry","").prop("checked",!0))).append($("<label></label>").css({position:"absolute",top:"65px",left:"5px"}).text("Align To:").append($("<select></select>").css({width:"90px",position:"absolute",top:"24px",left:"0px"}).attr("data-option","align-to").append($("<option></option>").attr("value",b._AlignTo.Selection).text("Selection")).append($("<option></option>").attr("value",b._AlignTo.Layer).text("Layer")).append($("<option></option>").attr("value",b._AlignTo.Page).text("Page")).append($("<option></option>").attr("value",b._AlignTo.PageMargins).text("Page Margins")).append($("<option></option>").attr("value",b._AlignTo.FirstElement).text("First Element")).append($("<option></option>").attr("value",b._AlignTo.LastElement).text("Last Element")).on("change",function(a){this._savedAlignTo=$(a.target).val(),this._updateStates()}.bind(this)))).append($("<label></label>").css({position:"absolute",top:"89px",right:"5px"}).text("Align Selection:").append($("<input>").attr("type","checkbox").attr("data-align-selection","").prop("checked",!0)));var d=function(a){this._executeAction($(a.target).closest("button").attr("data-align"),"align")}.bind(this),e=function(a){this._executeAction($(a.target).closest("button").attr("data-dist"),"dist")}.bind(this);a.find("button[data-align]").each(function(a,b){$(b).on("click",d)}),a.find("button[data-dist]").each(function(a,b){$(b).on("click",e)}),a.find("input[data-dist]").each(function(a,b){$(b).on("keyup",function(a){13===a.keyCode&&e.call(this,a)})})},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getEditor();b.addEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._updateFromSelection(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getEditor();b.removeEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._document=null,this._elements=null,this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._updateFromSelection=function(){this._elements=null;var a=this._document.getEditor().getSelection();if(a)for(var c=0;c<a.length;++c)a[c].hasMixin(IFElement.Transform)&&(this._elements||(this._elements=[]),this._elements.push(a[c]));this._htmlElement.find('select[data-option="align-to"]').val(this._elements&&1===this._elements.length?b._AlignTo.Page:this._savedAlignTo),this._updateStates(),this.trigger(GPalette.UPDATE_EVENT)},b.prototype._getActionArgs=function(a,c){var d=null,e=this._elements.slice(),f=this._document.getScene(),g=f.getActivePage(),h=f.getActiveLayer(),i=this._htmlElement.find('select[data-option="align-to"]').val();switch(i){case b._AlignTo.Layer:d=h.getPaintBBox();break;case b._AlignTo.Page:d=g.getGeometryBBox();break;case b._AlignTo.PageMargins:d=g.getGeometryBBox().expanded(-g.getProperty("ml"),-g.getProperty("mt"),-g.getProperty("mr"),-g.getProperty("mb"));break;case b._AlignTo.FirstElement:d=e[0],e.splice(0);break;case b._AlignTo.LastElement:d=e[e.length-1],e.splice(e.length-1)}if(e.length>0){var j=this._htmlElement.find("input[data-align-geometry]").is(":checked");if("align"===c){var k=i!==b._AlignTo.Selection?this._htmlElement.find("input[data-align-selection]").is(":checked"):!1;return{actionId:GAlignAction.ID+"."+a,actionParams:[e,k,j,d]}}if("dist"===c){var l=f.stringToPoint(this._htmlElement.find('input[data-dist="'+a+'"]').val())||0;return{actionId:GDistributeAction.ID+"."+a,actionParams:[e,j,d,l]}}throw new Error("Unknown align mode: "+c)}},b.prototype._executeAction=function(a,b){var c=this._getActionArgs(a,b);c&&gApp.executeAction(c.actionId,c.actionParams)},b.prototype._isActionEnabled=function(a,b){if(!this.isEnabled())return!1;var c=this._getActionArgs(a,b);return c?gApp.canExecuteAction(c.actionId,c.actionParams):!1},b.prototype._updateStates=function(){var a=this._htmlElement.find('select[data-option="align-to"]').val(),c=a!==b._AlignTo.Selection&&this._elements.length>1;this._htmlElement.find("input[data-align-selection]").prop("disabled",!c),this._htmlElement.find("[data-align]").each(function(a,b){var c=$(b);c.prop("disabled",!this._isActionEnabled(c.attr("data-align"),"align"))}.bind(this)),this._htmlElement.find("[data-dist]").each(function(a,b){var c=$(b);c.prop("disabled",!this._isActionEnabled(c.attr("data-dist"),"dist"))}.bind(this))},b.prototype.toString=function(){return"[Object GAlignPalette]"},a.GAlignPalette=b}(this),function(a){function b(){GPalette.call(this),this._extensions=[]}IFObject.inherit(b,GPalette),b.ID="export",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._htmlElement=null,b.prototype._controls=null,b.prototype._document=null,b.prototype._element=null,b.prototype._extensions=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"modify"},b.prototype.isEnabled=function(){return null!==this._document&&null!==this._element},b.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b);for(var c=0;c<gravit.exporters.length;++c){var d=gravit.exporters[c];if(!d.isStandalone())for(var e=d.getExtensions(),f=0;f<e.length;++f)this._extensions.push({extension:e[f].toLowerCase(),exporter:d})}this._htmlElement=a,this._controls=b,$("<button></button>").attr("data-action","add").attr("title","Add Export").on("click",function(){var a=this._element.getProperty("export",!0);a=a?a.slice():[],a.push({sz:"1x",sf:"",ex:gravit.exporters[0].getExtensions()[0]}),this._element.setProperty("export",a,!0)}.bind(this)).append($("<span></span>").addClass("fa fa-plus")).appendTo(b),$("<div></div>").addClass("title").appendTo(this._htmlElement),$("<div></div>").addClass("g-list export-table").appendTo(this._htmlElement),$("<div></div>").addClass("controls").attr("data-action","export-all").append($("<button></button>").on("click",function(){var a=gApp.getMatchingStorage(!0,!0,null,!0,this._document.getStorage());a&&a.openDirectoryPrompt(this._document.getUrl(),function(b){for(var c=this._element.getProperty("export",!0),d=0;d<c.length;++d){var e=c[d],f=new URI(b).filename(this._element.getLabel()+e.sf+"."+e.ex).toString();this._getExporterByExt(e.ex).exportPart(this._element,e.sz,a,f,e.ex)}}.bind(this))}.bind(this)).append($("<span></span>").text("Export All..."))).appendTo(this._htmlElement)},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene(),c=this._document.getEditor();b.addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),c.addEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._updateFromSelection()}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene(),c=this._document.getEditor();b.removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),c.removeEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._document=null,this._element=null,this._updateExports(),this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._afterPropertiesChange=function(a){a.node===this._element&&(a.properties.indexOf("export")>=0||a.properties.indexOf("name")>=0)&&this._updateExports()},b.prototype._updateFromSelection=function(){this._element=null;var a=this._document?this._document.getEditor().getSelection():null;a&&1===a.length?this._element=a[0]:this._document&&(this._element=this._document.getScene().getActivePage()),this._updateExports(),this.trigger(GPalette.UPDATE_EVENT)},b.prototype._updateExports=function(){var a=this._htmlElement.find(".export-table"),b=this._htmlElement.find(".title");if(a.empty(),b.text(""),this._htmlElement.find('[data-action="export-all"]').prop("disabled",!this._element),this._element){var c=this._element.getProperty("name"),d="Export "+this._element.getNodeNameTranslated();c&&""!==c.trim()&&(d+=' "'+c+'"'),d+=" as:",b.text(d);var e=function(b,c){for(var d=$("<select></select>"),e=0;e<this._extensions.length;++e){var f=this._extensions[e];$("<option></option>").text(f.extension.toUpperCase()).val(f.extension).appendTo(d)}$("<div></div>").addClass("export-row").data("export-index",e).append($("<div></div>").addClass("export-cell").append($("<input>").css("width","86px").attr("placeholder","Size").val(b.sz).on("change",function(a){b.sz=$(a.target).val()})).append($("<input>").css("width","58px").attr("placeholder","Suffix").val(b.sf).on("change",function(a){b.sf=$(a.target).val()})).append(d.val(b.ex).on("change",function(a){b.ex=$(a.target).val()}))).append($("<div></div>").addClass("export-cell").append($("<button></button>").attr("title","Export this item only").on("click",function(){var a=gApp.getMatchingStorage(!0,!0,b.ex,!1,this._document.getStorage());a&&a.saveResourcePrompt(this._document.getUrl(),this._element.getLabel()+b.sf,[b.ex],function(c){this._getExporterByExt(b.ex).exportPart(this._element,b.sz,a,c,b.ex)}.bind(this))}.bind(this)).append($("<span></span>").addClass("fa fa-external-link-square"))).append($("<button></button>").append($("<span></span>").addClass("fa fa-trash-o")).on("click",function(){var a=this._element.getProperty("export",!0).slice();a.splice(c,1),this._element.setProperty("export",a,!0)}.bind(this)))).appendTo(a)}.bind(this),f=this._element.getProperty("export",!0);if(f&&f.length>0)for(var g=0;g<f.length;++g)e(f[g],g)}this._controls.find('[data-action="add"]').prop("disabled",!this._element)},b.prototype._getExporterByExt=function(a){a=a.toLowerCase();for(var b=0;b<this._extensions.length;++b)if(this._extensions[b].extension===a)return this._extensions[b].exporter;return null},b.prototype.toString=function(){return"[Object GExportPalette]"},a.GExportPalette=b}(this),function(a){function b(){GPalette.call(this)}IFObject.inherit(b,GPalette),b.ID="layers",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._layersTree=null,b.prototype._layersTreeNodeMap=null,b.prototype._layerAddControl=null,b.prototype._layerDeleteControl=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"structure"},b.prototype.isEnabled=function(){return null!==this._document},b.prototype.isAutoSize=function(){return!0},b.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b),this._layersTree=$("<div></div>").addClass("g-list layers").tree({data:[],dragAndDrop:!0,openFolderDelay:500,closedIcon:$('<span class="fa fa-caret-right"></span>'),openedIcon:$('<span class="fa fa-caret-down"></span>'),slide:!1,selectable:!1,onIsMoveHandle:function(a){return a.is(".jqtree-title")},onCreateLi:this._createLayerTreeItem.bind(this),onCanMoveTo:this._canMoveLayerTreeNode.bind(this)}).on("tree.open",function(a){a.node.layerOrItem&&a.node.layerOrItem.setFlag(IFNode.Flag.Expanded)}.bind(this)).on("tree.close",function(a){a.node.layerOrItem&&a.node.layerOrItem.removeFlag(IFNode.Flag.Expanded)}.bind(this)).on("tree.click",this._clickLayerTreeNode.bind(this)).on("tree.move",this._moveLayerTreeNode.bind(this)).appendTo(a),this._layerAddControl=$("<button></button>").attr("title","Add Layer").on("click",function(){gApp.executeAction(GAddLayerAction.ID)}.bind(this)).append($("<span></span>").addClass("fa fa-plus")).appendTo(b),this._layerDeleteControl=$("<button></button>").attr("title","Delete Layer").on("click",function(){gApp.executeAction(GDeleteLayerAction.ID)}.bind(this)).append($("<span></span>").addClass("fa fa-trash-o")).appendTo(b)},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene();b.addEventListener(IFNode.AfterInsertEvent,this._afterNodeInsert,this),b.addEventListener(IFNode.BeforeRemoveEvent,this._beforeNodeRemove,this),b.addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),b.addEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),this._clear(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene();this._document=null,b.removeEventListener(IFNode.AfterInsertEvent,this._afterNodeInsert,this),b.removeEventListener(IFNode.BeforeRemoveEvent,this._beforeNodeRemove,this),b.removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),b.removeEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),this._clear(),this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._clear=function(){if(this._layersTree.tree("loadData",[]),this._layersTree.tree("getTree").is_open=!0,this._layersTreeNodeMap=[],this._document){var a=this._document.getScene().getActivePage();if(a)for(var b=a.getFirstChild();null!==b;b=b.getNext())b instanceof IFLayer&&this._insertLayer(b)}},b.prototype._insertLayer=function(a){var b=IFUtil.uuid(),c=a.getPrevious()?this._getLayerTreeNode(a.getPrevious()):null;if(c)this._layersTree.tree("addNodeBefore",{id:b,layerOrItem:a},c);else{var d=a.getParent(),e=!d||d instanceof IFPage?null:this._getLayerTreeNode(d),f=null;if(e)e.children&&e.children.length&&(f=e.children[0]);else{var g=this._layersTree.tree("getTree");g&&g.children&&g.children.length&&(f=g.children[0])}f?this._layersTree.tree("addNodeBefore",{id:b,layerOrItem:a},f):this._layersTree.tree("appendNode",{id:b,layerOrItem:a},e)}if(this._layersTreeNodeMap.push({node:a,treeId:b}),this._updateLayer(a),a.hasMixin(IFNode.Container))for(var h=a.getFirstChild();null!==h;h=h.getNext())(h instanceof IFLayer||h instanceof IFItem)&&this._insertLayer(h);var i=this._getLayerTreeNode(a);a instanceof IFItem&&a.hasFlag(IFNode.Flag.Selected)&&this._layersTree.tree("selectNode",i),a.hasFlag(IFNode.Flag.Expanded)&&this._layersTree.tree("openNode",i,!1)},b.prototype._updateLayer=function(a){var b=this._getLayerTreeNode(a);if(b){var c=a.getLabel();a instanceof IFLayer&&a.getProperty("tp")===IFLayer.Type.Draft&&(c="*"+c),this._layersTree.tree("updateNode",b,c)}},b.prototype._removeLayer=function(a){var b=this._getLayerTreeNode(a);b&&(this._layersTree.tree("removeNode",b),a.accept(function(a){if(a instanceof IFLayer||a instanceof IFItem)for(var b=0;b<this._layersTreeNodeMap.length;++b)if(this._layersTreeNodeMap[b].node===a){this._layersTreeNodeMap.splice(b,1);break}}.bind(this)))},b.prototype._afterNodeInsert=function(a){if(a.node instanceof IFLayer||a.node instanceof IFItem){var b=this._document.getScene().getActivePage();a.node.getPage()===b&&this._insertLayer(a.node)}},b.prototype._beforeNodeRemove=function(a){if(a.node instanceof IFLayer||a.node instanceof IFItem){this._removeLayer(a.node);var b=a.node.getParent();if(b instanceof IFLayer||b instanceof IFItem){for(var c=!1,d=b.getFirstChild();null!==d;d=d.getNext())if((d instanceof IFLayer||d instanceof IFItem)&&d!==a.node){c=!0;break}c||(b.removeFlag(IFNode.Flag.Expanded),this._updateLayer(b))}}},b.prototype._afterPropertiesChange=function(a){(a.node instanceof IFLayer||a.node instanceof IFItem)&&this._updateLayer(a.node)},b.prototype._afterFlagChange=function(a){a.node instanceof IFPage&&a.flag===IFNode.Flag.Active&&a.set?this._clear():a.node instanceof IFLayer&&(a.flag===IFNode.Flag.Active||a.flag===IFNode.Flag.Selected||a.flag===IFNode.Flag.Expanded)?this._updateLayer(a.node):a.node instanceof IFItem&&a.flag===IFNode.Flag.Selected?this._updateLayer(a.node):!(a.node instanceof IFLayer||a.node instanceof IFItem)||a.flag!==IFElement.Flag.Hidden&&a.flag!==IFElement.Flag.Locked||this._updateLayer(a.node)},b.prototype._clickLayerTreeNode=function(a){a.node.layerOrItem&&(a.node.layerOrItem instanceof IFLayer?this._document.getScene().setActiveLayer(a.node.layerOrItem):a.node.layerOrItem instanceof IFItem&&(ifPlatform.modifiers.shiftKey||!a.node.layerOrItem.hasFlag(IFNode.Flag.Selected)?this._document.getEditor().updateSelection(ifPlatform.modifiers.shiftKey,[a.node.layerOrItem]):a.node.layerOrItem.hasFlag(IFNode.Flag.Selected)&&this._document.getEditor().clearSelection([a.node.layerOrItem])))},b.prototype._createLayerTreeItem=function(a,b){if(a.layerOrItem){for(var c=a.layerOrItem,d=0,e=!1,f=!1,g=!1,h=c.getParent();null!==h&&!(h instanceof IFPage);h=h.getParent())e=h.getProperty("visible")===!1||e,f=h.getProperty("locked")===!0||f,h instanceof IFLayer&&(g=h.getProperty("otl")===!0||g),d+=1;var i=e||c.getProperty("visible")===!1,j=f||c.getProperty("locked")===!0,k=g||c instanceof IFLayer&&c.getProperty("otl"),l=b.find("div.jqtree-element"),m=l.find("> .jqtree-title");l.toggleClass("g-active",c.hasFlag(IFNode.Flag.Active)).toggleClass("g-selected",c.hasFlag(IFNode.Flag.Selected)).gAutoEdit({selector:"> .jqtree-title"}).on("submitvalue",function(a,b){b&&""!==b.trim()&&IFEditor.tryRunTransaction(c,function(){c.setProperty("name",b)},"Rename Layer/Item")});for(var n=0;d>n;++n)$("<span></span>").addClass("layer-spacer").prependTo(l);var o=null;c instanceof IFLayer?o=c.hasFlag(IFNode.Flag.Expanded)?"folder-open":"folder":c instanceof IFSlice?o="crop":c instanceof IFShape&&(c instanceof IFText?o="font":c instanceof IFImage?o="image":c instanceof IFEllipse?o="circle":c instanceof IFRectangle?o="stop":c instanceof IFPath?o="pencil":c instanceof IFPolygon&&(o="star")),o&&$("<span></span>").addClass("layer-icon fa fa-"+o).insertBefore(m),$("<span></span>").addClass("layer-lock fa fa-fw fa-"+(j?"lock":"unlock")).toggleClass("layer-default",!j).attr("title","Toggle Lock").on("click",function(a){a.stopPropagation(),f||IFEditor.tryRunTransaction(c,function(){c.setProperty("locked",!c.getProperty("locked"))},"Toggle Layer Locked")}).prependTo(l);{$("<span></span>").addClass("layer-visibility fa fa-"+(i?"eye-slash":"eye")).toggleClass("layer-default",!i).attr("title","Toggle Visibility").on("click",function(a){if(a.stopPropagation(),!e){var b=!c.getProperty("visible");b||c.removeFlag(IFNode.Flag.Highlighted),IFEditor.tryRunTransaction(c,function(){c.setProperty("visible",b)},"Toggle Layer Visibility"),b&&c.setFlag(IFNode.Flag.Highlighted)
}}).on("mouseenter",function(){c.hasFlag(IFElement.Flag.Hidden)||c.setFlag(IFNode.Flag.Highlighted)}).on("mouseleave",function(){c.hasFlag(IFElement.Flag.Hidden)||c.removeFlag(IFNode.Flag.Highlighted)}).prependTo(l)}if(c instanceof IFLayer){c.getProperty("tp")!==IFLayer.Type.Guide&&$("<span></span>").addClass("layer-outline fa fa-"+(k?"circle-o":"circle")).toggleClass("layer-default",!k).attr("title","Toggle Outline").on("click",function(a){a.stopPropagation(),e||IFEditor.tryRunTransaction(c,function(){c.setProperty("otl",!c.getProperty("otl"))},"Toggle Layer Outline")}).appendTo(l);var p=function(a,b){IFEditor.tryRunTransaction(c,function(){var a=c.getProperty("cls");c.setProperty("cls",b),c.acceptChildren(function(c){if(c instanceof IFLayer){var d=c.getProperty("cls");IFUtil.equals(d,a)&&c.setProperty("cls",b)}})},"Change Layer Color")};$("<span></span>").addClass("layer-color").gPatternTarget().gPatternTarget("types",[IFColor]).gPatternTarget("value",c.getProperty("cls")).css("background",IFPattern.asCSSBackground(c.getProperty("cls"))).on("click",function(a){a.stopPropagation();var b=$(a.target);$.gPatternPicker.open({target:b,scene:this._document.getScene(),types:[IFColor],value:b.gPatternTarget("value"),changeCallback:p})}.bind(this)).on("patternchange",p).appendTo(l)}}},b.prototype._canMoveLayerTreeNode=function(a,b,c){return null!==this._getLayerTreeNodeMoveInfo(c,a.layerOrItem,b.layerOrItem)},b.prototype._moveLayerTreeNode=function(a){a.preventDefault();var b=this._getLayerTreeNodeMoveInfo(a.move_info.position,a.move_info.moved_node.layerOrItem,a.move_info.target_node.layerOrItem);b&&IFEditor.tryRunTransaction(this._document.getScene(),function(){b.source.getParent().removeChild(b.source),b.parent.insertChild(b.source,b.before);for(var a=null,c=b.parent;null!==c&&!(c instanceof IFPage);c=c.getParent())c.setFlag(IFNode.Flag.Expanded),a=c;this._updateLayer(a)}.bind(this),"Move Layer/Item")},b.prototype._getLayerTreeNodeMoveInfo=function(a,b,c){if(c=c||this._document.getScene().getActivePage(),b&&c&&"none"!==a){var d=null,e=null;if("inside"===a?(d=c,e=null):"after"==a&&(d=c.getParent(),e=c),e===b)return null;if(b.validateInsertion(d,e))return{parent:d,before:e,source:b}}return null},b.prototype._getLayerTreeNodeId=function(a){if(this._layersTreeNodeMap)for(var b=0;b<this._layersTreeNodeMap.length;++b)if(this._layersTreeNodeMap[b].node===a)return this._layersTreeNodeMap[b].treeId},b.prototype._getLayerTreeNode=function(a){return this._layersTree.tree("getNodeById",this._getLayerTreeNodeId(a))},b.prototype.toString=function(){return"[Object GLayersPalette]"},a.GLayersPalette=b}(this),function(a){function b(a){if(d){var b=$(a).data("page");if(b&&(b!==d||ifPlatform.modifiers.shiftKey))return d.getParent()===b.getParent()}return!1}function c(){GPalette.call(this)}var d=null;IFObject.inherit(c,GPalette),c.ID="pages",c.TITLE=new IFLocale.Key(c,"title"),c.prototype._document=null,c.prototype._pagesPanel=null,c.prototype._pageAddControl=null,c.prototype._pageDeleteControl=null,c.prototype.getId=function(){return c.ID},c.prototype.getTitle=function(){return c.TITLE},c.prototype.getGroup=function(){return"structure"},c.prototype.isEnabled=function(){return null!==this._document},c.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b),this._pagesPanel=$("<div></div>").addClass("g-grid pages").appendTo(a),this._pageAddControl=$("<button></button>").attr("title","Add Page").on("click",function(){gApp.executeAction(GAddPageAction.ID)}.bind(this)).append($("<span></span>").addClass("fa fa-plus")).appendTo(b),this._pageDeleteControl=$("<button></button>").attr("title","Delete Page").on("click",function(){gApp.executeAction(GDeletePageAction.ID)}.bind(this)).append($("<span></span>").addClass("fa fa-trash-o")).appendTo(b)},c.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene();b.addEventListener(IFNode.AfterInsertEvent,this._afterNodeInsert,this),b.addEventListener(IFNode.BeforeRemoveEvent,this._beforeNodeRemove,this),b.addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),b.addEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),b.addEventListener(IFScene.ReferenceEvent,this._referenceEvent,this),this._clear(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene();this._document=null,b.removeEventListener(IFNode.AfterInsertEvent,this._afterNodeInsert,this),b.removeEventListener(IFNode.BeforeRemoveEvent,this._beforeNodeRemove,this),b.removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),b.removeEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),b.removeEventListener(IFScene.ReferenceEvent,this._referenceEvent,this),this._clear(),this.trigger(GPalette.UPDATE_EVENT)}},c.prototype._clear=function(){if(this._pagesPanel.empty(),this._document)for(var a=this._document.getScene(),b=a.getFirstChild();null!==b;b=b.getNext())b instanceof IFPage&&this._insertPage(b)},c.prototype._insertPage=function(a){var c=null;a.getNext()&&this._pagesPanel.find(".page-block").each(function(b,d){var e=$(d);return e.data("page")===a.getNext()?(c=e,!1):void 0});var e=$("<div></div>").addClass("page-block").data("page",a).attr("draggable","true").append($("<div></div>").addClass("page-visibility grid-icon grid-border").attr("title","Toggle Page Visibility").on("click",function(b){b.stopPropagation(),IFEditor.tryRunTransaction(a,function(){a.setProperty("visible",!a.getProperty("visible"))},"Toggle Page Visibility")}).append($("<span></span>").addClass("fa fa-fw"))).append($("<div></div>").addClass("page-lock grid-icon grid-border").attr("title","Toggle Page Lock").on("click",function(b){b.stopPropagation(),IFEditor.tryRunTransaction(a,function(){a.setProperty("locked",!a.getProperty("locked"))},"Toggle Page Lock")}).append($("<span></span>").addClass("fa fa-fw"))).append($("<div></div>").addClass("page-name grid-main").gAutoEdit({}).on("submitvalue",function(b,c){c&&""!==c.trim()&&IFEditor.tryRunTransaction(a,function(){a.setProperty("name",c)},"Rename Page")})).append($("<div></div>").addClass("page-master").append($("<span></span>").addClass("fa fa-fw"))).on("mousedown",function(){}).on("click",function(){a.getScene().setActivePage(a)}).on("dragstart",function(a){var c=$(this),e=a.originalEvent;e.stopPropagation(),d=c.data("page"),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain","dummy_data"),c.closest(".pages").find(".page-block").each(function(a,c){$(c).append($("<div></div>").addClass("grid-drag-overlay").on("dragenter",function(){b(this.parentNode)&&$(this).parent().addClass("g-drop")}).on("dragleave",function(){b(this.parentNode)&&$(this).parent().removeClass("g-drop")}).on("dragover",function(a){var c=a.originalEvent;b(this.parentNode)&&(c.preventDefault(),c.stopPropagation(),c.dataTransfer.dropEffect="move")}).on("drop",function(){var a=($(this),$(this.parentNode));a.removeClass("g-drop"),a.closest(".pages").find(".grid-drag-overlay").remove();var b=a.data("page");if(d&&d.getParent()===b.getParent()){var c=d.getParent(),e=c.getIndexOfChild(d),f=c.getIndexOfChild(b);IFEditor.tryRunTransaction(c,function(){if(ifPlatform.modifiers.shiftKey){var a=d.getScene().getPageInsertPosition(),g=d.clone();g.setProperties(["x","y","name"],[a.getX(),a.getY(),g.getProperty("name")+"-copy"]),c.insertChild(g,f>e?b.getNext():b)}else c.removeChild(d),c.insertChild(d,f>e?b.getNext():b)},ifPlatform.modifiers.shiftKey?"Duplicate Page":"Move Page")}}))})}).on("dragend",function(a){var b=$(this),c=a.originalEvent;c.stopPropagation(),b.closest(".pages").find(".grid-drag-overlay").remove(),d=null});c&&c.length>0?e.insertBefore(c):e.appendTo(this._pagesPanel),this._updatePage(a)},c.prototype._updatePage=function(a){var b=a.getProperty("visible"),c=a.getProperty("locked");this._pagesPanel.find(".page-block").each(function(d,e){var f=$(e);if(f.data("page")===a){f.toggleClass("g-active",a.hasFlag(IFNode.Flag.Active)),f.toggleClass("g-selected",a.hasFlag(IFNode.Flag.Selected)),f.find(".page-visibility").toggleClass("grid-icon-default",b).find("> span").toggleClass("fa-eye",b).toggleClass("fa-eye-slash",!b),f.find(".page-lock").toggleClass("grid-icon-default",!c).find("> span").toggleClass("fa-lock",c).toggleClass("fa-unlock",!c),f.find(".page-name").text(a.getProperty("name"));var g=a.getScene().linkCount(a),h=a.getMasterPage(),i="";return g&&(i="Master of "+g.toString()+" pages:",a.getScene().visitLinks(a,function(a){i+="\n"+a.getLabel()})),h&&(""!==i&&(i+="\n\n"),i+="Slave of "+h.getLabel()),f.find(".page-master").css("display",h||g>0?"":"none").find("> span").attr("title",i).toggleClass("fa-link",!!h&&0===g).toggleClass("fa-crosshairs",g>0),!1}})},c.prototype._removePage=function(a){this._pagesPanel.find(".page-block").each(function(b,c){var d=$(c);return d.data("page")===a?(d.remove(),!1):void 0})},c.prototype._afterNodeInsert=function(a){a.node instanceof IFPage&&this._insertPage(a.node)},c.prototype._beforeNodeRemove=function(a){a.node instanceof IFPage&&this._removePage(a.node)},c.prototype._afterPropertiesChange=function(a){a.node instanceof IFPage&&this._updatePage(a.node)},c.prototype._afterFlagChange=function(a){a.node instanceof IFPage&&(a.flag===IFNode.Flag.Active||a.flag===IFNode.Flag.Selected)&&this._pagesPanel.find(".page-block").each(function(b,c){var d=$(c);d.data("page")===a.node&&d.toggleClass(a.flag===IFNode.Flag.Active?"g-active":"g-selected",a.set)})},c.prototype._referenceEvent=function(a){a.reference instanceof IFPage&&this._updatePage(a.reference)},c.prototype.toString=function(){return"[Object GPagesPalette]"},a.GPagesPalette=c}(this),function(a){function b(){GPalette.call(this)}IFObject.inherit(b,GPalette),b.ID="styles",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._htmlElement=null,b.prototype._controls=null,b.prototype._document=null,b.prototype._stylePanel=null,b.prototype._styleSettingsControl=null,b.prototype._styleDeleteControl=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"assets"},b.prototype.isEnabled=function(){return null!==this._document},b.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b),this._htmlElement=a,this._controls=b,this._stylePanel=$("<div></div>").addClass("g-list styles g-style-list").gStylePanel({allowNameEdit:!0}).on("stylechange",function(a,b){this._document.getScene().getStyleCollection().acceptChildren(function(a){a.removeFlag(IFNode.Flag.Selected)}),b&&b.setFlag(IFNode.Flag.Selected),this._updateControls()}.bind(this)).appendTo(a),this._styleSettingsControl=$("<button></button>").attr("title","Edit Style Settings").on("click",function(){var a=this._stylePanel.gStylePanel("value");new GStyleDialog(a).open(function(b,c){b&&IFEditor.tryRunTransaction(a,function(){c()}.bind(this),"Change Style Settings")}.bind(this))}.bind(this)).append($("<span></span>").addClass("fa fa-cog")).appendTo(b),this._styleDeleteControl=$("<button></button>").attr("title","Delete Selected Style").on("click",function(){var a=this._stylePanel.gStylePanel("value");vex.dialog.confirm({message:"Are you sure you want to delete the selected style?",callback:function(b){b&&IFEditor.tryRunTransaction(a,function(){a.disconnectStyle(),a.getParent().removeChild(a)},"Delete Style")}.bind(this)})}.bind(this)).append($("<span></span>").addClass("fa fa-trash-o")).appendTo(b),this._updateControls()},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene();this._stylePanel.gStylePanel("attach",b.getStyleCollection()),this._stylePanel.gStylePanel("value",b.getStyleCollection().querySingle("style:selected")),this._updateControls(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene();this._document=null,this._stylePanel.gStylePanel("detach"),this._updateControls(),this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._updateControls=function(){var a=this._stylePanel.gStylePanel("value");this._styleSettingsControl.prop("disabled",!a||null!==a.getProperty("_sdf")),this._styleDeleteControl.prop("disabled",!a||null!==a.getProperty("_sdf"))},b.prototype.toString=function(){return"[Object GStylesPalette]"},a.GStylesPalette=b}(this),function(a){function b(){GPalette.call(this)}IFObject.inherit(b,GPalette),b.ID="swatches",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._document=null,b.prototype._swatchPanel=null,b.prototype._swatchDeleteControl=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"assets"},b.prototype.isEnabled=function(){return null!==this._document},b.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b),this._swatchPanel=$("<div></div>").addClass("g-list swatches").gSwatchPanel({allowNameEdit:!0,placeholder:"Drop Swatches here"}).on("swatchchange",function(a,b){this._document.getScene().getSwatchCollection().acceptChildren(function(a){a.removeFlag(IFNode.Flag.Selected)}),b&&b.setFlag(IFNode.Flag.Selected),this._updateControls()}.bind(this)).appendTo(a),this._swatchDeleteControl=$("<button></button>").attr("title","Delete Selected Swatch").attr("data-action","delete").on("click",function(){var a=this._swatchPanel.gSwatchPanel("value"),b=this._document.getEditor();b.beginTransaction();try{a.getParent().removeChild(a)}finally{b.commitTransaction("Delete Swatch")}}.bind(this)).append($("<span></span>").addClass("fa fa-trash-o")).appendTo(b),this._updateControls()},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene();this._swatchPanel.gSwatchPanel("attach",b.getSwatchCollection()),this._swatchPanel.gSwatchPanel("value",b.getSwatchCollection().querySingle("swatch:selected")),this._updateControls(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene();this._document=null,this._swatchPanel.gSwatchPanel("detach"),this._updateControls(),this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._updateControls=function(){var a=this._swatchPanel.gSwatchPanel("value");this._swatchDeleteControl.prop("disabled",!a)},b.prototype.toString=function(){return"[Object GSwatchesPalette]"},a.GSwatchesPalette=b}(this),function(a){function b(){GPalette.call(this),this._savedValues={Move:[0,0],Scale:[100,100],Rotate:[0],Skew:[0,0],Reflect:[0]}}IFObject.inherit(b,GPalette),b.ID="transform",b.TITLE=new IFLocale.Key(b,"title"),b._TransformMode={Move:{label1:{prefix:"X"},label2:{prefix:"Y"},pivot:!1,transformFunc:function(a,b,c){var d=c.stringToPoint(a)||0,e=c.stringToPoint(b)||0;return 0!==d||0!==e?function(a,b){b.transform(new IFTransform(1,0,0,1,d*a,e*a))}:null}},Scale:{label1:{prefix:"W",postfix:"%"},label2:{prefix:"H",postfix:"%"},pivot:!0,transformFunc:function(a,b){var c=parseFloat(a)/100||1,d=parseFloat(b)/100||1;return 1!==c||1!==d?function(a,b,e){b.transform((new IFTransform).translated(-e.getX(),-e.getY()).scaled(c+(c-1)*(a-1),d+(d-1)*(a-1)).translated(e.getX(),e.getY()))}:null}},Rotate:{label1:{prefix:"Angle",postfix:"°"},pivot:!0,transformFunc:function(a){var b=IFMath.toRadians(parseFloat(a))||0;return 0!==b?function(a,c,d){c.transform((new IFTransform).translated(-d.getX(),-d.getY()).rotated(-b*a).translated(d.getX(),d.getY()))}:null}},Skew:{label1:{prefix:"X",postfix:"°"},label2:{prefix:"Y",postfix:"°"},pivot:!0,transformFunc:function(a,b){var c=IFMath.toRadians(parseFloat(a))||0,d=IFMath.toRadians(parseFloat(b))||0;return(0!==c||0!==d)&&c>-IFMath.PIHALF&&d>-IFMath.PIHALF&&c<IFMath.PIHALF&&d<IFMath.PIHALF?function(a,b,e){b.transform((new IFTransform).translated(-e.getX(),-e.getY()).skewed(c*a,d*a).translated(e.getX(),e.getY()))}:null}},Reflect:{label1:{prefix:"Axis",postfix:"°"},pivot:!0,transformFunc:function(a){var b=parseFloat(a)||0;b=IFMath.toRadians(-b);var c=Math.cos(b),d=Math.sin(b);return function(a,b,e){a%2&&b.transform((new IFTransform).translated(-e.getX(),-e.getY()).multiplied(new IFTransform(c,-d,d,c,0,0)).multiplied(new IFTransform(1,0,0,-1,0,0)).multiplied(new IFTransform(c,d,-d,c,0,0)).translated(e.getX(),e.getY()))}}}},b.prototype._htmlElement=null,b.prototype._document=null,b.prototype._elements=null,b.prototype._transformMode=null,b.prototype._savedValues=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getGroup=function(){return"modify"},b.prototype.isEnabled=function(){return null!==this._document&&this._elements&&this._elements.length>0},b.prototype.init=function(a,b){GPalette.prototype.init.call(this,a,b),this._htmlElement=a,a.css("height","95px").append($("<div></div>").css({position:"absolute",top:"5px",left:"5px"}).append($("<button></button>").addClass("g-flat").attr("title","Move").attr("data-mode","Move").append($("<span></span>").addClass("fa fa-arrows"))).append($("<button></button>").addClass("g-flat").attr("title","Scale").attr("data-mode","Scale").append($("<span></span>").addClass("fa fa-expand"))).append($("<button></button>").addClass("g-flat").attr("title","Rotate").attr("data-mode","Rotate").append($("<span></span>").addClass("fa fa-rotate-right"))).append($("<button></button>").addClass("g-flat").attr("title","Skew").attr("data-mode","Skew").append($("<span></span>").addClass("fa fa-eraser"))).append($("<button></button>").addClass("g-flat").attr("title","Reflect").attr("data-mode","Reflect").append($("<span></span>").addClass("fa fa-star-half-o"))).append($("<button></button>").css("margin-left","7px").text("Apply").on("click",this._apply.bind(this)))).append($("<label></label>").attr("data-value","1").css({position:"absolute",left:"5px",top:"30px"}).append($("<span></span>").attr("data-prefix","")).append($("<input>").css({"margin-left":"3px",width:"48px"}).val("0").on("keyup",function(a){13==a.keyCode&&this._apply()}.bind(this))).append($("<span></span>").attr("data-postfix",""))).append($("<label></label>").attr("data-value","2").css({position:"absolute",left:"90px",top:"30px"}).append($("<span></span>").attr("data-prefix","")).append($("<input>").css({"margin-left":"3px",width:"48px"}).val("0").on("keyup",function(a){13==a.keyCode&&this._apply()}.bind(this))).append($("<span></span>").attr("data-postfix",""))).append($("<div></div>").attr("data-property","pivot").css({position:"absolute",top:"65px",left:"5px"}).gPivot().gPivot("value",IFRect.Side.CENTER)).append($("<label></label>").css({position:"absolute",top:"65px",right:"5px"}).text("Copies:").append($("<input>").css({"margin-left":"3px",width:"38px"}).attr("data-property","copies").val("0"))),a.find("button[data-mode]").each(function(a,b){var c=$(b);c.on("click",function(){this._setTransformMode(c.attr("data-mode"))}.bind(this))}.bind(this)),this._setTransformMode("Move")},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getEditor();b.addEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._updateFromSelection(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getEditor();b.removeEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),this._document=null,this._elements=null,this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._updateFromSelection=function(){this._elements=null;var a=this._document.getEditor().getSelection();if(a)for(var b=0;b<a.length;++b)a[b].hasMixin(IFElement.Transform)&&(this._elements||(this._elements=[]),this._elements.push(a[b]));this.trigger(GPalette.UPDATE_EVENT)},b.prototype._setTransformMode=function(a){this._transformMode&&(this._savedValues[this._transformMode]=[this._htmlElement.find('label[data-value="1"] input').val(),this._htmlElement.find('label[data-value="2"] input').val()]),this._transformMode=a,this._htmlElement.find("button[data-mode]").each(function(b,c){var d=$(c);d.toggleClass("g-active",d.attr("data-mode")===a)}.bind(this));var c=function(b,c){var d=this._htmlElement.find('label[data-value="'+c.toString()+'"]');b?(d.css("display",""),d.find("span[data-prefix]").text(b.prefix?b.prefix+":":""),d.find("span[data-postfix]").text(b.postfix?b.postfix:""),d.find("input").val(this._savedValues[a][c-1])):d.css("display","none")}.bind(this),d=b._TransformMode[a];c(d.label1,1),c(d.label2,2),this._htmlElement.find('[data-property="pivot"]').css("display",d.pivot?"":"none")},b.prototype._apply=function(){var a=this._document.getScene(),c=parseInt(this._htmlElement.find('[data-property="copies"]').val()),d=this._htmlElement.find('[data-property="pivot"]').gPivot("value"),e=this._htmlElement.find('label[data-value="1"] input').val(),f=this._htmlElement.find('label[data-value="2"] input').val(),g=b._TransformMode[this._transformMode].transformFunc(e,f,a);g&&IFEditor.tryRunTransaction(a,function(){for(var a=[],b=null,e=0;e<this._elements.length;++e){var f=this._elements[e];d&&(b=b?b.united(f.getGeometryBBox()):f.getGeometryBBox());var h=[f];if(c>0)for(var i=f.getParent(),j=f.getNext()?f.getNext():null,k=0;c>k;++k){var l=f.clone();k==c-1&&(l.setFlag(IFNode.Flag.Selected),f.removeFlag(IFNode.Flag.Selected)),i.insertChild(l,j),h.push(l)}a.push(h)}var m=null;b&&!b.isEmpty()&&(m=b.getSide(d));for(var e=0;e<a.length;++e){var h=a[e];if(h.length>1)for(var n=0;n<h.length;++n)g(n,h[n],m);else 1==h.length&&g(1,h[0],m)}}.bind(this),"Apply Transformation")},b.prototype.toString=function(){return"[Object GTransformPalette]"},a.GTransformPalette=b}(this),function(a){function b(){GPanel.call(this),this._propertyPanels=[]}IFObject.inherit(b,GPanel),b.ID="properties",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._htmlElement=null,b.prototype._propertyPanels=null,b.prototype._document=null,b.prototype._elements=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.init=function(a,b){GPanel.prototype.init.call(this,a,b),this._htmlElement=a;for(var c=$("<div></div>").addClass("properties-panels").appendTo(this._htmlElement),d=function(a){var b=$("<div></div>").css("display","none").addClass("properties-panel-content");a.init(b),b.appendTo(c),this._propertyPanels.push({panel:b,properties:a})}.bind(this),e=0;e<gravit.properties.length;++e)d(gravit.properties[e])},b.prototype.isEnabled=function(){return!!this._document},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene(),c=this._document.getEditor();c.addEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),b.addEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),this._updateFromSelection(),this.trigger(GPanel.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene(),c=this._document.getEditor();c.removeEventListener(IFEditor.SelectionChangedEvent,this._updateFromSelection,this),b.removeEventListener(IFNode.AfterFlagChangeEvent,this._afterFlagChange,this),this._document=null,this._elements=null,this._updatePropertyPanels(),this.trigger(GPanel.UPDATE_EVENT)}},b.prototype._updateFromSelection=function(){if(this._elements=this._document.getEditor().getSelection(),!this._elements||0===this._elements.length){var a=this._document.getScene().getActivePage();a&&(this._elements=[a])}this._updatePropertyPanels()},b.prototype._afterFlagChange=function(a){a.flag===IFNode.Flag.Active&&this._elements&&1===this._elements.length&&this._elements[0]instanceof IFScene&&this._updatePropertyPanels()},b.prototype._updatePropertyPanels=function(){for(var a=0;a<this._propertyPanels.length;++a){var b=this._propertyPanels[a],c=this._elements&&0!==this._elements.length?b.properties.update(this._document,this._elements):!1;c?b.panel.css("display",""):b.panel.css("display","none")}},b.prototype.toString=function(){return"[Object GPropertiesPanel]"},a.GPropertiesPanel=b}(this),function(a){function b(){this._elements=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._effectsPanel=null,b.prototype.init=function(a){this._panel=a,this._effectsPanel=$("<div></div>").css({position:"absolute",top:"5px",left:"5px",right:"5px",bottom:"5px"}).gEffectPanel(),a.css("width","175px").append(this._effectsPanel)},b.prototype.update=function(a,b){this._document&&this._effectsPanel.gEffectPanel("elements",null);for(var c=[],d=0;d<b.length;++d)b[d].hasMixin(IFStylable)&&b[d].getStylePropertySets().indexOf(IFStylable.PropertySet.Effects)>=0&&c.push(b[d]);return c.length===b.length?(this._document=a,this._effectsPanel.gEffectPanel("elements",c),!0):!1},b.prototype.toString=function(){return"[Object GEffectProperties]"},a.GEffectProperties=b}(this),function(a){function b(){this._polygons=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._polygons=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("pts"===a)return $("<input>").attr("type","text").attr("data-property","pts").on("change",function(){var c=parseInt($(this).val());if(isNaN(c))b._updateProperties();else{var d=IFMath.normalizeAngleRadians(b._polygons[0].getProperty("oa")+Math.PI/c);b._assignProperties([a,"ia"],[IFMath.normalizeValue(c,2,360),d])}});if("evenodd"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty(a,$(this).is(":checked"))});if("ir"===a||"or"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=0?b._assignProperty(a,c):b._updateProperties()});if("ia"===a||"oa"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c?(c=IFMath.normalizeAngleRadians(IFMath.toRadians(c)),b._assignProperty(a,IFMath.PI2-c)):b._updateProperties()});if("ict"===a||"oct"===a)return $("<button></button>").attr("data-property",a).gCornerTypePicker().on("cornertypechange",function(c,d){b._assignProperty(a,d)});if("icr"===a||"ocr"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=0?b._assignProperty(a,0>c?0:c):b._updateProperties()});throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","198px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).text("Points:").append(b("pts").css({"margin-left":"3px",width:"48px"}))).append($("<label></label>").css({position:"absolute",top:"5px",left:"101px"}).text("Even/odd Fill:").append(b("evenodd"))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).html('<span class="fa fa-stop" style="font-size:11px;transform:rotate(45deg)"></span>').append(b("or").css({"margin-left":"5px",width:"48px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"103px"}).html('<span class="fa fa-circle"></span>').append(b("ir").css({"margin-left":"3px",width:"48px"}))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<label></label>").css({position:"absolute",top:"65px",left:"5px"}).html('<span class="fa fa-rotate-right"></span>').append(b("oa").css({"margin-left":"5px",width:"48px"}))).append($("<label></label>").css({position:"absolute",top:"65px",left:"103px"}).html('<span class="fa fa-rotate-right" style="visibility: hidden"></span>').append(b("ia").css({"margin-left":"3px",width:"48px"}))).append($("<label></label>").css({position:"absolute",top:"90px",left:"5px"}).html('<span class="fa fa-square" style="visibility: hidden"></span>').append(b("oct").css({"margin-left":"5px"})).append(b("ocr").css("width","38px"))).append($("<label></label>").css({position:"absolute",top:"89px",left:"103px"}).html('<span class="fa fa-square" style="visibility: hidden"></span>').append(b("ict").css({"margin-left":"3px"})).append(b("icr").css("width","38px")))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._polygons=[];for(var c=0;c<b.length;++c)b[c]instanceof IFPolygon&&this._polygons.push(b[c]);return this._polygons.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._polygons.length>0&&this._polygons[0]===a.node&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._polygons[0];this._panel.find('input[data-property="pts"]').val(a.getProperty("pts")),this._panel.find('input[data-property="evenodd"]').prop("checked",a.getProperty("evenodd")),this._panel.find('input[data-property="or"]').val(this._document.getScene().pointToString(a.getProperty("or"))),this._panel.find('input[data-property="ir"]').val(this._document.getScene().pointToString(a.getProperty("ir"))),this._panel.find('input[data-property="oa"]').val(IFUtil.formatNumber(IFMath.toDegrees(IFMath.PI2-a.getProperty("oa")),2)),this._panel.find('input[data-property="ia"]').val(IFUtil.formatNumber(IFMath.toDegrees(IFMath.PI2-a.getProperty("ia")),2)),this._panel.find('button[data-property="oct"]').gCornerTypePicker("value",a.getProperty("oct")),this._panel.find('button[data-property="ict"]').gCornerTypePicker("value",a.getProperty("ict")),this._panel.find('input[data-property="ocr"]').val(this._document.getScene().pointToString(a.getProperty("ocr"))),this._panel.find('input[data-property="icr"]').val(this._document.getScene().pointToString(a.getProperty("icr")))},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._polygons.length;++d)this._polygons[d].setProperties(a,b)}finally{c.commitTransaction("Modify Polygon Properties")}},b.prototype.toString=function(){return"[Object GPolygonProperties]"},a.GPolygonProperties=b}(this),function(a){function b(){this._pathes=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._pathes=null,b.prototype._points=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("evenodd"===a||"closed"===a)return $("<input>").attr("type","checkbox").attr("data-path-property",a).on("change",function(){b._assignPathProperty(a,$(this).is(":checked"))});throw new Error("Unknown input property: "+a)}.bind(this),c=function(a){var b=this;if("x"===a||"y"===a||"cl"===a||"cr"===a)return $("<input>").attr("type","text").attr("data-point-property",a).on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=0?b._assignPointProperty(a,c):b._updatePointProperties()});if("tp"===a)return $("<select></select>").attr("data-point-property",a).append($("<option></option>").attr("value",IFPathBase.AnchorPoint.Type.Symmetric).text("Symmetric")).append($("<option></option>").attr("value",IFPathBase.AnchorPoint.Type.Asymmetric).text("Asymmetric")).append($("<option></option>").attr("value",IFPathBase.AnchorPoint.Type.Mirror).text("Mirror")).append($("<option></option>").attr("value",IFPathBase.AnchorPoint.Type.Connector).text("Connector")).append($("<option></option>").attr("value","-").text("Corner")).on("change",function(){var a=$(this).val(),c=a;"-"===a&&(c=IFPathBase.CornerType.Rounded),b._assignPointProperty("tp",c)});if("ctp"===a)return $("<button></button>").attr("data-point-property",a).gCornerTypePicker().on("cornertypechange",function(a,c){b._assignPointProperty("tp",c)
});if("ah"===a)return $("<input>").attr("type","checkbox").attr("data-point-property",a).on("change",function(){b._assignPointProperty(a,$(this).is(":checked"))});if("cu"===a)return $("<button></button>").addClass("g-flat").attr("data-point-property",a).on("click",function(){b._assignPointProperty(a,!$(this).hasClass("g-active")),b._updatePointProperties()}).append($("<span></span>").addClass("fa fa-lock").css("font-size","10px"));throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","198px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).text("Closed:").append(b("closed"))).append($("<label></label>").css({position:"absolute",top:"5px",left:"75px"}).text("Even/odd Fill:").append(b("evenodd"))).append($("<label></label>").attr("data-point-property","_row").css({position:"absolute",top:"30px",left:"5px"}).text("X:").append(c("x").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").attr("data-point-property","_row").css({position:"absolute",top:"30px",left:"65px"}).text("Y:").append(c("y").css({"margin-left":"3px",width:"38px"}))).append($("<div></div>").attr("data-point-property","_row").css({position:"absolute",top:"30px",left:"125px"}).append($("<button></button>").attr("title","Clear Left Handle").on("click",function(){this._assignPointProperties(["hlx","hly"],[null,null])}.bind(this)).append($("<span></span>").addClass("fa fa-forward"))).append($("<button></button>").attr("title","Clear Right Handle").on("click",function(){this._assignPointProperties(["hrx","hry"],[null,null])}.bind(this)).append($("<span></span>").addClass("fa fa-backward"))).append($("<button></button>").attr("title","Clear Handles").on("click",function(){this._assignPointProperties(["hlx","hly","hrx","hry"],[null,null,null,null])}.bind(this)).append($("<span></span>").addClass("fa fa-times")))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<label></label>").attr("data-point-property","_row").css({position:"absolute",top:"65px",left:"5px"}).append(c("tp").css("width","105px"))).append($("<label></label>").attr("data-point-property","_row").css({position:"absolute",top:"65px",right:"5px","text-align":"center"}).text("Auto Handles:").append("<br/>").append(c("ah"))).append($("<div></div>").attr("data-point-property","_row").css({position:"absolute",top:"89px",left:"5px"}).append(c("ctp")).append(c("cl").css("width","30px").attr("title","Left Smoothness")).append(c("cu").attr("title","Toggle Lock of Left & Right Smoothness")).append(c("cr").css("width","30px").attr("title","Right Smoothness")))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.getScene().removeEventListener(IFElement.AfterFlagChangeEvent,this._afterFlagChange),this._document=null),this._pathes=[],this._points=[];for(var c=0;c<b.length;++c)if(b[c]instanceof IFPath){var d=b[c];this._pathes.push(b[c]);for(var e=d.getAnchorPoints().getFirstChild();null!==e;e=e.getNext())e.hasFlag(IFNode.Flag.Selected)&&this._points.push(e)}return this._pathes.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(IFElement.AfterFlagChangeEvent,this._afterFlagChange,this),this._updatePathProperties(),this._updatePointProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._pathes.length>0&&this._pathes[0]===a.node&&this._updatePathProperties(),this._points.length>0&&this._points[0]===a.node&&this._updatePointProperties()},b.prototype._afterFlagChange=function(a){if(a.flag===IFNode.Flag.Selected&&a.node instanceof IFPathBase.AnchorPoint){var b=a.node.getParent().getParent();b&&this._pathes.indexOf(b)>=0&&(a.set?this._points.push(a.node):this._points.splice(this._points.indexOf(a.node),1),this._updatePointProperties())}},b.prototype._updatePathProperties=function(){var a=this._pathes[0];this._panel.find('input[data-path-property="evenodd"]').prop("checked",a.getProperty("evenodd")),this._panel.find('input[data-path-property="closed"]').prop("checked",a.getProperty("closed"))},b.prototype._updatePointProperties=function(){var a=this._points.length>0?this._points[0]:null;if(a){this._panel.find("[data-point-property]").css("visibility",""),this._panel.find('input[data-point-property="x"]').val(this._document.getScene().pointToString(a.getProperty("x"))),this._panel.find('input[data-point-property="y"]').val(this._document.getScene().pointToString(a.getProperty("y"))),this._panel.find('input[data-point-property="ah"]').prop("checked",a.getProperty("ah"));var b=!0,c=a.getProperty("tp");for(var d in IFPathBase.AnchorPoint.Type)if(IFPathBase.AnchorPoint.Type[d]===c){b=!1;break}this._panel.find('select[data-point-property="tp"]').val(b?"-":c),this._panel.find('button[data-point-property="ctp"]').prop("disabled",!b).gCornerTypePicker("value",b?c:IFPathBase.CornerType.Rounded),this._panel.find('input[data-point-property="cl"]').prop("disabled",!b).val(this._document.getScene().pointToString(a.getProperty("cl"))),this._panel.find('input[data-point-property="cr"]').prop("disabled",!b||a.getProperty("cu")).val(this._document.getScene().pointToString(a.getProperty("cr"))),this._panel.find('button[data-point-property="cu"]').prop("disabled",!b).toggleClass("g-active",a.getProperty("cu"))}else this._panel.find("[data-point-property]").css("visibility","hidden")},b.prototype._assignPathProperty=function(a,b){this._assignPathProperties([a],[b])},b.prototype._assignPathProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._pathes.length;++d)this._pathes[d].setProperties(a,b)}finally{c.commitTransaction("Modify Path Properties")}},b.prototype._assignPointProperty=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._points.length;++d){var e=this._points[d];if("x"===a){var f=b-e.getProperty("x"),g=e.getProperty("hlx")?e.getProperty("hlx")+f:null,h=e.getProperty("hrx")?e.getProperty("hrx")+f:null;e.setProperties(["x","hlx","hrx"],[b,g,h])}else if("y"===a){var i=b-e.getProperty("y"),j=e.getProperty("hly")?e.getProperty("hly")+i:null,k=e.getProperty("hry")?e.getProperty("hry")+i:null;e.setProperties(["y","hly","hry"],[b,j,k])}else e.setProperties([a],[b])}}finally{c.commitTransaction("Modify Point Properties")}},b.prototype._assignPointProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._points.length;++d)this._points[d].setProperties(a,b)}finally{c.commitTransaction("Modify Point Properties")}},b.prototype.toString=function(){return"[Object GPathProperties]"},a.GPathProperties=b}(this),function(a){function b(){this._rectangles=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._rectangles=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("uf"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty("uf",$(this).is(":checked")),b._updateCornerProperties()});if("tl_sx"===a||"tl_sy"===a||"tr_sx"===a||"tr_sy"===a||"bl_sx"===a||"bl_sy"===a||"br_sx"===a||"br_sy"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","48px").on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=0?b._assignProperty(a,c):b._updateCornerProperties()});if("tl_ct"===a||"tr_ct"===a||"bl_ct"===a||"br_ct"===a)return $("<button></butto>").attr("data-property",a).css("width","32px").gCornerTypePicker().on("cornertypechange",function(c,d){b._assignProperty(a,d)});if("tl_uf"===a||"tr_uf"===a||"bl_uf"===a||"br_uf"===a)return $("<button></button>").addClass("g-flat").css("width","32px").attr("data-property",a).on("click",function(){b._assignProperty(a,!$(this).hasClass("g-active")),b._updateCornerProperties()}).append($("<span></span>").addClass("fa fa-lock fa-fw"));throw new Error("Unknown input property: "+a)}.bind(this),c="Uniform Corner-Smoothness",d="Horizontal Corner-Smoothness",e="Vertical Corner-Smoothness",f="Corner-Type";a.css("width","180px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).text("Uniform Corners:").append(b("uf"))).append($("<div></div>").css({position:"absolute",top:"30px",left:"5px"}).append(b("tl_ct").attr("title",c)).append(b("tl_sx").attr("title",d)).append(b("tr_sx").attr("title",d)).append(b("tr_ct").attr("title",c))).append($("<div></div>").css({position:"absolute",top:"53px",left:"5px"}).append(b("tl_sy").attr("title",e)).append(b("tl_uf").attr("title",f)).append(b("tr_uf").attr("title",f)).append(b("tr_sy").attr("title",e))).append($("<div></div>").css({position:"absolute",top:"76px",left:"5px"}).append(b("bl_sy").attr("title",e)).append(b("bl_uf").attr("title",f)).append(b("br_uf").attr("title",f)).append(b("br_sy").attr("title",e))).append($("<div></div>").css({position:"absolute",top:"99px",left:"5px"}).append(b("bl_ct").attr("title",c)).append(b("bl_sx").attr("title",d)).append(b("br_sx").attr("title",d)).append(b("br_ct").attr("title",c)))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._rectangles=[];for(var c=0;c<b.length;++c)b[c]instanceof IFRectangle&&this._rectangles.push(b[c]);return this._rectangles.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._rectangles.length>0&&this._rectangles[0]===a.node&&this._updateProperties()},b.prototype._updateProperties=function(){this._updateCornerProperties()},b.prototype._updateCornerProperties=function(){var a=this._rectangles[0],b=a.getProperty("uf"),c=function(c){for(var d=0;d<c.length;++d){var e=c[d],f=this._panel.find('button[data-property="'+e+'_uf"]'),g=this._panel.find('input[data-property="'+e+'_sx"]'),h=this._panel.find('input[data-property="'+e+'_sy"]'),i=this._panel.find('button[data-property="'+e+'_ct"]'),j=b&&"tl"!==e;f.css("visibility",j?"hidden":"visible"),g.css("visibility",j?"hidden":"visible"),h.css("visibility",j?"hidden":"visible"),i.css("visibility",j?"hidden":"visible"),j||(g.val(this._document.getScene().pointToString(a.getProperty(e+"_sx"))),h.val(this._document.getScene().pointToString(a.getProperty(e+"_sy"))),a.getProperty(e+"_uf")?(f.addClass("g-active"),h.prop("disabled",!0)):(f.removeClass("g-active"),h.prop("disabled",!1)),f.prop("disabled",b),i.gCornerTypePicker("value",a.getProperty(e+"_ct")))}}.bind(this);this._panel.find('input[data-property="uf"]').prop("checked",b),c(["tl","tr","bl","br"])},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._rectangles.length;++d)this._rectangles[d].setProperties(a,b)}finally{c.commitTransaction("Modify Rectangle Properties")}},b.prototype.toString=function(){return"[Object GRectangleProperties]"},a.GRectangleProperties=b}(this),function(a){function b(){this._ellipses=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._ellipses=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("etp"===a)return $("<select></select>").attr("data-property","etp").append($("<option></option>").attr("value",IFEllipse.Type.Arc).text("Arc")).append($("<option></option>").attr("value",IFEllipse.Type.Chord).text("Chord")).append($("<option></option>").attr("value",IFEllipse.Type.Pie).text("Pie")).on("change",function(){b._assignProperty(a,$(this).val())});if("sa"===a||"ea"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c?(c=IFMath.normalizeAngleRadians(IFMath.toRadians(c)),b._assignProperty(a,IFMath.PI2-c)):b._updateProperties()});throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","127px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).append(b("etp").css("width","114px"))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).html('<span class="fa fa-stop" style="font-size:11px;transform:rotate(45deg)"></span>').append(b("sa").css({"margin-left":"5px",width:"38px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"66px"}).html('<span class="fa fa-circle"></span>').append(b("ea").css({"margin-left":"3px",width:"38px"})))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._ellipses=[];for(var c=0;c<b.length;++c)b[c]instanceof IFEllipse&&this._ellipses.push(b[c]);return this._ellipses.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._ellipses.length>0&&this._ellipses[0]===a.node&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._ellipses[0];this._panel.find('select[data-property="etp"]').val(a.getProperty("etp")),this._panel.find('input[data-property="sa"]').val(IFUtil.formatNumber(IFMath.toDegrees(IFMath.PI2-a.getProperty("sa")),2)),this._panel.find('input[data-property="ea"]').val(IFUtil.formatNumber(IFMath.toDegrees(IFMath.PI2-a.getProperty("ea")),2))},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._ellipses.length;++d)this._ellipses[d].setProperties(a,b)}finally{c.commitTransaction("Modify Ellipse Properties")}},b.prototype.toString=function(){return"[Object GEllipseProperties]"},a.GEllipseProperties=b}(this),function(a){function b(){}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._image=null,b.prototype.init=function(a){this._panel=a,a.css("width","210px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).append($("<span></span>").addClass("fa fa-image")).append($("<span></span>").css({"text-overflow":"ellipsis","padding-left":"5px"}).attr("data-property","url"))).append($("<div></div>").css({position:"absolute",top:"30px",left:"5px"}).append($("<button></button>").attr("data-action","embed").text("Embed").on("click",function(){image2Base64(this._image.getImage(),function(a){IFEditor.tryRunTransaction(this._image,function(){this._image.setProperty("url",a)}.bind(this),"Embed Image")}.bind(this))}.bind(this))).append($("<button></button>").attr("data-action","replace").text("Replace").on("click",function(){var a=this._image.getGeometryBBox().getSide(IFRect.Side.TOP_LEFT);this._document.getStorage().openResourcePrompt(this._document.getUrl(),["jpg","jpeg","png","gif"],function(b){IFEditor.tryRunTransaction(this._image,function(){this._image.setProperties(["url","trf"],[new URI(b).relativeTo(this._document.getUrl()).toString(),new IFTransform(1,0,0,1,a.getX(),a.getY())])}.bind(this),"Replace Image")}.bind(this))}.bind(this))).append($("<button></button>").attr("data-action","export").text("Export").on("click",function(){var a=gApp.getMatchingStorage(!0,!0,"png",!1,this._document.getStorage());a&&a.saveResourcePrompt(this._document.getUrl(),this._image.getLabel(),["png"],function(b){image2ArrayBuffer(this._image.getImage(),function(c){a.save(b,c,!0)})}.bind(this))}.bind(this))).append($("<button></button>").attr("data-action","reset-size").text("Reset Size").on("click",function(){var a=this._image.getGeometryBBox().getSide(IFRect.Side.TOP_LEFT);IFEditor.tryRunTransaction(this._image,function(){this._image.setProperty("trf",new IFTransform(1,0,0,1,a.getX(),a.getY()))}.bind(this),"Reset Size")}.bind(this)))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<button></button>").attr("data-image-palette","button").css({position:"absolute",top:"65px",left:"5px"}).text("Get Image Palette").on("click",this._updateImagePalette.bind(this))).append($("<div></div>").attr("data-image-palette","palette").css({position:"absolute",top:"65px",left:"5px",right:"5px",height:"27px"}))},b.prototype._updateImagePalette=function(){var a=this._image.getImage(),b=this._panel.find('[data-image-palette="palette"]');b.empty();var c=function(a){$("<div></div>").gPatternTarget({allowDrop:!1}).gPatternTarget("types",[IFColor]).gPatternTarget("value",a).css({display:"inline-block",height:"100%",width:"12.5%",background:IFPattern.asCSSBackground(a)}).appendTo(b)}.bind(this);if(a){b.css("display",""),this._panel.find('[data-image-palette="button"]').css("display","none");var d=new ColorThief,e=new IFRGBColor(d.getColor(a));c(e);for(var f=d.getPalette(a,16),g=1,h=0;h<f.length;++h){var i=new IFRGBColor(f[h]);if(!IFUtil.equals(i,e)&&(c(i),++g>=8))break}}},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().removeEventListener(IFImage.StatusEvent,this._imageStatus,this),this._document=null),this._image=null;for(var c=0;c<b.length;++c)if(b[c]instanceof IFImage){if(this._image){this._image=null;break}this._image=b[c]}return this._image?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(IFImage.StatusEvent,this._imageStatus,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._image&&this._image===a.node&&this._updateProperties()},b.prototype._imageStatus=function(a){a.image!==this._image||a.status!==IFImage.ImageStatus.Error&&a.status!==IFImage.ImageStatus.Loaded||this._updateProperties()},b.prototype._updateProperties=function(){var a=this._image.getProperty("url"),b=0===a.indexOf("data:"),c=this._image.getStatus(),d=this._image.getImage(),e=d&&c===IFImage.ImageStatus.Loaded,f=this._image.getGeometryBBox();this._panel.find('[data-property="url"]').text(b?"<Embedded Image>":decodeURIComponent(a)),this._panel.find('button[data-action="embed"]').prop("disabled",!e||b),this._panel.find('button[data-action="replace"]').prop("disabled",!this._document.isSaveable()),this._panel.find('button[data-action="export"]').prop("disabled",!e||!this._document.isSaveable()),this._panel.find('button[data-action="reset-size"]').prop("disabled",!e||d.naturalWidth===f.getWidth()&&d.naturalHeight===f.getHeight()),this._panel.find('[data-image-palette="button"]').prop("disabled",!e).css("display",""),this._panel.find('[data-image-palette="palette"]').css("display","none")},b.prototype.toString=function(){return"[Object GImageProperties]"},a.GImageProperties=b}(this),function(a){function b(){this._elements=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._elements=null,b.prototype._elementsBBox=null,b.prototype._firstElementsBBox=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;return"name"===a?$("<input>").css("width","100%").attr("data-name","").on("change",function(a){IFEditor.tryRunTransaction(b._elements[0],function(){b._elements[0].setProperty("name",$(a.target).val())},"Rename Element")}):"x"===a||"y"===a||"w"===a||"h"===a?$("<input>").attr("type","text").attr("data-dimension",a).on("change",function(){b._assignDimension(a,$(this).val())}):void 0}.bind(this);a.css("width","136px").append($("<div></div>").addClass("g-input").css({position:"absolute",left:"5px",top:"9px",width:"41px",height:"41px"})).append($("<label></label>").css({position:"absolute",left:"51px",top:"5px",width:"77px","text-transform":"uppercase"}).attr("data-type","")).append(b("name").css({position:"absolute",left:"51px",top:"30px",width:"77px"})).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<button></button>").css({position:"absolute",left:"5px",top:"77px",padding:"0px","font-size":"10px"}).on("click",function(){var a=$(this);a.toggleClass("g-active",!a.hasClass("g-active"))}).addClass("g-flat fa fa-lock").attr("title","Keep Ratio").attr("data-ratio","")).append($("<label></label>").css({position:"absolute",left:"15px",top:"65px"}).text("W:").append(b("w").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",left:"15px",top:"89px"}).text("H:").append(b("h").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",left:"75px",top:"65px"}).text("X:").append(b("x").css({"margin-left":"3px",width:"41px"}))).append($("<label></label>").css({position:"absolute",left:"75px",top:"89px"}).text("Y:").append(b("y").css({"margin-left":"3px",width:"41px"})))},b.prototype.update=function(a,b){return this._document&&(this._document.getScene().removeEventListener(IFElement.GeometryChangeEvent,this._geometryChange,this),this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null),this._elements=b.slice(),this._elements.length>0?(this._document=a,this._document.getScene().addEventListener(IFElement.GeometryChangeEvent,this._geometryChange,this),this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),this._updateDimensions(),!0):!1},b.prototype._geometryChange=function(a){(a.type===IFElement.GeometryChangeEvent.Type.After||a.type===IFElement.GeometryChangeEvent.Type.Child)&&this._elements.indexOf(a.element)>=0&&this._updateDimensions()},b.prototype._afterPropertiesChange=function(a){this._elements&&1===this._elements.length&&this._elements[0]===a.node&&a.properties.indexOf("name")>=0&&this._updateProperties()},b.prototype._updateProperties=function(){this._panel.find("input[data-apply]").css("display",this._elements.length<=1?"none":""),this._panel.find("label[data-type]").text(1===this._elements.length?this._elements[0].getNodeNameTranslated():this._elements.length.toString()+" Elements"),this._panel.find("input[data-name]").css("visibility",1===this._elements.length&&this._elements[0]instanceof IFBlock?"visible":"hidden").val(1===this._elements.length&&this._elements[0]instanceof IFBlock?this._elements[0].getLabel():"")},b.prototype._updateDimensions=function(a){var b=function(a,b){this._panel.find('input[data-dimension="'+a+'"]').val(null!==b?this._document.getScene().pointToString(b):"").parents("label").css("display",null===b?"none":"")}.bind(this);if(!a){this._elementsBBox=null,this._firstElementsBBox=null;for(var c=0;c<this._elements.length;++c)if(this._elements[c].hasMixin(IFElement.Transform)){var d=this._elements[c].getGeometryBBox();d&&!d.isEmpty()&&(this._elementsBBox=this._elementsBBox?this._elementsBBox.united(d):d,this._firstElementsBBox||(this._firstElementsBBox=d))}this._elementsBBox||(this._elementsBBox=null,this._firstElementsBBox=this._elementsBBox)}if(this._firstElementsBBox){var e=!0,f=this._getDelta();this._panel.find("button[data-ratio]").css("display",""),e?(b("x",this._elementsBBox.getX()-f.getX()),b("y",this._elementsBBox.getY()-f.getY()),b("w",this._elementsBBox.getWidth()),b("h",this._elementsBBox.getHeight())):(b("x",this._firstElementsBBox.getX()-f.getX()),b("y",this._firstElementsBBox.getY()-f.getY()),b("w",this._firstElementsBBox.getWidth()),b("h",this._firstElementsBBox.getHeight()))}else this._panel.find("button[data-ratio]").css("display","none"),b("x",null),b("y",null),b("w",null),b("h",null)},b.prototype._assignDimension=function(a,b){var c=this._document.getScene().stringToPoint(b);if(null===c||"number"!=typeof c||("w"===a||"h"==a)&&0>=c)return void this._updateDimensions();if("x"===a||"y"===a){var d=this._getDelta();switch(a){case"x":c+=d.getX();break;case"y":c+=d.getY()}}var e=function(b,d){if("w"===a||"h"===a){var e=1,f=1;switch(a){case"w":e=c/b.getWidth(),d&&(f=e);break;case"h":f=c/b.getHeight(),d&&(e=f)}return(new IFTransform).translated(-b.getX(),-b.getY()).scaled(e,f).translated(b.getX(),b.getY())}switch(a){case"x":return(new IFTransform).translated(c-b.getX(),0);case"y":return(new IFTransform).translated(0,c-b.getY())}},f=!0,g=this._panel.find("button[data-ratio]").hasClass("g-active"),h=this._document.getEditor();h.beginTransaction();try{if(f)for(var i=e(this._elementsBBox,g),j=0;j<this._elements.length;++j)this._elements[j].transform(i);else for(var j=0;j<this._elements.length;++j){var i=e(this._elements[j].getGeometryBBox(),g);this._elements[j].transform(i)}}finally{h.commitTransaction("Change Size")}},b.prototype._getDelta=function(){var a=this._document.getScene();if(a.getProperty("singlePage")===!0){var b=a.getActivePage();if(b)return b.getGeometryBBox().getSide(IFRect.Side.TOP_LEFT)}return new IFPoint(0,0)},b.prototype.toString=function(){return"[Object GInfoProperties]"},a.GInfoProperties=b}(this),function(a){function b(){this._pages=[]}IFObject.inherit(b,GProperties),b.SIZE_PRESETS=[{name:"Paper",sizes:[{name:"A0",width:"841mm",height:"1189mm"},{name:"A1",width:"594mm",height:"841mm"},{name:"A2",width:"420mm",height:"594mm"},{name:"A3",width:"297mm",height:"420mm"},{name:"A4",width:"210mm",height:"297mm"},{name:"A5",width:"148,5mm",height:"210mm"}]},{name:"Phone",sizes:[{name:"Apple iPhone 4 (S)",width:"640px",height:"960px"},{name:"Apple iPhone 5",width:"640px",height:"1136px"}]},{name:"Tablet",sizes:[{name:"Apple iPad 1 & 2 & Mini",width:"768px",height:"1024px"},{name:"Apple iPad 3 & 4",width:"1536px",height:"2048px"}]}],b.prototype._panel=null,b.prototype._document=null,b.prototype._pages=null,b.prototype.init=function(a){this._panel=a;var c=function(a){var c=this;if("msref"===a)return $("<select></select>").attr("data-property","msref").on("change",function(){var b=$(this).val();c._assignProperty(a,""===b?null:b)});if("size-preset"===a){var d=$("<select></select>").attr("data-property","size-preset").on("change",function(){var a=c._document.getScene(),d=$(this).val();if(d.indexOf(",")>=0){var e=d.split(","),f=b.SIZE_PRESETS[parseInt(e[0])].sizes[parseInt(e[1])],g=a.stringToPoint(f.width),h=a.stringToPoint(f.height);c._panel.find('[name="w"]').val(a.pointToString(g)),c._panel.find('[name="h"]').val(a.pointToString(h)),c._assignProperties(["w","h"],[g,h])}});d.append($("<option></option>").attr("value","x").text("Custom Size"));for(var e=0;e<b.SIZE_PRESETS.length;++e){var f=b.SIZE_PRESETS[e],g=$("<optgroup></optgroup>").attr("label",f.name);d.append(g);for(var h=0;h<f.sizes.length;++h){var i=f.sizes[h];$("<option></option>").attr("value",e.toString()+","+h.toString()).text(i.name).appendTo(g)}}return d}if("bck"===a)return $("<div></div>").attr("data-property",a).gPatternPicker().gPatternPicker("types",[null,IFColor,IFGradient]).on("patternchange",function(b,d,e){"number"==typeof e?c._assignProperties([a,"bop"],[d,e]):c._assignProperty(a,d)});if("w"===a||"h"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var b=c._document.getScene().stringToPoint($(this).val());null!==b&&"number"==typeof b&&b>=0?c._assignProperty(a,b):c._updateProperties(),c._selectSizePreset()});if("bl"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var b=c._document.getScene().stringToPoint($(this).val());null!==b&&"number"==typeof b&&b>=0?c._assignProperty(a,b):c._updateProperties()});if("mt"===a||"mb"===a||"ml"===a||"mr"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var b=c._document.getScene().stringToPoint($(this).val());if(null!==b&&"number"==typeof b&&b>=0){var d=c._panel.find("button[data-lock-margin]").hasClass("g-active");d?c._assignProperties(["mt","mb","ml","mr"],[b,b,b,b]):c._assignProperty(a,b)}else c._updateProperties()});throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","250px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).append(c("size-preset").css({width:"110px"}))).append($("<label></label>").css({position:"absolute",top:"5px",left:"125px"}).html('<span class="fa fa-link"></span>').append(c("msref").css({"margin-left":"5px",width:"102px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).text("W:").append(c("w").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"65px"}).text("H:").append(c("h").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"125px"}).text("Bleed:").append(c("bl").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",top:"30px",right:"5px"}).append(c("bck"))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<label></label>").css({position:"absolute",left:"5px",top:"65px"}).text("L:").append(c("ml").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",left:"5px",top:"89px"}).text("T:").append(c("mt").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",left:"65px",top:"65px"}).text("R:").append(c("mr").css({"margin-left":"3px",width:"38px"}))).append($("<label></label>").css({position:"absolute",left:"65px",top:"89px"}).text("B:").append(c("mb").css({"margin-left":"3px",width:"38px"}))).append($("<button></button>").css({position:"absolute",left:"123px",top:"77px",padding:"0px","font-size":"10px"}).on("click",function(){var a=$(this);a.toggleClass("g-active",!a.hasClass("g-active"))}).addClass("g-flat fa fa-lock g-active").attr("title","Equal Margins").attr("data-lock-margin",""))},b.prototype.update=function(a,b){if(this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().removeEventListener(IFNode.AfterInsertEvent,this._updatePages,this),this._document.getScene().removeEventListener(IFNode.AfterRemoveEvent,this._updatePages,this),this._document=null),this._pages=[],1===b.length&&b[0]instanceof IFScene){var c=b[0].getActivePage();c&&this._pages.push(c)}else for(var d=0;d<b.length;++d)b[d]instanceof IFPage&&this._pages.push(b[d]);return this._pages.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getScene().addEventListener(IFNode.AfterInsertEvent,this._updatePages,this),this._document.getScene().addEventListener(IFNode.AfterRemoveEvent,this._updatePages,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._pages.length>0&&(this._pages[0]===a.node||a.node instanceof IFScene&&a.properties.indexOf("unit")>=0)&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._document.getScene(),b=this._pages[0];this._updatePages(),this._panel.find('select[data-property="msref"]').val(b.getProperty("msref")),this._panel.find('input[data-property="bl"]').val(b.getProperty("bl")),this._panel.find('[data-property="bck"]').gPatternPicker("value",b.getProperty("bck")).gPatternPicker("opacity",b.getProperty("bop")).gPatternPicker("scene",a),this._panel.find('input[data-property="w"]').val(a.pointToString(b.getProperty("w"))),this._panel.find('input[data-property="h"]').val(a.pointToString(b.getProperty("h"))),this._panel.find('input[data-property="mt"]').val(a.pointToString(b.getProperty("mt"))),this._panel.find('input[data-property="mb"]').val(a.pointToString(b.getProperty("mb"))),this._panel.find('input[data-property="ml"]').val(a.pointToString(b.getProperty("ml"))),this._panel.find('input[data-property="mr"]').val(a.pointToString(b.getProperty("mr"))),this._selectSizePreset()
},b.prototype._updatePages=function(){var a=this._document.getScene(),b=this._panel.find('select[data-property="msref"]'),c=b.val();b.val(null),b.empty(),$("<option></option>").attr("value","").text("").appendTo(b);for(var d=a.getFirstChild();null!==d;d=d.getNext())d instanceof IFPage&&this._pages.indexOf(d)<0&&$("<option></option>").attr("value",d.getReferenceId()).text(d.getLabel()).appendTo(b);b.val(c)},b.prototype._selectSizePreset=function(){for(var a=this._pages[0],c=!1,d=this._panel.find('[data-property="size-preset"]'),e=a.getProperty("w"),f=a.getProperty("h"),g=0;g<b.SIZE_PRESETS.length;++g)for(var h=b.SIZE_PRESETS[g],i=0;i<h.sizes.length;++i){var j=h.sizes[i],k=a.getScene().stringToPoint(j.width),l=a.getScene().stringToPoint(j.height);if(k===e&&l===f){d.val(g.toString()+","+i.toString()),c=!0;break}}c||d.val("x")},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._pages.length;++d)this._pages[d].setProperties(a,b)}finally{c.commitTransaction("Modify Page Properties")}},b.prototype.toString=function(){return"[Object GPageProperties]"},a.GPageProperties=b}(this),function(a){function b(){this._text=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._text=null,b.prototype._textEditor=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if(0===a.indexOf("va-")){var c="",d=a.substr("va-".length);switch(d){case IFText.VerticalAlign.Top:c="fa-align-right fa-rotate-270";break;case IFText.VerticalAlign.Middle:c="fa-align-center fa-rotate-270";break;case IFText.VerticalAlign.Bottom:c="fa-align-left fa-rotate-270"}return $("<button></button>").attr("data-property",a).on("click",function(){b._assignProperty("va",d)}).append($("<span></span>").addClass("fa "+c))}if(0===a.indexOf("_pal-")){var e="",f=a.substr("_pal-".length);switch(f){case IFStylable.ParagraphAlignment.Left:e="left";break;case IFStylable.ParagraphAlignment.Center:e="center";break;case IFStylable.ParagraphAlignment.Right:e="right";break;case IFStylable.ParagraphAlignment.Justify:e="justify"}return $("<button></button>").attr("data-property",a).on("click",function(){b._assignProperty("_pal",$(this).hasClass("g-active")?null:f)}).append($("<span></span>").addClass("fa fa-align-"+e))}if("aw"===a||"ah"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty(a,$(this).is(":checked"))});if("_tff"===a){for(var g=$("<select></select>").attr("data-property",a).append($("<option></option>").attr("value","").text("")).on("change",function(){var c=$(this).val();b._assignProperty(a,""===c?null:c)}),h={},i=ifFont.getFamilies(),j=0;j<i.length;++j){var k=ifFont.getCategory(i[j]),l=null;h.hasOwnProperty(k)?l=h[k]:h[k]=l=$("<optgroup></optgroup>").attr("label",ifLocale.get(IFFont.CategoryName[k])).appendTo(g),$("<option></option>").attr("value",i[j]).text(i[j]).appendTo(l)}return g}if("_tfi"===a||"_tws"===a||"_tcs"===a||"_pin"===a||"_pcg"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null===c||"number"==typeof c&&c>=0?b._assignProperty(a,c):b._updateProperties()});if("_tfw"===a){for(var g=$("<select></select>").attr("data-property",a).append($("<option></option>").attr("value","").text("")).on("change",function(){var c=$(this).val();b._assignProperty(a,""===c?null:c)}),j=100;900>=j;j+=100)$("<option></option>").attr("value",j).text(ifLocale.get(IFFont.WeightName[j])).appendTo(g);return g}if("_tfs"===a)return $("<select></select>").attr("data-property",a).append($("<option></option>").attr("value","").text("")).append($("<option></option>").attr("value",IFFont.Style.Normal).text("Normal")).append($("<option></option>").attr("value",IFFont.Style.Italic).text("Italic")).on("change",function(){var c=$(this).val();b._assignProperty(a,""===c?null:c)});if("_pwm"===a)return $("<select></select>").attr("data-property",a).append($("<option></option>").attr("value","").text("")).append($("<option></option>").attr("value",IFStylable.ParagraphWrapMode.None).text("None")).append($("<option></option>").attr("value",IFStylable.ParagraphWrapMode.Words).text("Words")).append($("<option></option>").attr("value",IFStylable.ParagraphWrapMode.All).text("All")).on("change",function(){var c=$(this).val();b._assignProperty(a,""===c?null:c)});if("_plh"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=$(this).val();c=c&&""!==c?IFLength.parseEquationValue(c):null,null===c||c>0?b._assignProperty(a,c):b._updateProperties()});if("_pcc"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=$(this).val();c=c&&""!==c?parseInt(c):null,null===c||c>1?b._assignProperty(a,c):b._updateProperties()});throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","320px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).append(b("_tff").css({width:"120px"})).append(b("_tfw").css({width:"83px"})).append(b("_tfs").css({width:"65px"})).append(b("_tfi").css({width:"30px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).html('<span class="fa fa-text-width"></span>').append(b("_tcs").css({"margin-left":"5px",width:"30px"}).attr("title","Character Spacing"))).append($("<label></label>").css({position:"absolute",top:"30px",left:"60px"}).html('<span class="fa fa-text-width"></span>').append(b("_tws").css({"margin-left":"5px",width:"30px"}).attr("title","Word Spacing"))).append($("<label></label>").css({position:"absolute",top:"30px",left:"115px"}).html('<span class="fa fa-text-height"></span>').append(b("_plh").css({"margin-left":"5px",width:"30px"}).attr("title","Line Height"))).append($("<div></div>").css({position:"absolute",top:"30px",left:"215px"}).append(b("_pal-"+IFStylable.ParagraphAlignment.Left).attr("title","Align Left")).append(b("_pal-"+IFStylable.ParagraphAlignment.Center).attr("title","Align Centered")).append(b("_pal-"+IFStylable.ParagraphAlignment.Right).attr("title","Align Right")).append(b("_pal-"+IFStylable.ParagraphAlignment.Justify).attr("title","Justify"))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<div></div>").css({position:"absolute",top:"65px",left:"5px"}).append(b("va-"+IFText.VerticalAlign.Top).attr("title","Align Top")).append(b("va-"+IFText.VerticalAlign.Middle).attr("title","Align Middle")).append(b("va-"+IFText.VerticalAlign.Bottom).attr("title","Align Bottom"))).append($("<label></label>").css({position:"absolute",top:"65px",left:"85px"}).html('<span class="fa fa-sort-alpha-asc"></span>').append(b("_pwm").css({"margin-left":"5px",width:"60px"}).attr("title","Wrap Mode"))).append($("<label></label>").css({position:"absolute",top:"65px",right:"5px"}).text("Auto Height:").append(b("ah"))).append($("<label></label>").css({position:"absolute",top:"89px",left:"5px"}).html('<span class="fa fa-indent"></span>').append(b("_pin").css({"margin-left":"5px",width:"30px"}).attr("title","Indent"))).append($("<label></label>").css({position:"absolute",top:"89px",left:"60px"}).html('<span class="fa fa-reorder fa-rotate-270"></span>').append(b("_pcc").css({"margin-left":"5px",width:"30px"}).attr("title","Columns"))).append($("<label></label>").css({position:"absolute",top:"89px",left:"115px"}).html('<span class="fa fa-sort-amount-desc fa-rotate-270"></span>').append(b("_pcg").css({"margin-left":"5px",width:"30px"}).attr("title","Columns Gap"))).append($("<label></label>").css({position:"absolute",top:"89px",right:"5px"}).text("Auto Width:").append(b("aw")))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document.getEditor().removeEventListener(IFEditor.InlineEditorEvent,this._inlineEditorEvent),this._document=null),this._text=[];for(var c=0;c<b.length;++c)b[c]instanceof IFText&&this._text.push(b[c]);return this._text.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document.getEditor().addEventListener(IFEditor.InlineEditorEvent,this._inlineEditorEvent,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._text.length>0&&(this._text[0]===a.node||this._text[0].getContent()===a.node)&&this._updateProperties()},b.prototype._inlineEditorEvent=function(a){switch(a.type){case IFEditor.InlineEditorEvent.Type.AfterOpen:this._textEditor=a.editor,this._updateProperties();break;case IFEditor.InlineEditorEvent.Type.AfterClose:this._textEditor=null,this._updateProperties();break;case IFEditor.InlineEditorEvent.Type.SelectionChanged:this._updateProperties()}},b.prototype._updateProperties=function(){var a=this._textEditor?this._textEditor:IFElementEditor.getEditor(this._text[0]);this._panel.find('button[data-property^="va"]').each(function(b,c){var d=$(c),e=this._textEditor&&this._textEditor.isInlineEdit()?!0:!1;d.prop("disabled",e).toggleClass("g-active",e?!1:d.attr("data-property")==="va-"+a.getProperty("va"))}.bind(this)),this._panel.find('input[data-property="ah"]').prop("disabled",this._textEditor&&this._textEditor.isInlineEdit()).prop("checked",a.getProperty("ah")),this._panel.find('input[data-property="aw"]').prop("disabled",this._textEditor&&this._textEditor.isInlineEdit()).prop("checked",a.getProperty("aw"));var b=a.getProperty("_tff",!0);this._panel.find('select[data-property="_tff"]').val(a.getProperty("_tff")),this._panel.find('input[data-property="_tfi"]').val(this._document.getScene().pointToString(a.getProperty("_tfi")));var c=this._panel.find('select[data-property="_tfw"]');c.val(a.getProperty("_tfw"));for(var d=ifFont.getWeights(b),e=100;900>=e;e+=100)c.find('[value="'+e+'"]').prop("disabled",!d||d.indexOf(e)<0);var f=this._panel.find('select[data-property="_tfs"]');f.val(a.getProperty("_tfs"));var g=ifFont.getStyles(b);f.find("option").each(function(a,b){var c=$(b),d=c.attr("value");""!==d&&c.prop("disabled",g&&g.indexOf(d)<0)}),this._panel.find('input[data-property="_tws"]').val(this._document.getScene().pointToString(a.getProperty("_tws"))),this._panel.find('input[data-property="_tcs"]').val(this._document.getScene().pointToString(a.getProperty("_tcs"))),this._panel.find('input[data-property="_pcc"]').val(a.getProperty("_pcc")),this._panel.find('input[data-property="_pcg"]').val(this._document.getScene().pointToString(a.getProperty("_pcg")));var h=a.getProperty("_pal")||"";this._panel.find('button[data-property^="_pal"]').each(function(a,b){var c=$(b);c.toggleClass("g-active",c.attr("data-property")==="_pal-"+h)}),this._panel.find('select[data-property="_pwm"]').val(a.getProperty("_pwm")),this._panel.find('input[data-property="_pin"]').val(this._document.getScene().pointToString(a.getProperty("_pin")));var i=a.getProperty("_plh");this._panel.find('input[data-property="_plh"]').val(null!==i?IFUtil.formatNumber(i):"")},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){if(this._textEditor)this._textEditor.setProperties(a,b);else{var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._text.length;++d){var e=IFElementEditor.getEditor(this._text[d]);e.setProperties(a,b)}}finally{c.commitTransaction("Modify Text Properties")}}},b.prototype.toString=function(){return"[Object GTextProperties]"},a.GTextProperties=b}(this),function(a){function b(){this._elements=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._elements=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("_fpt"===a||"_bpt"===a)return $("<div></div>").attr("data-property",a).gPatternPicker().on("patternchange",function(c,d,e){"number"==typeof e?b._assignProperties([a,"_fpt"===a?"_fop":"_bop"],[d,e]):b._assignProperty(a,d)});if("fill-type"===a)return $("<select></select>").attr("data-property",a).gPatternTypePicker().on("patterntypechange",function(a,c){b._assignProperty("_fpt",IFPattern.smartCreate(c,b._panel.find('[data-property="_fpt"]').gPatternPicker("value"))),c&&c!==IFBackground&&b._panel.find('[data-property="_fpt"]').gPatternPicker("open")});if("_fop"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c&&c>=0&&100>=c?b._assignProperty(a,c/100):b._updateProperties()});if("_bw"===a||"_bml"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c&&c>=0?b._assignProperty(a,c):b._updateProperties()});if(0===a.indexOf("_ba-")){var c="",d=a.substr("_ba-".length);switch(d){case IFStylable.BorderAlignment.Inside:c="gicon-stroke-inside";break;case IFStylable.BorderAlignment.Center:c="gicon-stroke-center";break;case IFStylable.BorderAlignment.Outside:c="gicon-stroke-outside"}return $("<button></button>").attr("data-property",a).on("click",function(){b._assignProperty("_ba",d)}).append($("<span></span>").addClass(c))}if(0===a.indexOf("_blc-")){var c="",e=a.substr("_blc-".length);switch(e){case IFPaintCanvas.LineCap.Butt:c="gicon-line-cap-butt";break;case IFPaintCanvas.LineCap.Round:c="gicon-line-cap-round";break;case IFPaintCanvas.LineCap.Square:c="gicon-line-cap-square"}return $("<button></button>").attr("data-property",a).on("click",function(){b._assignProperty("_blc",e)}).append($("<span></span>").addClass(c))}if(0===a.indexOf("_blj-")){var c="",f=a.substr("_blj-".length);switch(f){case IFPaintCanvas.LineJoin.Bevel:c="gicon-line-join-bevel";break;case IFPaintCanvas.LineJoin.Round:c="gicon-line-join-round";break;case IFPaintCanvas.LineJoin.Miter:c="gicon-line-join-miter"}return $("<button></button>").attr("data-property",a).on("click",function(){b._assignProperty("_blj",f)}).append($("<span></span>").addClass(c))}throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","170px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).append($("<span></span>").addClass("gicon-fill").css({width:"16px","text-align":"center"})).append(b("_fpt").css({"margin-left":"5px",width:"20px"}))).append($("<label></label>").css({position:"absolute",top:"5px",left:"50px"}).append(b("fill-type").css({width:"80px"}))).append($("<label></label>").css({position:"absolute",top:"5px",left:"134px"}).append(b("_fop").css({width:"30px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).append($("<span></span>").addClass("gicon-stroke").css({width:"16px","text-align":"center"})).append(b("_bpt").css({"margin-left":"5px",width:"20px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"50px"}).append(b("_bw").css({width:"30px"}))).append($("<div></div>").css({position:"absolute",top:"30px",left:"86px"}).append(b("_ba-"+IFStylable.BorderAlignment.Inside).attr("title","Border Inside")).append(b("_ba-"+IFStylable.BorderAlignment.Center).attr("title","Border Centered")).append(b("_ba-"+IFStylable.BorderAlignment.Outside).attr("title","Border Outside"))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<label></label>").css({position:"absolute",top:"65px",left:"5px"}).text("Ending:")).append($("<div></div>").css({position:"absolute",top:"65px",left:"50px"}).append(b("_blc-"+IFPaintCanvas.LineCap.Butt).attr("title","Butt")).append(b("_blc-"+IFPaintCanvas.LineCap.Round).attr("title","Round")).append(b("_blc-"+IFPaintCanvas.LineCap.Square).attr("title","Square"))).append($("<label></label>").css({position:"absolute",top:"89px",left:"5px"}).text("Join:")).append($("<div></div>").css({position:"absolute",top:"89px",left:"50px"}).append(b("_blj-"+IFPaintCanvas.LineJoin.Bevel).attr("title","Bevel")).append(b("_blj-"+IFPaintCanvas.LineJoin.Round).attr("title","Round")).append(b("_blj-"+IFPaintCanvas.LineJoin.Miter).attr("title","Miter")).append(b("_bml").attr("title","Miter-Limit").css("width","30px")))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._elements=[];for(var c=0;c<b.length;++c)b[c].hasMixin(IFStylable)&&b[c].getStylePropertySets().indexOf(IFStylable.PropertySet.Fill)>=0&&this._elements.push(b[c]);return this._elements.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){a.node===this._elements[0]&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._document.getScene(),b=this._elements[0],c=b.getProperty("_fpt");this._panel.find('[data-property="_fpt"]').gPatternPicker("value",c).gPatternPicker("opacity",b.getProperty("_fop")).gPatternPicker("scene",a),this._panel.find('[data-property="fill-type"]').gPatternTypePicker("value",c?c.constructor:null),this._panel.find('[data-property="_fop"]').val(IFUtil.formatNumber(100*b.getProperty("_fop"),0)),this._panel.find('[data-property="_bpt"]').gPatternPicker("value",b.getProperty("_bpt")).gPatternPicker("opacity",b.getProperty("_bop")).gPatternPicker("scene",a),this._panel.find('[data-property="_bw"]').val(IFUtil.formatNumber(b.getProperty("_bw"))),this._panel.find('[data-property^="_ba"]').each(function(a,c){var d=$(c),e=d.attr("data-property").substr("_ba-".length);d.toggleClass("g-active",b.getProperty("_ba")===e)}),this._panel.find('[data-property^="_blc"]').each(function(a,c){var d=$(c),e=d.attr("data-property").substr("_blc-".length);d.toggleClass("g-active",b.getProperty("_blc")===e)}),this._panel.find('[data-property^="_blj"]').each(function(a,c){var d=$(c),e=d.attr("data-property").substr("_blj-".length);d.toggleClass("g-active",b.getProperty("_blj")===e)}),this._panel.find('[data-property="_bml"]').css("display",b.getProperty("_blj")===IFPaintCanvas.LineJoin.Miter?"":" none").val(IFUtil.formatNumber(b.getProperty("_bml")))},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._elements.length;++d)this._elements[d].setProperties(a,b)}finally{c.commitTransaction("Modify Fill/Border Properties")}},b.prototype.toString=function(){return"[Object GFillBorderProperties]"},a.GFillBorderProperties=b}(this),function(a){function b(){this._elements=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._elements=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("_sbl"===a)return $("<select></select>").attr("data-property",a).append($("<option></option>").attr("value","mask").text("Mask")).append($('<optgroup label="Blending"></optgroup>')).gBlendMode().on("change",function(){b._assignProperty(a,$(this).val())});if("_stop"===a||"_sfop"===a)return $("<input>").attr("type","text").attr("data-property",a).on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c&&c>=0&&100>=c?b._assignProperty(a,c/100):b._updateProperties()});if("sref"===a)return $("<button></button>").attr("data-property",a).append($("<span></span>")).append($("<span></span>").addClass("fa fa-caret-down"));throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","142px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px",right:"5px"}).append(b("_sbl").css({width:"100%"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).text("Opacity:").append(b("_stop").css({"margin-left":"3px",width:"30px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"86px"}).text("Fill:").append(b("_sfop").css({"margin-left":"3px",width:"30px"}))).append($("<hr>").css({position:"absolute",left:"0px",right:"0px",top:"50px"})).append($("<label></label>").css({position:"absolute",top:"65px",left:"5px",right:"5px"}).append(b("sref").on("click",function(a){$("<div></div>").css({width:"250px"}).addClass("g-style-list").gStylePanel().gStylePanel("attach",this._document.getScene().getStyleCollection()).gOverlay({releaseOnClose:!0}).gOverlay("open",a.target).on("close",function(){$(this).gStylePanel("detach")}).on("stylechange",function(a,b){$(a.target).gOverlay("close"),IFEditor.tryRunTransaction(this._elements[0],function(){for(var a=0;a<this._elements.length;++a)this._elements[a].assignStyleFrom(b),this._elements[a].setProperty("sref",null!==b.getProperty("_sdf")?null:b.getReferenceId())}.bind(this),"Disconnect Style")}.bind(this))}.bind(this)).css({width:"100%"}))).append($("<div></div>").css({position:"absolute",top:"89px",left:"5px"}).append($("<button></button>").attr("title","New Style").append($("<span></span>").addClass("fa fa-plus")).on("click",function(){var a=this._document.getScene(),b=new IFStyle;b.setProperty("name","Style-"+a.getStyleCollection().queryCount("> style").toString()),b.setProperty("ps",this._elements[0].getStylePropertySets().slice()),b.assignStyleFrom(this._elements[0]),new GStyleDialog(b).open(function(c,d){c&&IFEditor.tryRunTransaction(a,function(){d(),a.getStyleCollection().appendChild(b);for(var c=0;c<this._elements.length;++c)this._elements[c].setProperty("sref",b.getReferenceId())}.bind(this),"Add Style")}.bind(this))}.bind(this))).append($("<button></button>").attr("title","Redefine Style").attr("data-link-action","redefine").append($("<span></span>").addClass("fa fa-check")).on("click",function(){for(var a=[],b=0;b<this._elements.length;++b){var c=this._elements[b].getReferencedStyle();c&&a.indexOf(c)<0&&a.push({style:c,element:this._elements[b]})}a.length&&IFEditor.tryRunTransaction(a[0].element,function(){for(var b=0;b<a.length;++b)a[b].style.assignStyleFrom(a[b].element)}.bind(this),"Update Style")}.bind(this))).append($("<button></button>").attr("title","Remove Style Differences").attr("data-link-action","removediff").append($("<span></span>").addClass("fa fa-remove")).on("click",function(){IFEditor.tryRunTransaction(this._elements[0],function(){for(var a=0;a<this._elements.length;++a){var b=this._elements[a].getReferencedStyle();b&&this._elements[a].assignStyleFrom(b)}}.bind(this),"Reset Style")}.bind(this))).append($("<button></button>").attr("title","Disconnect Style").attr("data-link-action","disconnect").append($("<span></span>").addClass("fa fa-chain-broken")).on("click",function(){IFEditor.tryRunTransaction(this._elements[0],function(){for(var a=0;a<this._elements.length;++a)this._elements[a].setProperty("sref",null)}.bind(this),"Disconnect Style")}.bind(this))).append($("<button></button>").attr("title","Delete Style").attr("data-link-action","delete").append($("<span></span>").addClass("fa fa-trash-o")).on("click",function(){vex.dialog.confirm({message:"Are you sure you want to delete the selected style?",callback:function(a){if(a){var b=this._elements[0].getReferencedStyle();b&&IFEditor.tryRunTransaction(b,function(){b.disconnectStyle(),b.getParent().removeChild(b)},"Delete Style")}}.bind(this)})}.bind(this))).append($("<button></button>").attr("title","Set As Default Style").append($("<span></span>").addClass("fa fa-thumb-tack")).on("click",function(){var a=null;this._elements[0]instanceof IFText?a=this._document.getScene().getStyleCollection().querySingle('style[_sdf="text"]'):this._elements[0]instanceof IFShape&&(a=this._document.getScene().getStyleCollection().querySingle('style[_sdf="shape"]')),a&&IFEditor.tryRunTransaction(a,function(){a.assignStyleFrom(this._elements[0])}.bind(this),"Change Default Style")}.bind(this))))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange),this._document=null),this._elements=[];for(var c=0;c<b.length;++c)b[c].hasMixin(IFElement.Stylable)&&b[c].getStylePropertySets().indexOf(IFStylable.PropertySet.Style)>=0&&this._elements.push(b[c]);return this._elements.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){a.node===this._elements[0]&&this._updateProperties()},b.prototype._updateProperties=function(){var a=(this._document.getScene(),this._elements[0]);this._panel.find('[data-property="_sbl"]').val(a.getProperty("_sbl")),this._panel.find('[data-property="_sfop"]').val(IFUtil.formatNumber(100*a.getProperty("_sfop"),0)),this._panel.find('[data-property="_stop"]').val(IFUtil.formatNumber(100*a.getProperty("_stop"),0));var b=a.getReferencedStyle();this._panel.find('[data-property="sref"] > :first-child').text(b?b.getProperty("name"):"No Style"),this._panel.find("button[data-link-action]").prop("disabled",!b)},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._elements.length;++d)this._elements[d].setProperties(a,b)}finally{c.commitTransaction("Modify Style")}},b.prototype.toString=function(){return"[Object GStyleProperties]"},a.GStyleProperties=b}(this),function(a){function b(){this._slices=[]}IFObject.inherit(b,GProperties),b.prototype._panel=null,b.prototype._document=null,b.prototype._slices=null,b.prototype.init=function(a){this._panel=a;var b=function(a){var b=this;if("cls"===a)return $("<div></div>").attr("data-property",a).gPatternPicker().gPatternPicker("types",[IFColor]).on("patternchange",function(c,d){b._assignProperty(a,d)});if("trm"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty(a,$(this).is(":checked"))});throw new Error("Unknown input property: "+a)}.bind(this);a.css("width","120px").append($("<label></label>").css({position:"absolute",top:"5px",left:"5px"}).text("Color:").append(b("cls").css({"margin-left":"3px"}))).append($("<label></label>").css({position:"absolute",top:"30px",left:"5px"}).text("Trim Transparent:").append(b("trm")))},b.prototype.update=function(a,b){this._document&&(this._document.getScene().removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._document=null),this._slices=[];for(var c=0;c<b.length;++c)b[c]instanceof IFSlice&&this._slices.push(b[c]);return this._slices.length===b.length?(this._document=a,this._document.getScene().addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),!0):!1},b.prototype._afterPropertiesChange=function(a){this._slices.length>0&&this._slices[0]===a.node&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._document.getScene(),b=this._slices[0];this._panel.find('[data-property="cls"]').gPatternPicker("value",b.getProperty("cls")).gPatternPicker("scene",a),this._panel.find('input[data-property="trm"]').prop("checked",b.getProperty("trm"))},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{for(var d=0;d<this._slices.length;++d)this._slices[d].setProperties(a,b)}finally{c.commitTransaction("Modify Slice Properties")}},b.prototype.toString=function(){return"[Object GSliceProperties]"},a.GSliceProperties=b}(this),function(a){function b(){GSidebar.call(this)}IFObject.inherit(b,GSidebar),b.ID="document",b.TITLE=new IFLocale.Key(b,"title"),b.prototype._htmlElement=null,b.prototype._document=null,b.prototype.getId=function(){return b.ID},b.prototype.getTitle=function(){return b.TITLE},b.prototype.getIcon=function(){return'<span class="fa fa-fw fa-file-text-o"></span>'},b.prototype.init=function(a){GSidebar.prototype.init.call(this,a),this._htmlElement=a;var b=function(a){var b=this;if("unit"===a)return $("<select></select>").attr("data-property",a).gUnit().on("change",function(){b._assignProperty(a,$(this).val())});if("unitSnap"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty(a,$(this).is(":checked"))});if("gridSizeX"===a||"gridSizeY"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","3em").on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=1?b._assignProperty(a,0>c?0:c):b._updateProperties()});if("gridActive"===a)return $("<input>").attr("type","checkbox").attr("data-property",a).on("change",function(){b._assignProperty(a,$(this).is(":checked"))});if("crDistSmall"===a||"crDistBig"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","3em").on("change",function(){var c=b._document.getScene().stringToPoint($(this).val());null!==c&&"number"==typeof c&&c>=1?b._assignProperty(a,0>c?0:c):b._updateProperties()});if("crConstraint"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","3em").on("change",function(){var c=IFLength.parseEquationValue($(this).val());null!==c?(c=IFMath.normalizeAngleRadians(IFMath.toRadians(c)),b._assignProperty(a,c)):b._updateProperties()});if("snapDist"===a||"pickDist"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","3em").on("change",function(){var c=parseInt($(this).val());isNaN(c)?b._updateProperties():b._assignProperty(a,c)});if("pathImage"===a||"pathFont"===a||"pathExport"===a)return $("<input>").attr("type","text").attr("data-property",a).css("width","8em").on("change",function(){b._assignProperty(a,$(this).val())});throw new Error("Unknown input property: "+a)}.bind(this);$("<table></table>").addClass("g-form").css({margin:"5px auto"}).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Unit/Snap:")).append($("<td></td>").attr("colspan","3").append(b("unit")).append(b("unitSnap").attr("title","Snap to Units")))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Grid:")).append($("<td></td>").append(b("gridSizeX").attr("title","Horizontal Grid-Size")).append(b("gridSizeY").attr("title","Vertical Grid-Size"))).append($("<td></td>").attr("colspan","2").append(b("gridActive").attr("title","Show Grid")))).append($("<tr></tr>").append($("<td></td>").attr("colspan","4").append($("<h1></h1>").addClass("g-divider").text("Defaults")))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Cursor:")).append($("<td></td>").append(b("crDistSmall").attr("title","Small Distance when moving via Arrow-Keys")).append(b("crDistBig").attr("title","Large Distance when moving via Arrow-Keys"))).append($("<td></td>").addClass("label").text("°")).append($("<td></td>").append(b("crConstraint").attr("title","Constraints when moving via Shift in Degrees")))).append($("<tr></tr>").append($("<td></td>").addClass("label").html('<span class="fa fa-arrows"></span> / <span class="fa fa-magnet"></span>')).append($("<td></td>").attr("colspan","3").append(b("pickDist").attr("title","Pick Distance in Pixels")).append(b("snapDist").attr("title","Snap Distance")))).append($("<tr></tr>").append($("<td></td>").attr("colspan","4").append($("<h1></h1>").addClass("g-divider").text("Pathes")))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Images:")).append($("<td></td>").attr("colspan","3").append(b("pathImage").attr("title","Path for imported image assets")))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Fonts:")).append($("<td></td>").attr("colspan","3").append(b("pathFont").attr("title","Path for imported font assets")))).append($("<tr></tr>").append($("<td></td>").addClass("label").text("Export:")).append($("<td></td>").attr("colspan","3").append(b("pathExport").attr("title","Path for exported assets")))).appendTo(a)
},b.prototype.isEnabled=function(){return!!this._document},b.prototype._documentEvent=function(a){if(a.type===GApplication.DocumentEvent.Type.Activated){this._document=a.document;var b=this._document.getScene();b.addEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this._updateProperties(),this.trigger(GPalette.UPDATE_EVENT)}else if(a.type===GApplication.DocumentEvent.Type.Deactivated){var b=this._document.getScene();this._document=null,b.removeEventListener(IFNode.AfterPropertiesChangeEvent,this._afterPropertiesChange,this),this.trigger(GPalette.UPDATE_EVENT)}},b.prototype._afterPropertiesChange=function(a){a.node===this._document.getScene()&&this._updateProperties()},b.prototype._updateProperties=function(){var a=this._document.getScene();this._htmlElement.find('select[data-property="unit"]').val(a.getProperty("unit")),this._htmlElement.find('input[data-property="unitSnap"]').prop("checked",a.getProperty("unitSnap")),this._htmlElement.find('input[data-property="gridSizeX"]').val(a.pointToString(a.getProperty("gridSizeX"))),this._htmlElement.find('input[data-property="gridSizeY"]').val(a.pointToString(a.getProperty("gridSizeY"))),this._htmlElement.find('input[data-property="gridActive"]').prop("checked",a.getProperty("gridActive")),this._htmlElement.find('input[data-property="crDistSmall"]').val(a.pointToString(a.getProperty("crDistSmall"))),this._htmlElement.find('input[data-property="crDistBig"]').val(a.pointToString(a.getProperty("crDistBig"))),this._htmlElement.find('input[data-property="crConstraint"]').val(IFUtil.formatNumber(IFMath.toDegrees(a.getProperty("crConstraint")),2)),this._htmlElement.find('input[data-property="snapDist"]').val(a.pointToString(a.getProperty("snapDist"))),this._htmlElement.find('input[data-property="pickDist"]').val(a.pointToString(a.getProperty("pickDist"))),this._htmlElement.find('input[data-property="pathImage"]').val(a.getProperty("pathImage")),this._htmlElement.find('input[data-property="pathFont"]').val(a.getProperty("pathFont")),this._htmlElement.find('input[data-property="pathExport"]').val(a.getProperty("pathExport"))},b.prototype._assignProperty=function(a,b){this._assignProperties([a],[b])},b.prototype._assignProperties=function(a,b){var c=this._document.getEditor();c.beginTransaction();try{this._document.getScene().setProperties(a,b)}finally{c.commitTransaction("Modify Document Properties")}},b.prototype.toString=function(){return"[Object GDocumentSidebar]"},a.GDocumentSidebar=b}(this),ifLocale.setValues(GAddLayerAction,IFLocale.Language.English,["title"],["Add Layer"]),ifLocale.setValues(GAddPageAction,IFLocale.Language.English,["title"],["Add Page"]),ifLocale.setValues(GAlignAction,IFLocale.Language.English,["title.align-left","title.align-center","title.align-right","title.align-top","title.align-middle","title.align-bottom","title.align-justify-horizontal","title.align-justify-vertical"],["Align Left","Align Center","Align Right","Align Top","Align Middle","Align Bottom","Justify Horizontal","Justify Vertical"]),ifLocale.setValues(GConvertToPathAction,IFLocale.Language.English,["title"],["Convert Selection to Path(s)"]),ifLocale.setValues(GCloneAction,IFLocale.Language.English,["title"],["Clone"]),ifLocale.setValues(GCloseAction,IFLocale.Language.English,["title"],["Close"]),ifLocale.setValues(GCloseAllAction,IFLocale.Language.English,["title"],["Close All"]),ifLocale.setValues(GCopyAction,IFLocale.Language.English,["title"],["Copy"]),ifLocale.setValues(GCutAction,IFLocale.Language.English,["title"],["Cut"]),ifLocale.setValues(GDeleteAction,IFLocale.Language.English,["title"],["Delete"]),ifLocale.setValues(GDeleteLayerAction,IFLocale.Language.English,["title"],["Delete Layer"]),ifLocale.setValues(GDeletePageAction,IFLocale.Language.English,["title"],["Delete Page"]),ifLocale.setValues(GDistributeAction,IFLocale.Language.English,["title.horizontal","title.vertical"],["Distribute Horizontally","Distribute Vertically"]),ifLocale.setValues(GDuplicateAction,IFLocale.Language.English,["title"],["Duplicate"]),ifLocale.setValues(GFitAllAction,IFLocale.Language.English,["title"],["Fit All"]),ifLocale.setValues(GFitCurrentLayerAction,IFLocale.Language.English,["title"],["Fit Layer"]),ifLocale.setValues(GFitCurrentPageAction,IFLocale.Language.English,["title"],["Fit Page"]),ifLocale.setValues(GFitSelectionAction,IFLocale.Language.English,["title"],["Fit Selection"]),ifLocale.setValues(GGroupAction,IFLocale.Language.English,["title"],["Group Selection"]),ifLocale.setValues(GPlaceImageAction,IFLocale.Language.English,["title"],["Place Image..."]),ifLocale.setValues(GInvertSelectionAction,IFLocale.Language.English,["title"],["Invert Selection"]),ifLocale.setValues(GLayerTypeAction,IFLocale.Language.English,["title"],["%name% Layer"]),ifLocale.setValues(GNewAction,IFLocale.Language.English,["title"],["New..."]),ifLocale.setValues(GNewWindowAction,IFLocale.Language.English,["title"],["New Window"]),ifLocale.setValues(GOpenAction,IFLocale.Language.English,["title"],["Open..."]),ifLocale.setValues(GArrangeAction,IFLocale.Language.English,["title.send-front","title.bring-forward","title.send-backward","title.send-back"],["Send To Front","Bring Forward","Send Backward","Send To Back"]),ifLocale.setValues(GOriginalViewAction,IFLocale.Language.English,["title"],["Original-View"]),ifLocale.setValues(GPaintModeAction,IFLocale.Language.English,["title"],["%name% View"]),ifLocale.setValues(GPasteAction,IFLocale.Language.English,["title"],["Paste"]),ifLocale.setValues(GPasteInPlaceAction,IFLocale.Language.English,["title"],["Paste In Place"]),ifLocale.setValues(GPasteInsideAction,IFLocale.Language.English,["title"],["Paste Inside Selection"]),ifLocale.setValues(GPasteStyleAction,IFLocale.Language.English,["title"],["Paste Style"]),ifLocale.setValues(GPixelPreviewAction,IFLocale.Language.English,["title"],["Pixel Preview"]),ifLocale.setValues(GRedoAction,IFLocale.Language.English,["title"],["Redo"]),ifLocale.setValues(GSaveAction,IFLocale.Language.English,["title"],["Save"]),ifLocale.setValues(GSaveAllAction,IFLocale.Language.English,["title"],["Save All"]),ifLocale.setValues(GSaveAsAction,IFLocale.Language.English,["title"],["Save As..."]),ifLocale.setValues(GShowRulersAction,IFLocale.Language.English,["title"],["Show Rulers"]),ifLocale.setValues(GSelectAllAction,IFLocale.Language.English,["title"],["Select All"]),ifLocale.setValues(GShowAllPagesAction,IFLocale.Language.English,["title"],["All Pages visible"]),ifLocale.setValues(GShowGridAction,IFLocale.Language.English,["title"],["Show Grid"]),ifLocale.setValues(GSliceFromSelectionAction,IFLocale.Language.English,["title"],["Create Slice from Selection"]),ifLocale.setValues(GSnapUnitAction,IFLocale.Language.English,["title.full","title.half"],["Snap to full units","Snap to half units"]),ifLocale.setValues(GTransformAction,IFLocale.Language.English,["title.rotate-45-left","title.rotate-90-left","title.rotate-180-left","title.rotate-45-right","title.rotate-90-right","title.rotate-180-right","title.flip-vertical","title.flip-horizontal"],["Rotate 45° Left","Rotate 90° Left","Rotate 180° Left","Rotate 45° Right","Rotate 90° Right","Rotate 180° Right","Flip Vertical","Flip Horizontal"]),ifLocale.setValues(GUndoAction,IFLocale.Language.English,["title"],["Undo"]),ifLocale.setValues(GUngroupAction,IFLocale.Language.English,["title"],["Ungroup Selection"]),ifLocale.setValues(GZoomInAction,IFLocale.Language.English,["title"],["Zoom in"]),ifLocale.setValues(GZoomOutAction,IFLocale.Language.English,["title"],["Zoom out"]),ifLocale.setValues(GAlignPalette,IFLocale.Language.English,["title"],["Align"]),ifLocale.setValues(GExportPalette,IFLocale.Language.English,["title"],["Export"]),ifLocale.setValues(GLayersPalette,IFLocale.Language.English,["title"],["Layers"]),ifLocale.setValues(GPagesPalette,IFLocale.Language.English,["title"],["Pages"]),ifLocale.setValues(GStylesPalette,IFLocale.Language.English,["title"],["Styles"]),ifLocale.setValues(GSwatchesPalette,IFLocale.Language.English,["title"],["Swatches"]),ifLocale.setValues(GTransformPalette,IFLocale.Language.English,["title"],["Transform"]),ifLocale.setValues(GPropertiesPanel,IFLocale.Language.English,["title"],["Properties"]),ifLocale.setValues(GDocumentSidebar,IFLocale.Language.English,["title"],["Document Settings"]),function(){function a(){}IFObject.inherit(a,GModule),a.prototype.init=function(){gravit.exporters.push(new GImageExporter),gravit.palettes.push(new GLayersPalette,new GPagesPalette,new GAlignPalette,new GTransformPalette,new GExportPalette,new GSwatchesPalette,new GStylesPalette),gravit.panels.push(new GPropertiesPanel),gravit.sidebars.push(new GDocumentSidebar),gravit.tools.push({instance:new IFPointerTool,title:"Pointer",category:GApplication.TOOL_CATEGORY_SELECT,group:"select",keys:["V","0"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M3.5,18.5v18l5-7h9L3.5,18.5z"/>\n</svg>'},{instance:new IFLassoTool,title:"Lasso",category:GApplication.TOOL_CATEGORY_SELECT,group:"select",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M18.5,27c-3.7,0-4.7,2.9-5.5,5.2c-0.7,2-1.2,3.2-2.5,3.2c-0.8,0-1.5-0.3-2.1-0.8\n	c-0.4-0.4-0.7-0.9-0.9-1.5c0.6-0.4,1-1,1-1.7c0-0.2,0-0.4-0.1-0.6c0.8-0.5,1.7-1.2,2.5-2c3.5-3.5,4.6-7.6,2.7-9.5\n	c-0.6-0.6-1.5-0.9-2.4-0.9c-2.1,0-4.7,1.3-7,3.6c-3.5,3.5-4.6,7.6-2.7,9.5c0.6,0.6,1.5,0.9,2.4,0.9c0.3,0,0.6,0,0.9-0.1\n	c0.3,0.6,1,1.1,1.8,1.1c0,0,0,0,0,0c0.3,0.7,0.6,1.4,1.2,1.9c0.7,0.7,1.7,1.1,2.8,1.1c2.2,0,2.8-2,3.5-4c0.8-2.3,1.6-4.6,4.5-4.6\n	C18.5,28,18.5,27,18.5,27z M2.1,30.9c-0.9-0.9-0.6-2.4-0.4-3.2c0.5-1.6,1.5-3.4,3.1-4.9c2-2,4.5-3.3,6.3-3.3c0.7,0,1.3,0.2,1.7,0.6\n	c0.4,0.4,0.6,1,0.6,1.7c0,1.9-1.3,4.3-3.3,6.3c-0.7,0.7-1.5,1.4-2.3,1.9c-0.4-0.3-0.8-0.5-1.4-0.5c-1.1,0-2,0.9-2,1.9\n	c-0.2,0-0.4,0.1-0.7,0.1C3.1,31.5,2.5,31.3,2.1,30.9z"/>\n</svg>'},{instance:new IFSubSelectTool,title:"Subselect",category:GApplication.TOOL_CATEGORY_SELECT,group:"select2",keys:["A","1"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M3.5,18.5v18l5-7h9L3.5,18.5z M7.5,27.5l-3,4.5V20.5l9,7H7.5z"/>\n</svg>'},{instance:new IFPageTool,title:"Page",category:GApplication.TOOL_CATEGORY_SELECT,group:"select3",keys:["D"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M15.5,18.5v10h-1v-9h-7v3h-3v10h3v1h-4v-12l3-3H15.5z M8.5,25.5v11l3.5-4h5.5L8.5,25.5z"/>\n</svg>'},{instance:new IFLayerTool,title:"Layer",category:GApplication.TOOL_CATEGORY_SELECT,group:"select3",keys:["L"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-2.5 -.5 18 18" width="18px" height="18px">\n<path stroke="none" d="M0.5,8.5 L0.5,10.5 L4.5,10.5 L4.5,8.5 L0.5,8.5 Z M10.5,8.5 L10.5,10.5 L12.5,10.5 L12.5,8.5 L10.5,8.5 Z M9.5,8.5 L9.5,9.5 L10.5,9.5 L10.5,8.5 L9.5,8.5 Z M0.5,0.5 L0.5,2.5 L12.5,2.5 L12.5,0.5 L0.5,0.5 Z M0.5,4.5 L0.5,6.5 L12.5,6.5 L12.5,4.5 L0.5,4.5 Z M5.5,7.5 L5.5,18.5 L9,14.5 L14.5,14.5 L5.5,7.5 Z"></path>\n</svg>'},{instance:new IFTransformTool,title:"Transform",category:GApplication.TOOL_CATEGORY_SELECT,group:"transform",keys:["Q"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M17.5,32.5H12l-3.5,4v-11L17.5,32.5z M3.5,18.5h-3v3h1v-2h2V18.5z M15.5,18.5v1h2v2h1v-3H15.5z M1.5,35.5v-2h-1v3h3v-1H1.5z M6.4,33.5H3.5v-12h12v7h1v-8h-14v14h3.9V33.5z"/>\n</svg>'},{instance:new IFLineTool,title:"Line",category:GApplication.TOOL_CATEGORY_VECTOR,group:"line",keys:["N"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<rect stroke="none" x="9" y="15.3" transform="matrix(0.7069 0.7074 -0.7074 0.7069 22.2372 1.3418)" width="1" height="24.5"/>\n</svg>'},{instance:new IFPenTool,title:"Pen",category:GApplication.TOOL_CATEGORY_VECTOR,group:"path",keys:["P"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M9.2,21.3l0.7,0.7l-6.5,3.6c0,0-0.5,3.1-1.4,5.7c-0.8,2.2-2.1,3.6-1.4,4.3c0,0,0,0,0.7,0.7\n	c0.7,0.7,2.1-0.6,4.3-1.4c2.5-0.9,5.6-1.4,5.6-1.4l3.7-6.4l0.7,0.7l2.9-2.1l-7.1-7.1L9.2,21.3z M4.2,26.4l6.5-3.6l3.6,3.6l-3.7,6.4\n	c-4.8,0.5-8.5,2.8-8.5,2.8l3.2-3.2c0.8,0.5,1.8,0.3,2.4-0.3c0.8-0.8,0.8-2,0-2.8c-0.8-0.8-2-0.8-2.8,0c-0.7,0.7-0.8,1.7-0.4,2.5\n	l-3.2,3.2C1.4,34.9,3.7,31.2,4.2,26.4z"/>\n</svg>'},{instance:new IFBezigonTool,title:"Bezigon",category:GApplication.TOOL_CATEGORY_VECTOR,group:"path",keys:["B","8"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path d="M7.8,29.3c-1.8-1.7,4.4-10.8,4.4-10.8l1.3,1.2c-1.3,1.5-2.5,3.6-3.1,4.7c-1,1.8-1.1,2.7-1.1,2.7l6-5.7l3.1,3\n	C18.5,24.5,9.5,30.7,7.8,29.3z M18.5,33c0,0.8-0.7,1.5-1.5,1.5c-0.7,0-1.2-0.4-1.4-1H7.5v3h-7v-7h3v-8.1c-0.6-0.2-1-0.8-1-1.4\n	c0-0.8,0.7-1.5,1.5-1.5s1.5,0.7,1.5,1.5c0,0.7-0.4,1.2-1,1.4v8.1h3v3h8.1c0.2-0.6,0.8-1,1.4-1C17.8,31.5,18.5,32.2,18.5,33z\n	 M6.5,30.5h-5v5h5V30.5z" stroke="none"/>\n</svg>'},{instance:new IFRectangleTool,title:"Rectangle",category:GApplication.TOOL_CATEGORY_VECTOR,group:"shape",keys:["R"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M17.5,20.5v14h-16v-14H17.5 M18.5,19.5h-18v16h18v-15V19.5L18.5,19.5z"/>\n</svg>'},{instance:new IFEllipseTool,title:"Ellipse",category:GApplication.TOOL_CATEGORY_VECTOR,group:"shape2",keys:["E","3"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<ellipse style="fill:none; stroke: inherit" cx="9.5" cy="27.5" rx="8.5" ry="7.5"/>\n</svg>'},{instance:new IFPolygonTool,title:"Polygon",category:GApplication.TOOL_CATEGORY_VECTOR,group:"shape2",keys:["G"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M13.4,20.5l3.9,7l-3.9,7H5.6l-3.9-7l3.9-7H13.4 M14,19.5H5l-4.5,8l4.5,8h9l4.5-8L14,19.5L14,19.5z"/>\n</svg>'},{instance:new IFTextTool,title:"Text",category:GApplication.TOOL_CATEGORY_OTHER,group:"text",keys:["T"],icon:'<svg xmlns="http://www.w3.org/2000/svg">\n<text style="stroke:none; fill: inherit; font-family: Arial; font-size: 18px; text-anchor: middle" x="9" y="15">T</text>\n</svg>'},{instance:new IFSliceTool,title:"Slice",category:GApplication.TOOL_CATEGORY_OTHER,group:"slice",keys:["K"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M14.8,19.3L2.6,33.4c-0.2,0.3-0.1,0.7,0.1,0.9c0.2,0.2,0.6,0.3,0.9,0.1c0,0,7.9-4.9,8-5.1l6.4-7.4l0,0 c0.8-0.9,0.5-2.2-0.3-2.9C16.9,18.3,15.6,18.3,14.8,19.3z M17,21l-6.3,7.4l-1.1-0.9l6.4-7.4c0.4-0.5,1-0.2,1-0.1 C17.2,20.2,17.2,20.7,17,21z M15.5,27.5v9h-15v-13v0h8v1h-7v11h13v-8H15.5z"/>\n</svg>'},{instance:new IFZoomTool,title:"Zoom",category:GApplication.TOOL_CATEGORY_VIEW,group:"zoom",keys:["Z"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M17.9,34L15,31.2c1-1.3,1.5-2.9,1.5-4.7c0-4.4-3.6-8.1-8-8.1c-4.4,0-8.1,3.6-8.1,8.1c0,4.4,3.6,8,8.1,8\n	c1.8,0,3.4-0.6,4.7-1.5l2.8,2.8c0.7,0.7,1.7,0.8,2.2,0.3C18.7,35.7,18.6,34.7,17.9,34z M1.6,26.5c0-3.8,3.1-6.9,6.9-6.9s7,3.1,7,6.9\n	s-3.1,7-7,7S1.6,30.3,1.6,26.5z"/>\n</svg>'},{instance:new IFHandTool,title:"Hand",category:GApplication.TOOL_CATEGORY_VIEW,group:"hand",keys:["H"],icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.5 18.5 18 18">\n<path stroke="none" d="M13.7,22.6C10.3,19,7.9,19,7,19.2l-0.4-0.4c-0.1,0-0.5-0.3-1.1-0.3c-0.4,0-0.7,0.1-1,0.4\n	C4.2,19,4.1,19.2,4,19.4c-0.6-0.3-1.3-0.3-1.8,0.2c-0.3,0.3-0.5,0.7-0.5,1.1c0,0.1,0,0.3,0.1,0.4c-0.2,0.1-0.5,0.2-0.7,0.4\n	c-0.9,0.7-0.5,1.7-0.2,2.3c2.7,2.6,5.6,5.8,6.1,7c-0.5-0.2-1.4-0.9-1.9-1.4c-1.7-1.4-2.8-2.2-3.6-1.7c-0.6,0.3-0.7,0.8-0.8,1.1\n	c-0.4,1.5,3.4,5.2,3.6,5.4c1.2,1.3,8.9,2.4,8.9,2.4c0.1,0,0.2,0,0.3-0.1l4.8-3.3c0.1-0.1,0.2-0.2,0.2-0.4\n	C18.5,32.5,18.7,27.8,13.7,22.6z M13.1,35.5L13.1,35.5c-2.9-0.4-7.4-1.3-8.1-2.1c0,0-0.1-0.1-0.2-0.2c-2.6-2.7-3.6-4.1-3.1-4.6\n	c0.1-0.1,0.2-0.1,0.4-0.1c0.5,0,1.4,0.7,2.1,1.3L4.4,30c1,0.8,2.1,1.6,2.8,1.6c0.2,0,0.4-0.1,0.5-0.2c0.1-0.1,0.1-0.2,0.1-0.3\n	c0-1.3-3.2-5.1-6.3-8c-0.2-0.3-0.3-0.7,0-1C1.8,22,2,21.9,2.2,21.9c0.2,0,0.3,0.1,0.4,0.1l4.5,4.3c0.2,0.1,0.4,0.1,0.6,0\n	c0.1-0.1,0.1-0.1,0.1-0.2c0-0.1-0.1-0.3-0.1-0.3l-4.5-4.3c0,0-0.5-0.4-0.5-0.9c0-0.2,0.1-0.3,0.2-0.4c0.1-0.1,0.3-0.2,0.4-0.2\n	c0.4,0,0.9,0.4,1.1,0.7L9,25.2c0.2,0.1,0.4,0.1,0.6,0c0.1-0.1,0.1-0.1,0.1-0.2c0-0.1-0.1-0.3-0.1-0.3l-4.6-4.4\n	c-0.1-0.1-0.1-0.4,0.1-0.6c0.1-0.1,0.3-0.2,0.5-0.2c0.2,0,0.4,0.1,0.4,0.2h0l5,4.3c0.2,0.1,0.4,0.1,0.6,0c0.1-0.1,0.1-0.2,0.1-0.3\n	c0-0.1-0.1-0.2-0.1-0.3L7.8,20l0.5,0.1c1,0.2,2.6,0.9,4.7,3.1c4,4.2,4.5,8.1,4.5,9.2l0,0.1L13.1,35.5z"/>\n</svg>'}),gravit.properties.push(new GInfoProperties,new GPolygonProperties,new GPathProperties,new GRectangleProperties,new GEllipseProperties,new GTextProperties,new GImageProperties,new GSliceProperties,new GPageProperties,new GFillBorderProperties,new GEffectProperties,new GStyleProperties),gravit.actions.push(new GNewAction,new GOpenAction,new GSaveAction,new GSaveAsAction,new GSaveAllAction,new GPlaceImageAction,new GCloseAction,new GCloseAllAction,new GUndoAction,new GRedoAction,new GCutAction,new GCopyAction,new GPasteAction,new GDeleteAction,new GPasteInPlaceAction,new GPasteInsideAction,new GPasteStyleAction,new GDuplicateAction,new GCloneAction,new GSelectAllAction,new GInvertSelectionAction,new GArrangeAction(GArrangeAction.Type.SendToFront),new GArrangeAction(GArrangeAction.Type.BringForward),new GArrangeAction(GArrangeAction.Type.SendBackward),new GArrangeAction(GArrangeAction.Type.SendToBack),new GAlignAction(GAlignAction.Type.AlignLeft),new GAlignAction(GAlignAction.Type.AlignCenter),new GAlignAction(GAlignAction.Type.AlignRight),new GAlignAction(GAlignAction.Type.AlignJustifyHorizontal),new GAlignAction(GAlignAction.Type.AlignTop),new GAlignAction(GAlignAction.Type.AlignMiddle),new GAlignAction(GAlignAction.Type.AlignBottom),new GAlignAction(GAlignAction.Type.AlignJustifyVertical),new GDistributeAction(GDistributeAction.Type.Horizontal),new GDistributeAction(GDistributeAction.Type.Vertical),new GSnapUnitAction(GSnapUnitAction.Type.FullUnit),new GSnapUnitAction(GSnapUnitAction.Type.HalfUnit),new GTransformAction(GTransformAction.Type.Rotate45Left),new GTransformAction(GTransformAction.Type.Rotate90Left),new GTransformAction(GTransformAction.Type.Rotate180Left),new GTransformAction(GTransformAction.Type.Rotate45Right),new GTransformAction(GTransformAction.Type.Rotate90Right),new GTransformAction(GTransformAction.Type.Rotate180Right),new GTransformAction(GTransformAction.Type.FlipVertical),new GTransformAction(GTransformAction.Type.FlipHorizontal),new GGroupAction,new GUngroupAction,new GConvertToPathAction,new GSliceFromSelectionAction,new GAddPageAction,new GDeletePageAction,new GAddLayerAction,new GDeleteLayerAction,new GLayerTypeAction(IFLayer.Type.Output),new GLayerTypeAction(IFLayer.Type.Draft),new GLayerTypeAction(IFLayer.Type.Guide),new GOriginalViewAction,new GFitSelectionAction,new GFitCurrentPageAction,new GFitCurrentLayerAction,new GFitAllAction,new GMagnificationAction(6,null),new GMagnificationAction(12,null),new GMagnificationAction(25,null),new GMagnificationAction(50,[IFKey.Constant.META,"5"]),new GMagnificationAction(100,[IFKey.Constant.META,"1"]),new GMagnificationAction(200,[IFKey.Constant.META,"2"]),new GMagnificationAction(400,[IFKey.Constant.META,"4"]),new GMagnificationAction(800,[IFKey.Constant.META,"8"]),new GZoomInAction,new GZoomOutAction,new GPaintModeAction(IFScenePaintConfiguration.PaintMode.Full),new GPaintModeAction(IFScenePaintConfiguration.PaintMode.Fast),new GPaintModeAction(IFScenePaintConfiguration.PaintMode.Outline),new GPaintModeAction(IFScenePaintConfiguration.PaintMode.Output),new GPixelPreviewAction,new GShowAllPagesAction,new GShowGridAction,new GShowRulersAction,new GNewWindowAction)},a.prototype.toString=function(){return"[Module Gravit]"},gravit.modules.push(new a)}(this);